{
  "version": 4,
  "terraform_version": "1.7.0",
  "serial": 400,
  "lineage": "89a6260c-6368-02d7-179e-69d04284ae64",
  "outputs": {},
  "resources": [
    {
      "module": "module.connectivity",
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "core",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NmI1OTFjYzItM2NmNy00NWJkLWIyYzAtODU4MTIwNjUwZjQ1O3N1YnNjcmlwdGlvbklkPTQ4YjA2YzgyLWU4NTYtNDQ2NC04NzQ0LTk2MDlhMWFhMzdmYzt0ZW5hbnRJZD0zNTA0Y2YyOS1jZDU2LTRlZGMtYTQ4Mi0xNGRmYTEyMDNhMjk=",
            "object_id": "6b591cc2-3cf7-45bd-b2c0-858120650f45",
            "subscription_id": "48b06c82-e856-4464-8744-9609a1aa37fc",
            "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.connectivity",
      "mode": "data",
      "type": "azurerm_monitor_diagnostic_categories",
      "name": "firewall",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/azureFirewalls/es-fw-swedencentral",
            "log_category_groups": [
              "allLogs"
            ],
            "log_category_types": [
              "AZFWApplicationRule",
              "AZFWApplicationRuleAggregation",
              "AZFWDnsQuery",
              "AZFWFatFlow",
              "AZFWFlowTrace",
              "AZFWFqdnResolveFailure",
              "AZFWIdpsSignature",
              "AZFWNatRule",
              "AZFWNatRuleAggregation",
              "AZFWNetworkRule",
              "AZFWNetworkRuleAggregation",
              "AZFWThreatIntel",
              "AzureFirewallApplicationRule",
              "AzureFirewallDnsProxy",
              "AzureFirewallNetworkRule"
            ],
            "logs": [
              "AZFWApplicationRule",
              "AZFWApplicationRuleAggregation",
              "AZFWDnsQuery",
              "AZFWFatFlow",
              "AZFWFlowTrace",
              "AZFWFqdnResolveFailure",
              "AZFWIdpsSignature",
              "AZFWNatRule",
              "AZFWNatRuleAggregation",
              "AZFWNetworkRule",
              "AZFWNetworkRuleAggregation",
              "AZFWThreatIntel",
              "AzureFirewallApplicationRule",
              "AzureFirewallDnsProxy",
              "AzureFirewallNetworkRule"
            ],
            "metrics": [
              "AllMetrics"
            ],
            "resource_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/azureFirewalls/es-fw-swedencentral",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.connectivity",
      "mode": "managed",
      "type": "azurerm_network_security_group",
      "name": "bastion-nsg",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/networkSecurityGroups/lz-nsg-hub-bastion",
            "location": "swedencentral",
            "name": "lz-nsg-hub-bastion",
            "resource_group_name": "es-connectivity-swedencentral",
            "security_rule": [
              {
                "access": "Allow",
                "description": "",
                "destination_address_prefix": "*",
                "destination_address_prefixes": [],
                "destination_application_security_group_ids": [],
                "destination_port_range": "443",
                "destination_port_ranges": [],
                "direction": "Inbound",
                "name": "GatewayManager",
                "priority": 1001,
                "protocol": "Tcp",
                "source_address_prefix": "GatewayManager",
                "source_address_prefixes": [],
                "source_application_security_group_ids": [],
                "source_port_range": "*",
                "source_port_ranges": []
              },
              {
                "access": "Allow",
                "description": "",
                "destination_address_prefix": "*",
                "destination_address_prefixes": [],
                "destination_application_security_group_ids": [],
                "destination_port_range": "443",
                "destination_port_ranges": [],
                "direction": "Inbound",
                "name": "Internet-Bastion-PublicIP",
                "priority": 1002,
                "protocol": "Tcp",
                "source_address_prefix": "*",
                "source_address_prefixes": [],
                "source_application_security_group_ids": [],
                "source_port_range": "*",
                "source_port_ranges": []
              },
              {
                "access": "Allow",
                "description": "",
                "destination_address_prefix": "AzureCloud",
                "destination_address_prefixes": [],
                "destination_application_security_group_ids": [],
                "destination_port_range": "443",
                "destination_port_ranges": [],
                "direction": "Outbound",
                "name": "OutboundToAzureCloud",
                "priority": 1002,
                "protocol": "Tcp",
                "source_address_prefix": "*",
                "source_address_prefixes": [],
                "source_application_security_group_ids": [],
                "source_port_range": "*",
                "source_port_ranges": []
              },
              {
                "access": "Allow",
                "description": "",
                "destination_address_prefix": "VirtualNetwork",
                "destination_address_prefixes": [],
                "destination_application_security_group_ids": [],
                "destination_port_range": "",
                "destination_port_ranges": [
                  "22",
                  "3389"
                ],
                "direction": "Outbound",
                "name": "OutboundVirtualNetwork",
                "priority": 1001,
                "protocol": "Tcp",
                "source_address_prefix": "*",
                "source_address_prefixes": [],
                "source_application_security_group_ids": [],
                "source_port_range": "*",
                "source_port_ranges": []
              }
            ],
            "tags": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_firewall.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_firewall.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_firewall_policy.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_firewall_policy.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_public_ip.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_subnet.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_hub.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_wan.virtual_wan"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity",
      "mode": "managed",
      "type": "azurerm_public_ip",
      "name": "lz-pip-bastion",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "allocation_method": "Static",
            "ddos_protection_mode": "VirtualNetworkInherited",
            "ddos_protection_plan_id": null,
            "domain_name_label": null,
            "edge_zone": "",
            "fqdn": null,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/publicIPAddresses/lz-pip-bastion",
            "idle_timeout_in_minutes": 4,
            "ip_address": "20.91.254.89",
            "ip_tags": null,
            "ip_version": "IPv4",
            "location": "swedencentral",
            "name": "lz-pip-bastion",
            "public_ip_prefix_id": null,
            "resource_group_name": "es-connectivity-swedencentral",
            "reverse_fqdn": null,
            "sku": "Standard",
            "sku_tier": "Regional",
            "tags": null,
            "timeouts": null,
            "zones": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_firewall.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_firewall.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_firewall_policy.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_firewall_policy.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_public_ip.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_subnet.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_hub.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_wan.virtual_wan"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity",
      "mode": "managed",
      "type": "azurerm_route_table",
      "name": "rt-to-hub",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bgp_route_propagation_enabled": true,
            "disable_bgp_route_propagation": false,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/routeTables/rt-to-nva",
            "location": "swedencentral",
            "name": "rt-to-nva",
            "resource_group_name": "es-connectivity-swedencentral",
            "route": [
              {
                "address_prefix": "10.100.0.0/14",
                "name": "rt-to-nva",
                "next_hop_in_ip_address": "10.100.0.4",
                "next_hop_type": "VirtualAppliance"
              }
            ],
            "subnets": [],
            "tags": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_firewall.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_firewall.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_firewall_policy.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_firewall_policy.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_public_ip.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_subnet.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_hub.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_wan.virtual_wan"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity",
      "mode": "managed",
      "type": "azurerm_subnet_network_security_group_association",
      "name": "example",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity",
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "example",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "external_lookup",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_set_definition",
      "name": "external_lookup",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_automation_account",
      "name": "management",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_dns_zone",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_express_route_gateway",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/azureFirewalls/es-fw-swedencentral",
          "schema_version": 0,
          "attributes": {
            "dns_proxy_enabled": false,
            "dns_servers": null,
            "firewall_policy_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/firewallPolicies/es-fw-swedencentral-policy",
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/azureFirewalls/es-fw-swedencentral",
            "ip_configuration": [
              {
                "name": "es-fw-swedencentral-pip",
                "private_ip_address": "10.100.0.4",
                "public_ip_address_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/publicIPAddresses/es-fw-swedencentral-pip",
                "subnet_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/AzureFirewallSubnet"
              }
            ],
            "location": "swedencentral",
            "management_ip_configuration": [],
            "name": "es-fw-swedencentral",
            "private_ip_ranges": null,
            "resource_group_name": "es-connectivity-swedencentral",
            "sku_name": "AZFW_VNet",
            "sku_tier": "Standard",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "threat_intel_mode": "Alert",
            "timeouts": null,
            "virtual_hub": [],
            "zones": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_firewall_policy.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_public_ip.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.virtual_wan",
            "module.connectivity.module.enterprise_scale.azurerm_subnet.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall_policy",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/firewallPolicies/es-fw-swedencentral-policy",
          "schema_version": 0,
          "attributes": {
            "auto_learn_private_ranges_enabled": false,
            "base_policy_id": "",
            "child_policies": [],
            "dns": [
              {
                "proxy_enabled": true,
                "servers": null
              }
            ],
            "explicit_proxy": [],
            "firewalls": [],
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/firewallPolicies/es-fw-swedencentral-policy",
            "identity": [],
            "insights": [],
            "intrusion_detection": [],
            "location": "swedencentral",
            "name": "es-fw-swedencentral-policy",
            "private_ip_ranges": null,
            "resource_group_name": "es-connectivity-swedencentral",
            "rule_collection_groups": [],
            "sku": "Standard",
            "sql_redirect_allowed": null,
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "threat_intelligence_allowlist": [],
            "threat_intelligence_mode": "Alert",
            "timeouts": null,
            "tls_certificate": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.virtual_wan"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall_policy",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_linked_service",
      "name": "management",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_solution",
      "name": "management",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_workspace",
      "name": "management",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_1",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_2",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_3",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_4",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_5",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_6",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "enterprise_scale",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group_subscription_association",
      "name": "enterprise_scale",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_network_ddos_protection_plan",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "enterprise_scale",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_policy_set_definition",
      "name": "enterprise_scale",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_private_dns_zone",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.adf.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.adf.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.afs.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.afs.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.agentsvc.azure-automation.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.agentsvc.azure-automation.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.analysis.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.analysis.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.api.azureml.ms",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.api.azureml.ms.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azconfig.io",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azconfig.io.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-api.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-api.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-automation.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-automation.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-devices-provisioning.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-devices-provisioning.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azure-devices.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azure-devices.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurecr.io",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurecr.io.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurehdinsight.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurehdinsight.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurehealthcareapis.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurehealthcareapis.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurestaticapps.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurestaticapps.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azuresynapse.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azuresynapse.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.azurewebsites.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.azurewebsites.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.batch.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.batch.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.blob.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.blob.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.cassandra.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.cassandra.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.database.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.database.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.datafactory.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.datafactory.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.dev.azuresynapse.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.dev.azuresynapse.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.developer.azure-api.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.developer.azure-api.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.dfs.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.dfs.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.dicom.azurehealthcareapis.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.dicom.azurehealthcareapis.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.digitaltwins.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.digitaltwins.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.directline.botframework.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.directline.botframework.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.documents.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.documents.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.eventgrid.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.eventgrid.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.file.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.file.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.gremlin.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.gremlin.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.guestconfiguration.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.guestconfiguration.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.his.arc.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.his.arc.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.kubernetesconfiguration.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.kubernetesconfiguration.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.managedhsm.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.managedhsm.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.mariadb.database.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.mariadb.database.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.media.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.media.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.mongo.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.mongo.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.monitor.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.monitor.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.mysql.database.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.mysql.database.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.notebooks.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.notebooks.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.ods.opinsights.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.ods.opinsights.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.oms.opinsights.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.oms.opinsights.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.pbidedicated.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.pbidedicated.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.postgres.database.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.postgres.database.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.prod.migration.windowsazure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.prod.migration.windowsazure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.purview.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.purview.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.purviewstudio.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.purviewstudio.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.queue.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.queue.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.redis.cache.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.redis.cache.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.redisenterprise.cache.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.redisenterprise.cache.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sdc.backup.windowsazure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sdc.backup.windowsazure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.sdc.backup.windowsazure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.sdc.backup.windowsazure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.search.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.search.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.service.signalr.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.service.signalr.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.servicebus.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.servicebus.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.siterecovery.windowsazure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.siterecovery.windowsazure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.sql.azuresynapse.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.sql.azuresynapse.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.azmk8s.io",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.azmk8s.io",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.swedencentral.azmk8s.io",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.swedencentral.azmk8s.io.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.kusto.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.kusto.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.swedencentral.kusto.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.swedencentral.kusto.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.table.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.table.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.table.cosmos.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.table.cosmos.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.tip1.powerquery.microsoft.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.tip1.powerquery.microsoft.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.token.botframework.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.token.botframework.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.vaultcore.azure.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.vaultcore.azure.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.web.core.windows.net",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.web.core.windows.net.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com",
            "max_number_of_record_sets": 25000,
            "max_number_of_virtual_network_links": 1000,
            "max_number_of_virtual_network_links_with_registration": 100,
            "name": "privatelink.webpubsub.azure.com",
            "number_of_record_sets": 1,
            "resource_group_name": "es-dns",
            "soa_record": [
              {
                "email": "azureprivatedns-host.microsoft.com",
                "expire_time": 2419200,
                "fqdn": "privatelink.webpubsub.azure.com.",
                "host_name": "azureprivatedns.net",
                "minimum_ttl": 10,
                "refresh_time": 3600,
                "retry_time": 300,
                "serial_number": 1,
                "tags": {},
                "ttl": 3600
              }
            ],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            }
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_private_dns_zone_virtual_network_link",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.adf.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.adf.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.afs.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.afs.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.agentsvc.azure-automation.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.analysis.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.analysis.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.api.azureml.ms",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azconfig.io/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azconfig.io",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-api.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azure-api.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azure-automation.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices-provisioning.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azure-devices-provisioning.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azure-devices.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azure-devices.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azurecr.io",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehdinsight.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azurehdinsight.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurehealthcareapis.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azurehealthcareapis.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurestaticapps.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azurestaticapps.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azuresynapse.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.azurewebsites.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.batch.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.batch.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.blob.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.cassandra.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.cassandra.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.database.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.datafactory.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.datafactory.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dev.azuresynapse.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.dev.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.developer.azure-api.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.developer.azure-api.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dfs.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.dfs.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.dicom.azurehealthcareapis.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.dicom.azurehealthcareapis.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.digitaltwins.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.digitaltwins.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.directline.botframework.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.directline.botframework.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.documents.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.documents.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.eventgrid.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.eventgrid.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.file.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.gremlin.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.gremlin.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.guestconfiguration.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.guestconfiguration.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.his.arc.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.his.arc.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.kubernetesconfiguration.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.kubernetesconfiguration.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.managedhsm.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.managedhsm.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mariadb.database.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.mariadb.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.media.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.media.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mongo.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.mongo.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.monitor.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.mysql.database.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.mysql.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.notebooks.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.ods.opinsights.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.oms.opinsights.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.pbidedicated.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.pbidedicated.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.postgres.database.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.postgres.database.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.prod.migration.windowsazure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.prod.migration.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purview.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.purview.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.purviewstudio.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.purviewstudio.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.queue.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.redis.cache.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.redisenterprise.cache.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sdc.backup.windowsazure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sdc.backup.windowsazure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.sdc.backup.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.search.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.search.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.service.signalr.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.service.signalr.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.servicebus.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.siterecovery.windowsazure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.siterecovery.windowsazure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.sql.azuresynapse.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.sql.azuresynapse.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.azmk8s.io/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.azmk8s.io/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.swedencentral.azmk8s.io",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.kusto.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.swedencentral.kusto.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.swedencentral.kusto.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.table.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.table.cosmos.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.table.cosmos.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.tip1.powerquery.microsoft.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.tip1.powerquery.microsoft.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.token.botframework.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.token.botframework.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.vaultcore.azure.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.web.core.windows.net",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns/providers/Microsoft.Network/privateDnsZones/privatelink.webpubsub.azure.com/virtualNetworkLinks/48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "name": "48b06c82-e856-4464-8744-9609a1aa37fc-f5efaaf3-40d2-511b-830b-193f50682866",
            "private_dns_zone_name": "privatelink.webpubsub.azure.com",
            "registration_enabled": false,
            "resource_group_name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": {
              "create": null,
              "delete": null,
              "read": null,
              "update": null
            },
            "virtual_network_id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_private_dns_zone.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_public_ip",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/publicIPAddresses/es-fw-swedencentral-pip",
          "schema_version": 0,
          "attributes": {
            "allocation_method": "Static",
            "ddos_protection_mode": "VirtualNetworkInherited",
            "ddos_protection_plan_id": null,
            "domain_name_label": null,
            "edge_zone": "",
            "fqdn": null,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/publicIPAddresses/es-fw-swedencentral-pip",
            "idle_timeout_in_minutes": 4,
            "ip_address": "135.225.38.184",
            "ip_tags": null,
            "ip_version": "IPv4",
            "location": "swedencentral",
            "name": "es-fw-swedencentral-pip",
            "public_ip_prefix_id": null,
            "resource_group_name": "es-connectivity-swedencentral",
            "reverse_fqdn": null,
            "sku": "Standard",
            "sku_tier": "Regional",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "zones": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral",
            "location": "swedencentral",
            "managed_by": "",
            "name": "es-connectivity-swedencentral",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0="
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-dns",
            "location": "swedencentral",
            "managed_by": "",
            "name": "es-dns",
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "management",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "enterprise_scale",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "policy_assignment",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_role_definition",
      "name": "enterprise_scale",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/AzureBastionSubnet",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.100.1.0/26"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/AzureBastionSubnet",
            "name": "AzureBastionSubnet",
            "private_endpoint_network_policies": "Enabled",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "es-connectivity-swedencentral",
            "service_endpoint_policy_ids": null,
            "service_endpoints": null,
            "timeouts": null,
            "virtual_network_name": "es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/AzureFirewallSubnet",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.100.0.0/24"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/AzureFirewallSubnet",
            "name": "AzureFirewallSubnet",
            "private_endpoint_network_policies": "Enabled",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "es-connectivity-swedencentral",
            "service_endpoint_policy_ids": null,
            "service_endpoints": null,
            "timeouts": null,
            "virtual_network_name": "es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/SharedServicesSubnet",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.100.1.64/26"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/SharedServicesSubnet",
            "name": "SharedServicesSubnet",
            "private_endpoint_network_policies": "Enabled",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "es-connectivity-swedencentral",
            "service_endpoint_policy_ids": null,
            "service_endpoints": null,
            "timeouts": null,
            "virtual_network_name": "es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/inboundsubnetdns",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.100.1.128/26"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [
              {
                "name": "Microsoft.Network.dnsResolvers",
                "service_delegation": [
                  {
                    "actions": [
                      "Microsoft.Network/virtualNetworks/subnets/join/action"
                    ],
                    "name": "Microsoft.Network/dnsResolvers"
                  }
                ]
              }
            ],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/inboundsubnetdns",
            "name": "inboundsubnetdns",
            "private_endpoint_network_policies": "Enabled",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "es-connectivity-swedencentral",
            "service_endpoint_policy_ids": null,
            "service_endpoints": null,
            "timeouts": null,
            "virtual_network_name": "es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        },
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/outboundsubnetdns",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.100.1.192/26"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [
              {
                "name": "Microsoft.Network.dnsResolvers",
                "service_delegation": [
                  {
                    "actions": [
                      "Microsoft.Network/virtualNetworks/subnets/join/action"
                    ],
                    "name": "Microsoft.Network/dnsResolvers"
                  }
                ]
              }
            ],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral/subnets/outboundsubnetdns",
            "name": "outboundsubnetdns",
            "private_endpoint_network_policies": "Enabled",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "es-connectivity-swedencentral",
            "service_endpoint_policy_ids": null,
            "service_endpoints": null,
            "timeouts": null,
            "virtual_network_name": "es-hub-swedencentral"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_virtual_network.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/providers/Microsoft.Resources/deployments/pid-97603aac-98f8-4a55-92fc-4c78378c9ba5_v4.2.0_0009_c898a64e",
            "location": "swedencentral",
            "name": "pid-97603aac-98f8-4a55-92fc-4c78378c9ba5_v4.2.0_0009_c898a64e",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": null,
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.data.azurerm_client_config.core",
            "module.connectivity.module.enterprise_scale.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_core",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/providers/Microsoft.Resources/deployments/pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v4.2.0_0000_c898a64e",
            "location": "swedencentral",
            "name": "pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v4.2.0_0000_c898a64e",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": null,
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_hub",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_hub_connection",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_network",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral",
          "schema_version": 0,
          "attributes": {
            "address_space": [
              "10.100.0.0/16"
            ],
            "bgp_community": "",
            "ddos_protection_plan": [],
            "dns_servers": [],
            "edge_zone": "",
            "encryption": [],
            "flow_timeout_in_minutes": 0,
            "guid": "5657e28f-ffa0-413c-9729-2e3b3eb4d3d5",
            "id": "/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/es-connectivity-swedencentral/providers/Microsoft.Network/virtualNetworks/es-hub-swedencentral",
            "location": "swedencentral",
            "name": "es-hub-swedencentral",
            "resource_group_name": "es-connectivity-swedencentral",
            "subnet": [],
            "tags": {
              "demo_type": "deploy_connectivity_resources_custom",
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.connectivity.module.enterprise_scale.azurerm_network_ddos_protection_plan.connectivity",
            "module.connectivity.module.enterprise_scale.azurerm_resource_group.connectivity"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_network_gateway",
      "name": "connectivity",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_wan",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_vpn_gateway",
      "name": "virtual_wan",
      "provider": "module.connectivity.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "random_id",
      "name": "telem",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "b64_std": "yJimTg==",
            "b64_url": "yJimTg",
            "byte_length": 4,
            "dec": "3365447246",
            "hex": "c898a64e",
            "id": "yJimTg",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_management_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:23:20Z",
            "triggers": {
              "azurerm_management_group_level_1": "[]",
              "azurerm_management_group_level_2": "[]",
              "azurerm_management_group_level_3": "[]",
              "azurerm_management_group_level_4": "[]",
              "azurerm_management_group_level_5": "[]",
              "azurerm_management_group_level_6": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.connectivity.data.azurerm_client_config.core",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_1",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_2",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_3",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_4",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_5",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_6"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:32:25Z",
            "triggers": {
              "azurerm_management_group_policy_assignment_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.connectivity.data.azurerm_client_config.core",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_1",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_2",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_3",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_4",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_5",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_6",
            "module.connectivity.module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.connectivity.module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.connectivity.module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:27:37Z",
            "triggers": {
              "azurerm_policy_definition_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.connectivity.data.azurerm_client_config.core",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_1",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_2",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_3",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_4",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_5",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_6",
            "module.connectivity.module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_set_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:31:55Z",
            "triggers": {
              "azurerm_policy_set_definition_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.connectivity.data.azurerm_client_config.core",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_1",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_2",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_3",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_4",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_5",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_6",
            "module.connectivity.module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "0s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:32:26Z",
            "triggers": {
              "azurerm_role_assignment_enterprise_scale": "[]",
              "module_role_assignments_for_policy": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.connectivity.data.azurerm_client_config.core",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_1",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_2",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_3",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_4",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_5",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_6",
            "module.connectivity.module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.connectivity.module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.azurerm_role_assignment.enterprise_scale",
            "module.connectivity.module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.connectivity.module.enterprise_scale.azurerm_role_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.connectivity.module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.connectivity.module.enterprise_scale.module.role_assignments_for_policy.azurerm_role_assignment.for_policy",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_role_definition"
          ]
        }
      ]
    },
    {
      "module": "module.connectivity.module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "60s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:28:09Z",
            "triggers": {
              "azurerm_role_definition_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.connectivity.data.azurerm_client_config.core",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_1",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_2",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_3",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_4",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_5",
            "module.connectivity.module.enterprise_scale.azurerm_management_group.level_6",
            "module.connectivity.module.enterprise_scale.azurerm_role_definition.enterprise_scale",
            "module.connectivity.module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.core",
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "core",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NmI1OTFjYzItM2NmNy00NWJkLWIyYzAtODU4MTIwNjUwZjQ1O3N1YnNjcmlwdGlvbklkPTQ1NzA3ZTI1LTE2MDMtNDc0OC05NWIyLWFjZjQxN2I3ODFiYzt0ZW5hbnRJZD0zNTA0Y2YyOS1jZDU2LTRlZGMtYTQ4Mi0xNGRmYTEyMDNhMjk=",
            "object_id": "6b591cc2-3cf7-45bd-b2c0-858120650f45",
            "subscription_id": "45707e25-1603-4748-95b2-acf417b781bc",
            "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "external_lookup",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d",
          "schema_version": 0,
          "attributes": {
            "description": "Ensure protection of your Azure Virtual Machines by enabling Azure Backup. Azure Backup is a secure and cost effective data protection solution for Azure.",
            "display_name": "Azure Backup should be enabled for Virtual Machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "013e242c-8828-4970-87b3-ab247555486d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"id\",\"notContains\":\"/resourceGroups/databricks-rg-\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"azureopenshift\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"AzureDatabricks\"}]},\"then\":{\"details\":{\"type\":\"Microsoft.RecoveryServices/backupprotecteditems\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
          "schema_version": 0,
          "attributes": {
            "description": "By restricting network access, you can ensure that only allowed networks can access the service. This can be achieved by configuring network rules so that only applications from allowed networks can access the Azure AI service.",
            "display_name": "Azure AI Services resources should restrict network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Ai Services\",\"version\":\"3.2.0\"}",
            "mode": "Indexed",
            "name": "037eea7a-bd0a-46c5-9a66-03aea78705d3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"field\":\"Microsoft.CognitiveServices/accounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"},{\"field\":\"Microsoft.CognitiveServices/accounts/networkAcls.defaultAction\",\"notEquals\":\"Deny\"}]},{\"allOf\":[{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},{\"field\":\"Microsoft.Search/searchServices/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the private cluster feature for your Azure Kubernetes Service cluster to ensure network traffic between your API server and your node pools remains on the private network only. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Azure Kubernetes Service Private Clusters should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "040732e8-d947-40b8-95d6-854c95024bf8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602",
          "schema_version": 0,
          "attributes": {
            "description": "Security Center uses the Microsoft Dependency agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.",
            "display_name": "[Preview]: Network traffic data collection agent should be installed on Linux virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"1.0.2-preview\"}",
            "mode": "Indexed",
            "name": "04c4380f-3fae-46e8-96c9-30193528f602",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Dependency Agent for Linux VMs monitoring\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Service Bus to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.2.0\"}",
            "mode": "Indexed",
            "name": "04d53d87-841c-4f23-8a5b-21564380b55e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ServiceBus/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"VNetAndIPFilteringLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RuntimeAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationMetricsLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DiagnosticErrorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.",
            "display_name": "Azure API for FHIR should use a customer-managed key to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
            "management_group_name": null,
            "metadata": "{\"category\":\"API for FHIR\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "051cba44-2429-45b9-9649-46cec11c7119",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.HealthcareApis/services/cosmosDbConfiguration.keyVaultKeyUri\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux VMs if the VM Image (OS) is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux VMs. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "053d3325-282c-4e5c-b944-24faffd30d77",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.",
            "display_name": "Azure Web Application Firewall should be enabled for Azure Front Door entry-points",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/frontdoors\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/frontdoors/frontendEndpoints[*].webApplicationFirewallPolicyLink.id\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b",
          "schema_version": 0,
          "attributes": {
            "description": "Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for PostgreSQL. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.",
            "display_name": "Private endpoint should be enabled for PostgreSQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "0564d078-92f5-4f97-8398-b9f58a51f70b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Approved\",\"field\":\"Microsoft.DBforPostgreSQL/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\"},\"type\":\"Microsoft.DBforPostgreSQL/servers/privateEndpointConnections\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Azure Data Lake Store should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Lake\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "057ef27e-665e-4328-8ea3-04b3122bd9fb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeStore/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
          "schema_version": 0,
          "attributes": {
            "description": "To access the private endpoint(s) for Storage Sync Service resource interfaces from a registered server, you need to configure your DNS to resolve the correct names to your private endpoint's private IP addresses. This policy creates the requisite Azure Private DNS Zone and A records for the interfaces of your Storage Sync Service private endpoint(s).",
            "display_name": "Configure Azure File Sync to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "06695360-db88-47f6-b976-7500d4297475",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"privateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"afs\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-afs\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f\",\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f",
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d",
          "schema_version": 0,
          "attributes": {
            "description": "This policy audits VMs that do not use managed disks",
            "display_name": "Audit VMs that do not use managed disks",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "06a78e20-9358-41c9-923c-fb736d382a4d",
            "parameters": "",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"exists\":\"True\",\"field\":\"Microsoft.Compute/virtualMachines/osDisk.uri\"}]},{\"allOf\":[{\"equals\":\"Microsoft.Compute/VirtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"True\",\"field\":\"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\"},{\"exists\":\"True\",\"field\":\"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\"}]}]}]},\"then\":{\"effect\":\"audit\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
          "schema_version": 0,
          "attributes": {
            "description": "Cross-Origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.",
            "display_name": "Function apps should not have CORS configured to allow every resource to access your apps",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "0820b7b9-23aa-4725-a1ce-ae4558f718e5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\",\"notEquals\":\"*\"},\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machines if the virtual machine image is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "mode": "Indexed",
            "name": "0868462e-646c-4fe3-9ced-a733534b6a2c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example values: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter\",\"2022-datacenter-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-smalldisk-g2\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Search Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "08ba64b8-738f-4918-9686-730d2ed79c7d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Search/searchServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b",
          "schema_version": 0,
          "attributes": {
            "description": "It is recommended to designate more than one subscription owner in order to have administrator access redundancy.",
            "display_name": "There should be more than one owner assigned to your subscription",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "09024ccc-0c5f-475e-9457-b7c0d9ed487b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"2c79b4af-f830-b61e-92b9-63dfa30f16e4\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/090c7b07-b4ed-4561-ad20-e9075f3ccaff",
          "schema_version": 0,
          "attributes": {
            "description": "Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. Resolving vulnerabilities can greatly improve your security posture, ensuring images are safe to use prior to deployment.",
            "display_name": "Azure registry container images should have vulnerabilities resolved (powered by Microsoft Defender Vulnerability Management)",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/090c7b07-b4ed-4561-ad20-e9075f3ccaff",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "090c7b07-b4ed-4561-ad20-e9075f3ccaff",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"c0b7cfc6-3172-465a-b378-53c7ff2cc0d5\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
          "schema_version": 0,
          "attributes": {
            "description": "This policy definition is no longer the recommended way to achieve its intent. Instead of continuing to use this policy, we recommend you assign this replacement policies with policy IDs 3dc5edcd-002d-444c-b216-e123bbfa37c0 and ca88aadc-6e2b-416c-9de2-5a0f01d1693f. Learn more about policy definition deprecation at aka.ms/policydefdeprecation",
            "display_name": "[Deprecated]: Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"deprecated\":true,\"version\":\"2.1.0-deprecated\"}",
            "mode": "All",
            "name": "0961003e-5a0a-4549-abde-af6a37f2724d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.Compute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"d57a4221-a804-52ca-3dea-768284f06bb7\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/098fc59e-46c7-4d99-9b16-64990e543d75",
          "schema_version": 0,
          "attributes": {
            "description": "Limit pod HostPath volume mounts to the allowed host paths in a Kubernetes Cluster. This policy is generally available for Kubernetes Service (AKS), and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster pod hostPath volumes should only use allowed host paths",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/098fc59e-46c7-4d99-9b16-64990e543d75",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"6.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "098fc59e-46c7-4d99-9b16-64990e543d75",
            "parameters": "{\"allowedHostPaths\":{\"type\":\"Object\",\"defaultValue\":{\"paths\":[]},\"metadata\":{\"description\":\"The host paths allowed for pod hostPath volumes to use. Provide an empty paths list to block all host paths.\",\"displayName\":\"Allowed host paths\",\"portalReview\":true}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from readonly evaluation. It will not exclude the disallowed host path. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/allowed-host-paths/v3/template.yaml\"},\"values\":{\"allowedHostPaths\":\"[parameters('allowedHostPaths').paths]\",\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
          "schema_version": 0,
          "attributes": {
            "description": "Manage your organizational compliance requirements by specifying the maximum amount of time that a certificate can be valid within your key vault.",
            "display_name": "Certificates should have the specified maximum validity period",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"2.2.1\"}",
            "mode": "Microsoft.KeyVault.Data",
            "name": "0a075868-4c26-42ef-914c-5bc007359560",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\"}},\"maximumValidityInMonths\":{\"type\":\"Integer\",\"defaultValue\":12,\"metadata\":{\"description\":\"The limit to how long a certificate may be valid for. Certificates with lengthy validity periods aren't best practice.\",\"displayName\":\"The maximum validity in months\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault.Data/vaults/certificates\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault.Data/vaults/certificates/properties.validityInMonths\",\"greater\":\"[parameters('maximumValidityInMonths')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990",
          "schema_version": 0,
          "attributes": {
            "description": "Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for MariaDB. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.",
            "display_name": "Private endpoint should be enabled for MariaDB servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "0a1302fb-a631-4106-9753-f3d494733990",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Approved\",\"field\":\"Microsoft.DBforMariaDB/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\"},\"type\":\"Microsoft.DBforMariaDB/servers/privateEndpointConnections\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0a15ec92-a229-4763-bb14-0ea34a568f8d",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Policy Add-on for Kubernetes service (AKS) extends Gatekeeper v3, an admission controller webhook for Open Policy Agent (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.",
            "display_name": "Azure Policy Add-on for Kubernetes service (AKS) should be installed and enabled on your clusters",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0a15ec92-a229-4763-bb14-0ea34a568f8d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "0a15ec92-a229-4763-bb14-0ea34a568f8d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\"},{\"equals\":\"false\",\"field\":\"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
          "schema_version": 0,
          "attributes": {
            "description": "Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.",
            "display_name": "SQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.1\"}",
            "mode": "All",
            "name": "0a370ff3-6cab-4e85-8995-295fd854c5b8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"notContains\":\"/providers/Microsoft.Synapse/\",\"value\":\"[resourcegroup().managedBy]\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Sql/servers/keyid\"},{\"equals\":\"\",\"field\":\"Microsoft.Sql/servers/keyid\"}]}]},{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/encryptionProtector\",\"field\":\"type\"},{\"notContains\":\"/providers/Microsoft.Synapse/\",\"value\":\"[resourcegroup().managedBy]\"},{\"field\":\"Microsoft.Sql/servers/encryptionProtector/serverKeyType\",\"notequals\":\"AzureKeyVault\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0a9fbe0d-c5c4-4da8-87d8-f4fd77338835",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for open-source relational databases detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. Learn more about the capabilities of Azure Defender for open-source relational databases at https://aka.ms/AzDforOpenSourceDBsDocu. Important: Enabling this plan will result in charges for protecting your open-source relational databases. Learn about the pricing on Security Center's pricing page: https://aka.ms/pricing-security-center",
            "display_name": "Azure Defender for open-source relational databases should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0a9fbe0d-c5c4-4da8-87d8-f4fd77338835",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "0a9fbe0d-c5c4-4da8-87d8-f4fd77338835",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"OpenSourceRelationalDatabases\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Web PubSub service. Learn more at: https://aka.ms/awps/privatelink.",
            "display_name": "Configure Azure Web PubSub Service to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Web PubSub\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "0b026355-49cb-467b-8ac4-f777874e175a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"webpubsub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-webpubsub-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure your subscription owners are notified when there is a potential security breach in their subscription, set email notifications to subscription owners for high severity alerts in Security Center.",
            "display_name": "Email notification to subscription owner for high severity alerts should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"2.1.0\"}",
            "mode": "All",
            "name": "0b15565f-aa9e-48ba-8619-45960f2c314d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"not\":{\"allOf\":[{\"equals\":\"Off\",\"field\":\"Microsoft.Security/securityContacts/alertsToAdmins\"},{\"anyOf\":[{\"equals\":\"High\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications.minimalSeverity\"},{\"count\":{\"field\":\"Microsoft.Security/securityContacts/notificationsSources[*]\",\"where\":{\"allOf\":[{\"equals\":\"Alert\",\"field\":\"Microsoft.Security/securityContacts/notificationsSources[*].sourceType\"},{\"equals\":\"High\",\"field\":\"Microsoft.Security/securityContacts/notificationsSources[*].Alert.minimalSeverity\"}]}},\"equals\":1}]}]}},\"existenceScope\":\"subscription\",\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
          "schema_version": 0,
          "attributes": {
            "description": "Malicious deletion of a key vault can lead to permanent data loss. You can prevent permanent data loss by enabling purge protection and soft delete. Purge protection protects you from insider attacks by enforcing a mandatory retention period for soft deleted key vaults. No one inside your organization or Microsoft will be able to purge your key vaults during the soft delete retention period. Keep in mind that key vaults created after September 1st 2019 have soft-delete enabled by default.",
            "display_name": "Key vaults should have deletion protection enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"2.1.0\"}",
            "mode": "Indexed",
            "name": "0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/createMode\",\"notEquals\":\"recover\"},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-09-01\",\"value\":\"[requestContext().apiVersion]\"},{\"anyOf\":[{\"equals\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\"},{\"exists\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\"}]}]},{\"allOf\":[{\"greaterOrEquals\":\"2019-09-01\",\"value\":\"[requestContext().apiVersion]\"},{\"equals\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\"}]},{\"exists\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enablePurgeProtection\"},{\"equals\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enablePurgeProtection\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0c28c3fb-c244-42d5-a9bf-f35f2999577b",
          "schema_version": 0,
          "attributes": {
            "description": "Require Azure SQL Managed Instance to use Microsoft Entra-only authentication. This policy doesn't block Azure SQL Managed instances from being created with local authentication enabled. It does block local authentication from being enabled on resources after create. Consider using the 'Microsoft Entra-only authentication' initiative instead to require both. Learn more at: https://aka.ms/adonlycreate.",
            "display_name": "Azure SQL Managed Instance should have Microsoft Entra-only authentication enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0c28c3fb-c244-42d5-a9bf-f35f2999577b",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "0c28c3fb-c244-42d5-a9bf-f35f2999577b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances/azureADOnlyAuthentications\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Sql/managedInstances/azureADOnlyAuthentications/azureADOnlyAuthentication\"},{\"equals\":false,\"field\":\"Microsoft.Sql/managedInstances/azureADOnlyAuthentications/azureADOnlyAuthentication\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0cfea604-3201-4e14-88fc-fae4c427a6c5",
          "schema_version": 0,
          "attributes": {
            "description": "Deprecated accounts with owner permissions should be removed from your subscription.  Deprecated accounts are accounts that have been blocked from signing in.",
            "display_name": "Blocked accounts with owner permissions on Azure resources should be removed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0cfea604-3201-4e14-88fc-fae4c427a6c5",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "0cfea604-3201-4e14-88fc-fae4c427a6c5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"050ac097-3dda-4d24-ab6d-82568e7a50cf\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
          "schema_version": 0,
          "attributes": {
            "description": "Use a managed identity for enhanced authentication security",
            "display_name": "Function apps should use managed identity",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Web/sites/config/managedServiceIdentityId\"},{\"exists\":\"true\",\"field\":\"Microsoft.Web/sites/config/xmanagedServiceIdentityId\"}]},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea",
          "schema_version": 0,
          "attributes": {
            "description": "Restrict access to the Kubernetes Service Management API by granting API access only to IP addresses in specific ranges. It is recommended to limit access to authorized IP ranges to ensure that only applications from allowed networks can access the cluster.",
            "display_name": "Authorized IP ranges should be defined on Kubernetes Services",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"2.0.1\"}",
            "mode": "All",
            "name": "0e246bcf-5f6f-4f87-bc6f-775d4712c7ea",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.authorizedIPRanges\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\"},{\"equals\":\"false\",\"field\":\"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9",
          "schema_version": 0,
          "attributes": {
            "description": "Remote debugging requires inbound ports to be opened on Function apps. Remote debugging should be turned off.",
            "display_name": "Function apps should have remote debugging turned off",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "0e60b895-3786-45da-8377-9c6b4b6ac5f9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/config/web.remoteDebuggingEnabled\"},\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit key vault accounts.",
            "display_name": "Azure Defender for Key Vault should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.3\"}",
            "mode": "All",
            "name": "0e6763cc-5078-4e64-889d-ff4d9a839047",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"KeyVaults\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can control exposure of your resources by creating private endpoints instead. Learn more at: https://learn.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/private-link. ",
            "display_name": "Azure Databricks Workspaces should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Databricks\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.Databricks/workspaces/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for MariaDB allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.",
            "display_name": "Geo-redundant backup should be enabled for Azure Database for MariaDB",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "0ec47710-77ff-4a3d-9181-6aa50af424d0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/storageProfile.geoRedundantBackup\",\"notEquals\":\"Enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that container registries are not exposed on the public internet. Creating private endpoints can limit exposure of container registry resources. Learn more at: https://aka.ms/acr/portal/public-network and https://aka.ms/acr/private-link.",
            "display_name": "Public network access should be disabled for Container registries",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "0fdf0491-d080-4575-b627-ad0e843cba0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417",
          "schema_version": 0,
          "attributes": {
            "description": "Manage your organizational compliance requirements by specifying whether a certificate lifetime action is triggered at a specific percentage of its lifetime or at a certain number of days prior to its expiration.",
            "display_name": "Certificates should have the specified lifetime action triggers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"2.1.0\"}",
            "mode": "Microsoft.KeyVault.Data",
            "name": "12ef42cb-9903-4e39-9c26-422d29570417",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\"}},\"maximumPercentageLife\":{\"type\":\"Integer\",\"metadata\":{\"description\":\"Enter the percentage of lifetime of the certificate when you want to trigger the policy action. For example, to trigger a policy action at 80% of the certificate's valid life, enter '80'.\",\"displayName\":\"The maximum lifetime percentage\"}},\"minimumDaysBeforeExpiry\":{\"type\":\"Integer\",\"metadata\":{\"description\":\"Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.\",\"displayName\":\"The minimum days before expiry\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault.Data/vaults/certificates\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"exists\":true,\"field\":\"Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.daysBeforeExpiry\"},{\"field\":\"Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.daysBeforeExpiry\",\"less\":\"[parameters('minimumDaysBeforeExpiry')]\"}]},{\"allOf\":[{\"exists\":true,\"field\":\"Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.lifetimePercentage\"},{\"field\":\"Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.lifetimePercentage\",\"greater\":\"[parameters('maximumPercentageLife')]\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/138ff14d-b687-4faa-a81c-898c91a87fa2",
          "schema_version": 0,
          "attributes": {
            "description": "Resource logs enable recreating activity trails to use for investigation purposes when a security incident occurs or when your network is compromised.",
            "display_name": "Resource logs in Azure Databricks Workspaces should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/138ff14d-b687-4faa-a81c-898c91a87fa2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Databricks\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "138ff14d-b687-4faa-a81c-898c91a87fa2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days if exporting to an Azure Storage account\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/13a6c84f-49a5-410a-b5df-5b880c3fe009",
          "schema_version": 0,
          "attributes": {
            "description": "All OS boot components (boot loader, kernel, kernel drivers) must be signed by trusted publishers. Defender for Cloud has identified untrusted OS boot components on one or more of your Linux machines. To protect your machines from potentially malicious components, add them to your allow list or remove the identified components.",
            "display_name": "[Preview]: Linux virtual machines should use only signed and trusted boot components",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/13a6c84f-49a5-410a-b5df-5b880c3fe009",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "mode": "All",
            "name": "13a6c84f-49a5-410a-b5df-5b880c3fe009",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"ad50b498-f90c-451f-886f-d0a169cc5002\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender includes vulnerability scanning for your machines at no extra cost. You don't need a Qualys license or even a Qualys account - everything's handled seamlessly inside Security Center. When you enable this policy, Azure Defender automatically deploys the Qualys vulnerability assessment provider to all supported machines that don't already have it installed.",
            "display_name": "Configure machines to receive a vulnerability assessment provider",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"4.0.0\"}",
            "mode": "Indexed",
            "name": "13ce0167-8ca6-4048-8e6b-f996402e3c1b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"vaType\":{\"type\":\"String\",\"allowedValues\":[\"default\",\"mdeTvm\"],\"defaultValue\":\"default\",\"metadata\":{\"description\":\"Select the vulnerability assessment solution to provision to machines.\",\"displayName\":\"Vulnerability assessment provider type\"}}}",
            "policy_rule": "{\"if\":{\"anyof\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"tags\",\"notContainsKey\":\"MDFCSecurityConnector\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"resourceType\":{\"value\":\"[field('type')]\"},\"vaType\":{\"value\":\"[parameters('vaType')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"resourceType\":{\"type\":\"string\"},\"vaType\":{\"type\":\"string\"},\"vmName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-01-01\",\"condition\":\"[equals(toLower(parameters('resourceType')), toLower('microsoft.compute/virtualmachines'))]\",\"name\":\"[variables('resourceNameAndVaType')]\",\"type\":\"Microsoft.Compute/virtualMachines/providers/serverVulnerabilityAssessments\"},{\"apiVersion\":\"2020-01-01\",\"condition\":\"[equals(toLower(parameters('resourceType')), toLower('microsoft.hybridcompute/machines'))]\",\"name\":\"[variables('resourceNameAndVaType')]\",\"type\":\"Microsoft.HybridCompute/machines/providers/serverVulnerabilityAssessments\"}],\"variables\":{\"resourceNameAndVaType\":\"[concat(parameters('vmName'), '/Microsoft.Security/', parameters('vaType'))]\"}}}},\"evaluationDelay\":\"PT60M\",\"existenceCondition\":{\"anyOf\":[{\"equals\":\"NotApplicable\",\"field\":\"Microsoft.Security/assessments/status.code\"},{\"allOf\":[{\"equals\":\"Healthy\",\"field\":\"Microsoft.Security/assessments/status.code\"},{\"equals\":\"[parameters('vaType')]\",\"field\":\"Microsoft.Security/assessments/status.cause\"}]}]},\"name\":\"ffff0522-1e88-47fc-8382-2a80ba848f5d\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/146412e9-005c-472b-9e48-c87b72ac229e",
          "schema_version": 0,
          "attributes": {
            "description": "Audit provisioning of a Microsoft Entra administrator for your MySQL server to enable Microsoft Entra authentication. Microsoft Entra authentication enables simplified permission management and centralized identity management of database users and other Microsoft services",
            "display_name": "A Microsoft Entra administrator should be provisioned for MySQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/146412e9-005c-472b-9e48-c87b72ac229e",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "146412e9-005c-472b-9e48-c87b72ac229e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"type\":\"Microsoft.DBforMySQL/servers/administrators\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
          "schema_version": 0,
          "attributes": {
            "description": "Cryptographic keys should have a defined expiration date and not be permanent. Keys that are valid forever provide a potential attacker with more time to compromise the key. It is a recommended security practice to set expiration dates on cryptographic keys.",
            "display_name": "Key Vault keys should have an expiration date",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.0.2\"}",
            "mode": "Microsoft.KeyVault.Data",
            "name": "152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault.Data/vaults/keys\",\"field\":\"type\"},{\"exists\":false,\"field\":\"Microsoft.KeyVault.Data/vaults/keys/attributes.expiresOn\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/17f4b1cc-c55c-4d94-b1f9-2978f6ac2957",
          "schema_version": 0,
          "attributes": {
            "description": "Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. This recommendation provides visibility to vulnerable images currently running in your Kubernetes clusters. Remediating vulnerabilities in container images that are currently running is key to improving your security posture, significantly reducing the attack surface for your containerized workloads.",
            "display_name": "Azure running container images should have vulnerabilities resolved (powered by Microsoft Defender Vulnerability Management)",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/17f4b1cc-c55c-4d94-b1f9-2978f6ac2957",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "17f4b1cc-c55c-4d94-b1f9-2978f6ac2957",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"c609cf0f-71ab-41e9-a3c6-9a1f7fe1b8d5\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
          "schema_version": 0,
          "attributes": {
            "description": "Transparent data encryption should be enabled to protect data-at-rest and meet compliance requirements",
            "display_name": "Transparent Data Encryption on SQL databases should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "17k78e20-9358-41c9-923c-fb736d382a12",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notEquals\":\"master\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"anyOf\":[{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/transparentDataEncryption.status\"},{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/servers/databases/transparentDataEncryption/state\"}]},\"name\":\"current\",\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "PostgreSQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "mode": "Indexed",
            "name": "18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforPostgreSQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/19dd1db6-f442-49cf-a838-b0786b4401ef",
          "schema_version": 0,
          "attributes": {
            "description": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app. This policy applies to apps with Http version set to 1.1.",
            "display_name": "App Service apps should have Client Certificates (Incoming client certificates) enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/19dd1db6-f442-49cf-a838-b0786b4401ef",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "19dd1db6-f442-49cf-a838-b0786b4401ef",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"},{\"field\":\"Microsoft.Web/sites/clientCertEnabled\",\"notEquals\":\"true\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"true\",\"field\":\"Microsoft.Web/sites/config/web.http20Enabled\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
            "display_name": "Kubernetes clusters should be accessible only over HTTPS",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"8.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"extensions\",\"networking.k8s.io\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Ingress\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/ingress-https-only/v1/template.yaml\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1b4d1c4e-934c-4703-944c-27c82c06bebb",
          "schema_version": 0,
          "attributes": {
            "description": "Enable logs for Azure AI services resources. This enables you to recreate activity trails for investigation purposes, when a security incident occurs or your network is compromised",
            "display_name": "Diagnostic logs in Azure AI services resources should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1b4d1c4e-934c-4703-944c-27c82c06bebb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Ai Services\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "1b4d1c4e-934c-4703-944c-27c82c06bebb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"exists\":true,\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\"},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that the App Service is not exposed on the public internet. Creating private endpoints can limit exposure of an App Service. Learn more at: https://aka.ms/app-service-private-endpoint.",
            "display_name": "App Service apps should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Web/sites/publicNetworkAccess\"},{\"field\":\"Microsoft.Web/sites/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a",
          "schema_version": 0,
          "attributes": {
            "description": "Audit each SQL Managed Instance which doesn't have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.",
            "display_name": "Vulnerability assessment should be enabled on SQL Managed Instance",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "1b7aa243-30e4-4c9e-bca8-d0d3022b634a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"True\",\"field\":\"Microsoft.Sql/managedInstances/vulnerabilityAssessments/recurringScans.isEnabled\"},\"name\":\"default\",\"type\":\"Microsoft.Sql/managedInstances/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.",
            "display_name": "Public network access on Azure SQL Database should be disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machines if the virtual machine image is in the list defined and the agent is not installed.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.3.0\"}",
            "mode": "Indexed",
            "name": "1c210e94-a481-4beb-95fa-1571b434fb04",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter\",\"2022-datacenter-g2\",\"2022-datacenter-smalldisk-g2\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1c30f9cd-b84c-49cc-aa2c-9288447cc3b3",
          "schema_version": 0,
          "attributes": {
            "description": "Enable virtual TPM device on supported virtual machines to facilitate Measured Boot and other OS security features that require a TPM. Once enabled, vTPM can be used to attest boot integrity. This assessment only applies to trusted launch enabled virtual machines.",
            "display_name": "[Preview]: vTPM should be enabled on supported virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1c30f9cd-b84c-49cc-aa2c-9288447cc3b3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"2.0.0-preview\"}",
            "mode": "Indexed",
            "name": "1c30f9cd-b84c-49cc-aa2c-9288447cc3b3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"equals\":\"TrustedLaunch\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.securityType\"},{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings\"},{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.vTpmEnabled\",\"notequals\":\"true\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow containers to run with privilege escalation to root in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should not allow container privilege escalation",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"7.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/container-no-privilege-escalation/v3/template.yaml\"},\"values\":{\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.",
            "display_name": "Microsoft Defender for Containers should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Containers\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1cb4d9c2-f88f-4069-bee0-dba239a57b09",
          "schema_version": 0,
          "attributes": {
            "description": "Install Guest Attestation extension on supported virtual machines to allow Azure Security Center to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Windows virtual machines.",
            "display_name": "[Preview]: Guest Attestation extension should be installed on supported Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1cb4d9c2-f88f-4069-bee0-dba239a57b09",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"4.0.0-preview\"}",
            "mode": "Indexed",
            "name": "1cb4d9c2-f88f-4069-bee0-dba239a57b09",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.imageReference.offer\",\"like\":\"windows*\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.securityType\",\"in\":[\"TrustedLaunch\",\"ConfidentialVM\"]},{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.secureBootEnabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.vTpmEnabled\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.Security.WindowsAttestation\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"GuestAttestation\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\"in\":[\"Succeeded\",\"Provisioning succeeded\"]}]},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
          "schema_version": 0,
          "attributes": {
            "description": "Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management",
            "display_name": "Virtual machines should be migrated to new Azure Resource Manager resources",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.Compute/virtualMachines\"]},{\"equals\":\"Microsoft.ClassicCompute/virtualMachines\",\"value\":\"[field('type')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1dc2fc00-2245-4143-99f4-874c937f13ef",
          "schema_version": 0,
          "attributes": {
            "description": "Azure API Management stv1 compute platform version will be retired effective 31 August 2024, and these instances should be migrated to stv2 compute platform for continued support. Learn more at https://learn.microsoft.com/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024",
            "display_name": "Azure API Management platform version should be stv2",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1dc2fc00-2245-4143-99f4-874c937f13ef",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "1dc2fc00-2245-4143-99f4-874c937f13ef",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},{\"equals\":\"stv1\",\"field\":\"Microsoft.ApiManagement/service/platformVersion\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Synapse workspace. Learn more at: https://docs.microsoft.com/azure/synapse-analytics/security/how-to-connect-to-workspace-from-restricted-network#appendix-dns-registration-for-private-endpoint.",
            "display_name": "Configure Azure Synapse workspaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A private DNS zone Id\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"targetSubResource\":{\"type\":\"String\",\"allowedValues\":[\"Dev\",\"Sql\",\"SqlOnDemand\"],\"defaultValue\":\"Dev\",\"metadata\":{\"description\":\"Target sub resource the private endpoint connects to\",\"displayName\":\"Target sub-resource\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Synapse/workspaces\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('targetSubResource')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"synapse-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
          "schema_version": 0,
          "attributes": {
            "description": "Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the key vault. Accidental deletion of a key vault can lead to permanent data loss. Soft delete allows you to recover an accidentally deleted key vault for a configurable retention period.",
            "display_name": "Key vaults should have soft delete enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"not\":{\"equals\":\"recover\",\"field\":\"Microsoft.KeyVault/vaults/createMode\"}},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-09-01\",\"value\":\"[requestContext().apiVersion]\"},{\"anyOf\":[{\"equals\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\"},{\"exists\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\"}]}]},{\"allOf\":[{\"greaterOrEquals\":\"2019-09-01\",\"value\":\"[requestContext().apiVersion]\"},{\"equals\":\"false\",\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1ec9c2c2-6d64-656d-6465-3ec3309b8579",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys Microsoft Defender for Endpoint on applicable Windows VM images.",
            "display_name": "[Preview]: Deploy Microsoft Defender for Endpoint agent on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1ec9c2c2-6d64-656d-6465-3ec3309b8579",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"2.0.1-preview\"}",
            "mode": "Indexed",
            "name": "1ec9c2c2-6d64-656d-6465-3ec3309b8579",
            "parameters": "{\"ImageIdsToExclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoImage'\",\"displayName\":\"Optional: List of virtual machine images to exclude\"}},\"PublishersToExclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Windows image Publishers to exclude from MDE provision\",\"displayName\":\"Optional: List Of Image Publishers to exclude\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"},{\"anyOf\":[{\"not\":{\"field\":\"Microsoft.Compute/virtualMachines/imagePublisher\",\"in\":\"[parameters('PublishersToExclude')]\"}},{\"equals\":\"true\",\"value\":\"[empty(parameters('PublishersToExclude'))]\"}]},{\"anyOf\":[{\"not\":{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.imageReference.id\",\"in\":\"[parameters('ImageIdsToExclude')]\"}},{\"equals\":\"true\",\"value\":\"[empty(parameters('ImageIdsToExclude'))]\"}]},{\"anyOf\":[{\"not\":{\"anyOf\":[{\"contains\":\"win7\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"contains\":\"win8\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"contains\":\"2008\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"contains\":\"win10\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"contains\":\"windows-10\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"contains\":\"windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"azureopenshift\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"AzureDatabricks\",\"field\":\"Microsoft.Compute/imagePublisher\"}]}},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"contains\":\"evd\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"azureResourceId\":{\"value\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/',field('name'))]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"azureResourceId\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/MDE.Windows')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"defenderForEndpointOnboardingScript\":\"[reference(subscriptionResourceId('Microsoft.Security/mdeOnboardings', 'Windows'), '2021-10-01-preview', 'full').properties.onboardingPackageWindows]\"},\"publisher\":\"Microsoft.Azure.AzureDefenderForServers\",\"settings\":{\"azureResourceId\":\"[parameters('azureResourceId')]\",\"installedBy\":\"Policy\",\"vNextEnabled\":\"true\"},\"type\":\"MDE.Windows\",\"typeHandlerVersion\":\"1.0\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.AzureDefenderForServers\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"MDE.Windows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"name\":\"MDE.Windows\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
          "schema_version": 0,
          "attributes": {
            "description": "Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services",
            "display_name": "An Azure Active Directory administrator should be provisioned for SQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "1f314764-cb73-4fc9-b863-8eca98ac36e9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"type\":\"Microsoft.Sql/servers/administrators\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Event Hub to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.0\"}",
            "mode": "Indexed",
            "name": "1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventHub/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ArchiveLogs\",\"enabled\":true,\"retentionPolicy\":{\"days\":0,\"enabled\":false}},{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AutoScaleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaCoordinatorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaUserErrorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EventHubVNetConnectionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CustomerManagedKeyUserLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RuntimeAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationMetricsLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DiagnosticErrorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventHub/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"anyOf\":[{\"allOf\":[{\"equals\":\"false\",\"value\":\"[parameters('logsEnabled')]\"},{\"equals\":\"false\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\"}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('logsEnabled')]\"},{\"anyOf\":[{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\",\"in\":[\"ArchiveLogs\",\"OperationalLogs\",\"AutoScaleLogs\",\"KafkaCoordinatorLogs\",\"KafkaUserErrorLogs\",\"EventHubVNetConnectionEvent\",\"CustomerManagedKeyUserLogs\",\"RuntimeAuditLogs\",\"ApplicationMetricsLogs\",\"DiagnosticErrorLogs\"]}]}},\"equals\":9},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"AllLogs\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].categoryGroup\"}]}},\"equals\":1}]}]}]},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit key vault accounts.",
            "display_name": "Configure Microsoft Defender for Key Vault plan",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "1f725891-01c0-420a-9059-4fa46cb770b7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"subPlan\":{\"type\":\"String\",\"allowedValues\":[\"PerTransaction\",\"PerKeyVault\"],\"defaultValue\":\"PerTransaction\",\"metadata\":{\"description\":\"Select a Defender for Key Vault plan\",\"displayName\":\"Key Vaults bundle's sub plan\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"subPlan\":{\"value\":\"[parameters('subPlan')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"subPlan\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"KeyVaults\",\"properties\":{\"pricingTier\":\"Standard\",\"subPlan\":\"[parameters('subPlan')]\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},{\"equals\":\"[parameters('subPlan')]\",\"field\":\"Microsoft.Security/pricings/subPlan\"}]},\"existenceScope\":\"subscription\",\"name\":\"KeyVaults\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/cosmosdb-cmk.",
            "display_name": "Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"exists\":false,\"field\":\"Microsoft.DocumentDB/databaseAccounts/keyVaultKeyUri\"},{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f90fc71-a595-4066-8974-d4d0802e8ef0",
          "schema_version": 0,
          "attributes": {
            "description": "Defender Cloud Security Posture Management (CSPM) provides enhanced posture capabilities and a new intelligent cloud security graph to help identify, prioritize, and reduce risk. Defender CSPM is available in addition to the free foundational security posture capabilities turned on by default in Defender for Cloud.",
            "display_name": "Microsoft Defender CSPM should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f90fc71-a595-4066-8974-d4d0802e8ef0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "1f90fc71-a595-4066-8974-d4d0802e8ef0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"CloudPosture\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2154edb9-244f-4741-9970-660785bccdaa",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your VM Image Builder building resources, data leakage risks are reduced. Learn more about private links at: https://docs.microsoft.com/azure/virtual-machines/linux/image-builder-networking#deploy-using-an-existing-vnet.",
            "display_name": "VM Image Builder templates should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2154edb9-244f-4741-9970-660785bccdaa",
            "management_group_name": null,
            "metadata": "{\"category\":\"VM Image Builder\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "2154edb9-244f-4741-9970-660785bccdaa",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.VirtualMachineImages/imageTemplates\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.VirtualMachineImages/imageTemplates/vmProfile.vnetConfig\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
          "schema_version": 0,
          "attributes": {
            "description": "Require Synapse Workspaces to be created with Microsoft Entra-only authentication. This policy doesn't block local authentication from being re-enabled on resources after create. Consider using the 'Microsoft Entra-only authentication' initiative instead to require both. Learn more at: https://aka.ms/Synapse.",
            "display_name": "Synapse Workspaces should use only Microsoft Entra identities for authentication during workspace creation",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Synapse/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Synapse/workspaces/extraProperties\"},{\"equals\":1,\"value\":\"[if(empty(field('Microsoft.Synapse/workspaces/extraProperties')), 0, length(intersection(field('Microsoft.Synapse/workspaces/extraProperties'), createObject('WorkspaceType', 'Normal'))))]\"}]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Synapse/workspaces/azureADOnlyAuthentication\"},{\"equals\":false,\"field\":\"Microsoft.Synapse/workspaces/azureADOnlyAuthentication\"},{\"allOf\":[{\"exists\":true,\"field\":\"Microsoft.Synapse/workspaces/settings\"},{\"equals\":1,\"value\":\"[if(empty(field('Microsoft.Synapse/workspaces/settings')), 0, length(intersection(field('Microsoft.Synapse/workspaces/settings'), createObject('azureADOnlyAuthentication', createObject('value', 'true', 'state', 'Inconsistent')))))]\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling local authentication methods improves security by ensuring that VPN Gateways use only Azure Active Directory identities for authentication. Learn more about Azure AD authentication at https://docs.microsoft.com/azure/vpn-gateway/openvpn-azure-ad-tenant",
            "display_name": "VPN gateways should use only Azure Active Directory (Azure AD) authentication for point-to-site users",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "21a6bc25-125e-4d13-b82d-2e19b7208ab7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworkGateways\",\"field\":\"type\"},{\"exists\":\"true\",\"field\":\"Microsoft.Network/virtualNetworkGateways/vpnClientConfiguration.vpnClientAddressPool.addressPrefixes\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworkGateways/vpnClientConfiguration.vpnAuthenticationTypes[*]\",\"where\":{\"field\":\"Microsoft.Network/virtualNetworkGateways/vpnClientConfiguration.vpnAuthenticationTypes[*]\",\"notcontains\":\"AAD\"}},\"greaterOrEquals\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public endpoint allows you to restrict access to your Storage Sync Service resource to requests destined to approved private endpoints on your organization's network. There is nothing inherently insecure about allowing requests to the public endpoint, however, you may wish to disable it to meet regulatory, legal, or organizational policy requirements. You can disable the public endpoint for a Storage Sync Service by setting the incomingTrafficPolicy of the resource to AllowVirtualNetworksOnly.",
            "display_name": "Public network access should be disabled for Azure File Sync",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.StorageSync/storageSyncServices\",\"field\":\"type\"},{\"field\":\"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\"notEquals\":\"AllowVirtualNetworksOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
          "schema_version": 0,
          "attributes": {
            "description": "Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.",
            "display_name": "Management ports should be closed on your virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "22730e10-96f6-4aac-ad84-9383d35b5917",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"bc303248-3d14-44c2-96a0-55f5c326b5fe\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Only secure connections to your Azure Cache for Redis should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cache\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "22bee202-a82f-4305-9a2a-6d7f44d4dedb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/233a2a17-77ca-4fb1-9b6b-69223d272a44",
          "schema_version": 0,
          "attributes": {
            "description": "Restrict services to listen only on allowed ports to secure access to the Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster services should listen only on allowed ports",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/233a2a17-77ca-4fb1-9b6b-69223d272a44",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"8.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "233a2a17-77ca-4fb1-9b6b-69223d272a44",
            "parameters": "{\"allowedServicePortsList\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of service ports allowed in a Kubernetes cluster. Array only accepts strings. Example: [\\\"443\\\", \\\"80\\\"]\",\"displayName\":\"Allowed service ports list\",\"portalReview\":true}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Service\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/service-allowed-ports/v1/template.yaml\"},\"values\":{\"allowedPorts\":\"[parameters('allowedServicePortsList')]\",\"allowedServicePorts\":\"[parameters('allowedServicePortsList')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
          "schema_version": 0,
          "attributes": {
            "description": "This policy definition is no longer the recommended way to achieve its intent, because DNS bundle is being deprecated. Instead of continuing to use this policy, we recommend you assign this replacement policy with policy ID 8e86a5b6-b9bd-49d1-8e21-4bb8a0862222. Learn more about policy definition deprecation at aka.ms/policydefdeprecation",
            "display_name": "[Deprecated]: Configure Azure Defender for DNS to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"deprecated\":true,\"version\":\"1.1.0-deprecated\"}",
            "mode": "All",
            "name": "2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"Dns\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Dns\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.StreamAnalytics/streamingjobs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Execution\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Authoring\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2393d2cf-a342-44cd-a2e2-fe0188fd1234",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your Azure SignalR Service resource instead of the entire service, you'll reduce your data leakage risks. Learn more about private links at: https://aka.ms/asrs/privatelink.",
            "display_name": "Azure SignalR Service should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2393d2cf-a342-44cd-a2e2-fe0188fd1234",
            "management_group_name": null,
            "metadata": "{\"category\":\"SignalR\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "2393d2cf-a342-44cd-a2e2-fe0188fd1234",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.SignalRService/SignalR\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.SignalRService/SignalR/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.SignalRService/SignalR/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/245fc9df-fa96-4414-9a0b-3738c2f7341c",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Kubernetes Service's resource logs can help recreate activity trails when investigating security incidents. Enable it to make sure the logs will exist when needed",
            "display_name": "Resource logs in Azure Kubernetes Service should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/245fc9df-fa96-4414-9a0b-3738c2f7341c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "245fc9df-fa96-4414-9a0b-3738c2f7341c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention (in days)\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events",
            "display_name": "Configure Azure Activity logs to stream to specified Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"location\":\"Global\",\"name\":\"subscriptionToLa\",\"properties\":{\"logs\":[{\"category\":\"Administrative\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Security\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ServiceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Alert\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Recommendation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Policy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ResourceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Insights/diagnosticSettings\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"existenceScope\":\"Subscription\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/258823f2-4595-4b52-b333-cc96192710d8",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Databricks workspaces, you can reduce data leakage risks. Learn more about private links at: https://aka.ms/adbpe.",
            "display_name": "Azure Databricks Workspaces should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/258823f2-4595-4b52-b333-cc96192710d8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Databricks\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "258823f2-4595-4b52-b333-cc96192710d8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Databricks/workspaces/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.Databricks/workspaces/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for File Services to stream resource logs to a Log Analytics workspace when any file Service which is missing this diagnostic settings is created or updated.",
            "display_name": "Configure diagnostic settings for File Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.0\"}",
            "mode": "All",
            "name": "25a70cc8-2bd4-47f1-90b6-1478e4662c96",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"fileServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/fileServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure the operations performed against your SQL assets are captured, SQL servers should have auditing enabled. If auditing is not enabled, this policy will configure auditing events to flow to the specified Log Analytics workspace.",
            "display_name": "Configure SQL servers to have auditing enabled to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "25da7dfb-0666-4a15-a8f5-402127efd8bb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalyticsWorkspaceId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Auditing will write database events to this Log Analytics Workspace. This should be in the following format '/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/{resourcegroup}/providers/Microsoft.OperationalInsights/workspaces/{logAnalyticsWorkspaceName}'\",\"displayName\":\"Log Analytics Workspace ID\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalyticsWorkspaceId\":{\"value\":\"[parameters('logAnalyticsWorkspaceId')]\"},\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"logAnalyticsWorkspaceId\":{\"minLength\":90,\"type\":\"string\"},\"serverName\":{\"minLength\":3,\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"name\":\"[concat(parameters('serverName'),'/master/microsoft.insights/SQLSecurityAuditEvents_3d229c42-c7e7-4c97-9a99-ec0d0d8b86c1')]\",\"properties\":{\"logs\":[{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":true}],\"workspaceId\":\"[parameters('logAnalyticsWorkspaceId')]\"},\"type\":\"Microsoft.Sql/servers/databases/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('serverName'),'/default')]\",\"properties\":{\"State\":\"Enabled\",\"isAzureMonitorTargetEnabled\":true},\"type\":\"Microsoft.Sql/servers/auditingSettings\"}]}}},\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/servers/auditingSettings/state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for App Service leverages the scale of the cloud, and the visibility that Azure has as a cloud provider, to monitor for common web app attacks.",
            "display_name": "Azure Defender for App Service should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.3\"}",
            "mode": "All",
            "name": "2913021d-f2fd-4f3d-b958-22354e2bdbcb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"AppServices\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your storage accounts from potential threats using virtual network rules as a preferred method instead of IP-based filtering. Disabling IP-based filtering prevents public IPs from accessing your storage accounts.",
            "display_name": "Storage accounts should restrict network access using virtual network rules",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the audit policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\"notEquals\":\"Deny\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.ipRules[*]\"},\"greaterOrEquals\":1}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2a6ae02f-7590-40d7-88ba-b18e205a32fd",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Advanced Threat Protection on your Azure database for PostgreSQL flexible servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Advanced Threat Protection to be enabled on Azure database for PostgreSQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2a6ae02f-7590-40d7-88ba-b18e205a32fd",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "2a6ae02f-7590-40d7-88ba-b18e205a32fd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleservers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2023-06-01-preview\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.DBforPostgreSQL/flexibleservers/advancedThreatProtectionSettings\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioningSuccess\",\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/advancedThreatProtectionSettings/state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.DBforPostgreSQL/flexibleservers/advancedThreatProtectionSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332",
          "schema_version": 0,
          "attributes": {
            "description": "Use a managed identity for enhanced authentication security",
            "display_name": "App Service apps should use managed identity",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "2b9ad585-36bc-4615-b300-fd4435808332",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Web/sites/config/managedServiceIdentityId\"},{\"exists\":\"true\",\"field\":\"Microsoft.Web/sites/config/xmanagedServiceIdentityId\"}]},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure apps deployed in an App Service Environment are not accessible over public internet, one should deploy App Service Environment with an IP address in virtual network. To set the IP address to a virtual network IP, the App Service Environment must be deployed with an internal load balancer.",
            "display_name": "App Service Environment apps should not be reachable over public internet",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "2d048aca-6479-4923-88f5-e2ac295d9af3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/hostingEnvironments\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"ASE*\"},{\"field\":\"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\"notContains\":\"2\"},{\"field\":\"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\"notContains\":\"3\"},{\"field\":\"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\"notContains\":\"Web\"},{\"field\":\"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\"notContains\":\"Publishing\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d",
          "schema_version": 0,
          "attributes": {
            "description": "Security Center uses the Microsoft Dependency agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.",
            "display_name": "[Preview]: Network traffic data collection agent should be installed on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"1.0.2-preview\"}",
            "mode": "Indexed",
            "name": "2f2ee1de-44aa-4762-b6bd-0893fc3f306d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Dependency Agent for Windows VMs monitoring\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Table Services to stream resource logs to a Log Analytics workspace when any table Service which is missing this diagnostic settings is created or updated. Note: This policy is not triggered upon Storage Account creation and requires creation of a remediation task in order to update for the account.",
            "display_name": "Configure diagnostic settings for Table Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.1\"}",
            "mode": "All",
            "name": "2fb86bf3-d221-43d1-96d1-2434af34eaa0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from the dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"tableServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/tableServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/tableServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "[Preview]: Log Analytics Extension should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"2.0.1-preview\"}",
            "mode": "Indexed",
            "name": "32133ab0-ee4b-4b44-98d6-042180979d50",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
          "schema_version": 0,
          "attributes": {
            "description": "Setting TLS version to 1.2 or newer improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2 or newer. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
            "display_name": "Azure SQL Database should be running TLS version 1.2 or newer",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "32e6bbec-16b6-44c2-be37-c5b672d103cf",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"less\":\"1.2\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
          "schema_version": 0,
          "attributes": {
            "description": "This policy deploys the Linux Guest Configuration extension to Linux virtual machines hosted in Azure that are supported by Guest Configuration. The Linux Guest Configuration extension is a prerequisite for all Linux Guest Configuration assignments and must be deployed to machines before using any Linux Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "Deploy the Linux Guest Configuration extension to enable Guest Configuration assignments on Linux VMs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"version\":\"3.1.0\"}",
            "mode": "Indexed",
            "name": "331e8ea8-378a-410f-a2e5-ae22f38bb0da",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-win*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-07-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"protectedSettings\":{},\"publisher\":\"Microsoft.GuestConfiguration\",\"settings\":{},\"type\":\"ConfigurationforLinux\",\"typeHandlerVersion\":\"1.0\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.GuestConfiguration\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"ConfigurationforLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"name\":\"AzurePolicyforLinux\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/339353f6-2387-4a45-abe4-7f529d121046",
          "schema_version": 0,
          "attributes": {
            "description": "External accounts with owner permissions should be removed from your subscription in order to prevent unmonitored access.",
            "display_name": "Guest accounts with owner permissions on Azure resources should be removed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/339353f6-2387-4a45-abe4-7f529d121046",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "339353f6-2387-4a45-abe4-7f529d121046",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"20606e75-05c4-48c0-9d97-add6daa2109a\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
          "schema_version": 0,
          "attributes": {
            "description": "Network access to storage accounts should be restricted. Configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges",
            "display_name": "Storage accounts should restrict network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\"notEquals\":\"Deny\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Logic Apps should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Logic Apps\",\"version\":\"5.1.0\"}",
            "mode": "Indexed",
            "name": "34f95f76-5386-4de7-b824-0d8478470c9d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/workflows\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
          "schema_version": 0,
          "attributes": {
            "description": "It is important to enable encryption of Automation account variable assets when storing sensitive data",
            "display_name": "Automation account variables should be encrypted",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
            "management_group_name": null,
            "metadata": "{\"category\":\"Automation\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "3657f5a0-770e-44a3-b44e-9431ba1e9735",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Automation/automationAccounts/variables\",\"field\":\"type\"},{\"field\":\"Microsoft.Automation/automationAccounts/variables/isEncrypted\",\"notEquals\":\"true\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Defender on your Azure SQL Servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Azure Defender to be enabled on SQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.1.0\"}",
            "mode": "Indexed",
            "name": "36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-11-01-preview\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/securityAlertPolicies.state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"},\"effect\":\"DeployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/36f0d6bc-a253-4df8-b25b-c3a5023ff443",
          "schema_version": 0,
          "attributes": {
            "description": "Protect data on the Azure Stack HCI hosts network and on virtual machine network connections.",
            "display_name": "[Preview]: Host and VM networking should be protected on Azure Stack HCI systems",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/36f0d6bc-a253-4df8-b25b-c3a5023ff443",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stack HCI\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "mode": "Indexed",
            "name": "36f0d6bc-a253-4df8-b25b-c3a5023ff443",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"AuditIfNotExists\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.AzureStackHCI/clusters\",\"field\":\"type\"},{\"field\":\"Microsoft.AzureStackHCI/clusters/reportedProperties.clusterVersion\",\"greater\":\"10.0.20350\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"field\":\"Microsoft.AzureStackHCI/clusters/securitySettings/securityComplianceStatus.dataInTransitProtected\",\"in\":[\"Compliant\",\"Pending\"]}]},\"type\":\"Microsoft.AzureStackHCI/clusters/securitySettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/37c043a6-6d64-656d-6465-b362dfeb354a",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys Microsoft Defender for Endpoint on Windows Azure Arc machines.",
            "display_name": "[Preview]: Deploy Microsoft Defender for Endpoint agent on Windows Azure Arc machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/37c043a6-6d64-656d-6465-b362dfeb354a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"2.0.1-preview\"}",
            "mode": "Indexed",
            "name": "37c043a6-6d64-656d-6465-b362dfeb354a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/machines/osName\",\"like\":\"windows*\"},{\"field\":\"tags['MDFCSecurityConnector']\",\"notEquals\":\"true\"},{\"anyOf\":[{\"contains\":\"2012\",\"field\":\"Microsoft.HybridCompute/machines/osSku\"},{\"contains\":\"2016\",\"field\":\"Microsoft.HybridCompute/machines/osSku\"},{\"contains\":\"2019\",\"field\":\"Microsoft.HybridCompute/machines/osSku\"},{\"contains\":\"2022\",\"field\":\"Microsoft.HybridCompute/machines/osSku\"},{\"equals\":\"Windows 10 Enterprise multi-session\",\"field\":\"Microsoft.HybridCompute/machines/osSku\"},{\"equals\":\"Windows 10 Enterprise for Virtual Desktops\",\"field\":\"Microsoft.HybridCompute/machines/osSku\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"azureResourceId\":{\"value\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.HybridCompute/machines/',field('name'))]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"azureResourceId\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/MDE.Windows')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"defenderForEndpointOnboardingScript\":\"[reference(subscriptionResourceId('Microsoft.Security/mdeOnboardings', 'Windows'), '2021-10-01-preview', 'full').properties.onboardingPackageWindows]\"},\"publisher\":\"Microsoft.Azure.AzureDefenderForServers\",\"settings\":{\"azureResourceId\":\"[parameters('azureResourceId')]\",\"installedBy\":\"Policy\",\"vNextEnabled\":\"true\"},\"type\":\"MDE.Windows\",\"typeHandlerVersion\":\"1.0\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.AzureDefenderForServers\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"MDE.Windows\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"name\":\"MDE.Windows\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606",
          "schema_version": 0,
          "attributes": {
            "description": "Use new Azure Resource Manager for your storage accounts to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management",
            "display_name": "Storage accounts should be migrated to new Azure Resource Manager resources",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "37e0d2fe-28a5-43d6-a273-67d37d1f5606",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.ClassicStorage/storageAccounts\",\"Microsoft.Storage/StorageAccounts\"]},{\"equals\":\"Microsoft.ClassicStorage/storageAccounts\",\"value\":\"[field('type')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in IoT Hub should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"3.1.0\"}",
            "mode": "Indexed",
            "name": "383856f8-de7f-44a2-81fc-e5135b5c2aa4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Devices/IotHubs\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"not\":{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"}},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
          "schema_version": 0,
          "attributes": {
            "description": "This policy deploys the Windows Guest Configuration extension to Windows virtual machines hosted in Azure that are supported by Guest Configuration. The Windows Guest Configuration extension is a prerequisite for all Windows Guest Configuration assignments and must be deployed to machines before using any Windows Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "385f5831-96d4-41db-9a3c-cd3af78aaae6",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-07-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"protectedSettings\":{},\"publisher\":\"Microsoft.GuestConfiguration\",\"settings\":{},\"type\":\"ConfigurationforWindows\",\"typeHandlerVersion\":\"1.1\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.GuestConfiguration\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"ConfigurationforWindows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"name\":\"AzurePolicyforWindows\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
          "schema_version": 0,
          "attributes": {
            "description": "Enable FTPS enforcement for enhanced security.",
            "display_name": "Function apps should require FTPS only",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "399b2637-a50f-4f95-96f8-3a145476eb15",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Web/sites/config/ftpsState\",\"in\":[\"FtpsOnly\",\"Disabled\"]},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
          "schema_version": 0,
          "attributes": {
            "description": "API Management subscriptions should be scoped to a product or an individual API instead of all APIs, which could result in an excessive data exposure.",
            "display_name": "API Management subscriptions should not be scoped to all APIs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service/subscriptions\",\"field\":\"type\"},{\"field\":\"Microsoft.ApiManagement/service/subscriptions/scope\",\"like\":\"*/apis\"},{\"equals\":\"active\",\"field\":\"Microsoft.ApiManagement/service/subscriptions/state\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3ac7c827-eea2-4bde-acc7-9568cd320efa",
          "schema_version": 0,
          "attributes": {
            "description": "Audits virtual machines to detect whether they contain secret findings from the secret scanning solutions on your virtual machines.",
            "display_name": "Machines should have secret findings resolved",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3ac7c827-eea2-4bde-acc7-9568cd320efa",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "3ac7c827-eea2-4bde-acc7-9568cd320efa",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"17618b1a-ed14-49bb-b37f-9f8ba967be8b\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3bc8a0d5-38e0-4a3d-a657-2cb64468fc34",
          "schema_version": 0,
          "attributes": {
            "description": "Audit MySQL flexible servers without Advanced Data Security",
            "display_name": "Azure Defender for SQL should be enabled for unprotected MySQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3bc8a0d5-38e0-4a3d-a657-2cb64468fc34",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "3bc8a0d5-38e0-4a3d-a657-2cb64468fc34",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/flexibleservers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/state\"},\"name\":\"Default\",\"type\":\"Microsoft.DBforMySQL/flexibleservers/advancedThreatProtectionSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machine scale sets if the virtual machine image is in the list defined and the agent is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machines in the set by updating them.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.3.0\"}",
            "mode": "Indexed",
            "name": "3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter\",\"2022-datacenter-g2\",\"2022-datacenter-smalldisk-g2\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machine scale sets if the virtual machine image is in the list defined and the extension is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machine in the set by updating them. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "mode": "Indexed",
            "name": "3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter\",\"2022-datacenter-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-smalldisk-g2\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
          "schema_version": 0,
          "attributes": {
            "description": "This policy adds a system-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration but do not have any managed identities. A system-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"version\":\"4.1.0\"}",
            "mode": "Indexed",
            "name": "3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-win*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"greaterOrEquals\":\"2018-10-01\",\"value\":\"[requestContext().apiVersion]\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"identity.type\"},{\"equals\":\"None\",\"field\":\"identity.type\"}]}]},\"then\":{\"details\":{\"operations\":[{\"field\":\"identity.type\",\"operation\":\"addOrReplace\",\"value\":\"SystemAssigned\"}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"]},\"effect\":\"modify\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3d5ed4c2-5e50-4c76-932b-8982691b68ae",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Advanced Threat Protection on your Azure database for MySQL flexible servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Advanced Threat Protection to be enabled on Azure database for MySQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3d5ed4c2-5e50-4c76-932b-8982691b68ae",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "3d5ed4c2-5e50-4c76-932b-8982691b68ae",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/flexibleservers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2023-12-01-preview\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.DBforMySQL/flexibleservers/advancedThreatProtectionSettings\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioningSuccess\",\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.DBforMySQL/flexibleservers/advancedThreatProtectionSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3d9f5e4c-9947-4579-9539-2a7695fbc187",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can limit exposure of your resources by creating private endpoints instead. Learn more at: https://aka.ms/appconfig/private-endpoint.",
            "display_name": "App Configuration should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3d9f5e4c-9947-4579-9539-2a7695fbc187",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Configuration\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "3d9f5e4c-9947-4579-9539-2a7695fbc187",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.AppConfiguration/configurationStores\",\"field\":\"type\"},{\"field\":\"Microsoft.AppConfiguration/configurationStores/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3dc5edcd-002d-444c-b216-e123bbfa37c0",
          "schema_version": 0,
          "attributes": {
            "description": "Although a virtual machine's OS and data disks are encrypted-at-rest by default using platform managed keys; resource disks (temp disks), data caches, and data flowing between Compute and Storage resources are not encrypted. Use Azure Disk Encryption or EncryptionAtHost to remediate. Visit https://aka.ms/diskencryptioncomparison to compare encryption offerings. This policy requires two prerequisites to be deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows virtual machines should enable Azure Disk Encryption or EncryptionAtHost.",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3dc5edcd-002d-444c-b216-e123bbfa37c0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureWindowsVMEncryptionCompliance\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "3dc5edcd-002d-444c-b216-e123bbfa37c0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.securityType\",\"notEquals\":\"ConfidentialVM\"},{\"field\":\"Microsoft.Compute/virtualMachines/additionalCapabilities.ultraSSDEnabled\",\"notEquals\":\"true\"},{\"field\":\"Microsoft.Compute/virtualMachines/sku.name\",\"notIn\":[\"standard_a0\",\"standard_a1\",\"basic_a0\",\"basic_a1\",\"basic_a2\",\"basic_a3\",\"basic_a4\"]},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"microsoft-aks\",\"AzureDatabricks\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"aks*\"}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureWindowsVMEncryptionCompliance\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Secure transfer to storage accounts should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "404c3081-a854-4457-ae30-26a93ef643f9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-04-01\",\"value\":\"[requestContext().apiVersion]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"}]},{\"equals\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
          "schema_version": 0,
          "attributes": {
            "description": "Disable public network access for your key vault so that it's not accessible over the public internet. This can reduce data leakage risks. Learn more at: https://aka.ms/akvprivatelink.",
            "display_name": "Azure Key Vault should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "405c5871-3e91-4644-8a63-58e19d68ff5b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"not\":{\"equals\":\"recover\",\"field\":\"Microsoft.KeyVault/vaults/createMode\"}},{\"anyOf\":[{\"less\":\"2021-06-01-preview\",\"value\":\"[requestContext().apiVersion]\"},{\"allOf\":[{\"greaterOrEquals\":\"2021-06-01-preview\",\"value\":\"[requestContext().apiVersion]\"},{\"field\":\"Microsoft.KeyVault/vaults/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/40e85574-ef33-47e8-a854-7a65c7500560",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling local authentication methods and allowing only Microsoft Entra Authentication improves security by ensuring that Azure MySQL flexible server can exclusively be accessed by Microsoft Entra identities.",
            "display_name": "Azure MySQL flexible server should have Microsoft Entra Only Authentication enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/40e85574-ef33-47e8-a854-7a65c7500560",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "40e85574-ef33-47e8-a854-7a65c7500560",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBForMySql/flexibleServers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"ON\",\"field\":\"Microsoft.DBForMySql/flexibleServers/configurations/value\"},\"name\":\"aad_auth_only\",\"type\":\"Microsoft.DBForMySql/flexibleServers/configurations\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/423dd1ba-798e-40e4-9c4d-b6902674b423",
          "schema_version": 0,
          "attributes": {
            "description": "Disable automounting API credentials to prevent a potentially compromised Pod resource to run API commands against Kubernetes clusters. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should disable automounting API credentials",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/423dd1ba-798e-40e4-9c4d-b6902674b423",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"4.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "423dd1ba-798e-40e4-9c4d-b6902674b423",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/block-automount-token/v2/template.yaml\"},\"values\":{\"excludedImages\":\"[parameters('excludedImages')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Batch accounts should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "428256e6-1fac-4f48-a757-df34c2b3336d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Monitor private link scope. Learn more at: https://docs.microsoft.com/azure/azure-monitor/logs/private-link-security#connect-to-a-private-endpoint.",
            "display_name": "Configure Azure Monitor Private Link Scope to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "437914ee-c176-4fff-8986-7e05eb971365",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId1\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone to your Azure Monitor Private Link scope.\",\"displayName\":\"Private DNS Zone for global endpoints used by Azure Monitor\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId2\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone to your Azure Monitor Private Link scope.\",\"displayName\":\"Private DNS Zone for workspace-specific mapping to OMS agents endpoints\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId3\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone to your Azure Monitor Private Link scope.\",\"displayName\":\"Private DNS Zone for workspace-specific mapping to ingestion endpoints\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId4\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone for workspace-specific mapping to the agent service automation endpoints\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateDnsZoneId5\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"One of the five private DNS zone IDs required for Microsoft.Insights/privateLinkScopes to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone for connectivity to the global agent's solution packs storage account\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Insights/privateLinkScopes\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"azuremonitor\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId1\":{\"value\":\"[parameters('privateDnsZoneId1')]\"},\"privateDnsZoneId2\":{\"value\":\"[parameters('privateDnsZoneId2')]\"},\"privateDnsZoneId3\":{\"value\":\"[parameters('privateDnsZoneId3')]\"},\"privateDnsZoneId4\":{\"value\":\"[parameters('privateDnsZoneId4')]\"},\"privateDnsZoneId5\":{\"value\":\"[parameters('privateDnsZoneId5')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId1\":{\"type\":\"string\"},\"privateDnsZoneId2\":{\"type\":\"string\"},\"privateDnsZoneId3\":{\"type\":\"string\"},\"privateDnsZoneId4\":{\"type\":\"string\"},\"privateDnsZoneId5\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone1\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId1')]\"}},{\"name\":\"privateDnsZone2\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId2')]\"}},{\"name\":\"privateDnsZone3\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId3')]\"}},{\"name\":\"privateDnsZone4\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId4')]\"}},{\"name\":\"privateDnsZone5\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId5')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that the Machine Learning Workspaces aren't exposed on the public internet. You can control exposure of your workspaces by creating private endpoints instead. Learn more at: https://learn.microsoft.com/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2\u0026tabs=azure-portal.",
            "display_name": "Azure Machine Learning Workspaces should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"2.0.1\"}",
            "mode": "Indexed",
            "name": "438c38d2-3772-465a-a9cc-7a6666a275ce",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure HDInsight clusters. Learn more at: https://aka.ms/hdi.pl.",
            "display_name": "Configure Azure HDInsight clusters to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
            "management_group_name": null,
            "metadata": "{\"category\":\"HDInsight\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"groupId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Target group id (sub resource type) for the private endpoint.\",\"displayName\":\"Group ID\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Azure HDInsight clusters to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for Azure HDInsight clusters\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.HDInsight/clusters\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('groupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"hdinsightCluster-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for open-source relational databases detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. Learn more about the capabilities of Azure Defender for open-source relational databases at https://aka.ms/AzDforOpenSourceDBsDocu. Important: Enabling this plan will result in charges for protecting your open-source relational databases. Learn about the pricing on Security Center's pricing page: https://aka.ms/pricing-security-center",
            "display_name": "Configure Azure Defender for open-source relational databases to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "44433aa3-7ec2-4002-93ea-65c65ff0310a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"OpenSourceRelationalDatabases\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"OpenSourceRelationalDatabases\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/45e05259-1eb5-4f70-9574-baf73e9d219b",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Machine Learning workspaces, data leakage risks are reduced. Learn more about private links at: https://docs.microsoft.com/azure/machine-learning/how-to-configure-private-link.",
            "display_name": "Azure Machine Learning workspaces should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/45e05259-1eb5-4f70-9574-baf73e9d219b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "45e05259-1eb5-4f70-9574-baf73e9d219b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that the Azure Cache for Redis isn't exposed on the public internet. You can limit exposure of your Azure Cache for Redis by creating private endpoints instead. Learn more at: https://docs.microsoft.com/azure/azure-cache-for-redis/cache-private-link.",
            "display_name": "Azure Cache for Redis should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cache\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "470baccb-7e51-4549-8b1a-3e5be069f663",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/Redis\",\"field\":\"type\"},{\"field\":\"Microsoft.Cache/Redis/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
          "schema_version": 0,
          "attributes": {
            "description": "Block pod containers from sharing the host process ID namespace and host IPC namespace in a Kubernetes cluster. This recommendation is part of CIS 5.2.2 and CIS 5.2.3 which are intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster containers should not share host process ID or host IPC namespace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"5.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/block-host-namespace/v2/template.yaml\"},\"values\":{\"excludedImages\":\"[parameters('excludedImages')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/48af4db5-9b8b-401c-8e74-076be876a430",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for PostgreSQL allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.",
            "display_name": "Geo-redundant backup should be enabled for Azure Database for PostgreSQL",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/48af4db5-9b8b-401c-8e74-076be876a430",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "48af4db5-9b8b-401c-8e74-076be876a430",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/storageProfile.geoRedundantBackup\",\"notEquals\":\"Enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4b90e17e-8448-49db-875e-bd83fb6f804f",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your Event Grid topic instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/privateendpoints.",
            "display_name": "Azure Event Grid topics should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4b90e17e-8448-49db-875e-bd83fb6f804f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "4b90e17e-8448-49db-875e-bd83fb6f804f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.EventGrid/topics\",\"field\":\"type\"},{\"field\":\"kind\",\"notEquals\":\"AzureArc\"},{\"count\":{\"field\":\"Microsoft.EventGrid/topics/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.EventGrid/topics/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
          "schema_version": 0,
          "attributes": {
            "description": "Enable FTPS enforcement for enhanced security.",
            "display_name": "App Service apps should require FTPS only",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Web/sites/config/ftpsState\",\"in\":[\"FtpsOnly\",\"Disabled\"]},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machines if the VM Image (OS) is in the list defined and the agent is not installed.",
            "display_name": "Deploy Dependency agent for Linux virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"5.1.0\"}",
            "mode": "Indexed",
            "name": "4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-sp4-gen2\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for servers provides real-time threat protection for server workloads and generates hardening recommendations as well as alerts about suspicious activities.",
            "display_name": "Azure Defender for servers should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.3\"}",
            "mode": "All",
            "name": "4da35fc9-c9e7-4960-aec9-797fe7d9051d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"VirtualMachines\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4eb909e7-6d64-656d-6465-2eeb297a1625",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys Microsoft Defender for Endpoint agent on Linux hybrid machines",
            "display_name": "[Preview]: Deploy Microsoft Defender for Endpoint agent on Linux hybrid machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4eb909e7-6d64-656d-6465-2eeb297a1625",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"2.0.1-preview\"}",
            "mode": "Indexed",
            "name": "4eb909e7-6d64-656d-6465-2eeb297a1625",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/machines/osName\",\"like\":\"linux*\"},{\"field\":\"Microsoft.HybridCompute/machines/osSku\",\"notContains\":\"openshift\"},{\"field\":\"tags['MDFCSecurityConnector']\",\"notEquals\":\"true\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"azureResourceId\":{\"value\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.HybridCompute/machines/',field('name'))]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"azureResourceId\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/MDE.Linux')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"defenderForEndpointOnboardingScript\":\"[reference(subscriptionResourceId('Microsoft.Security/mdeOnboardings', 'Linux'), '2021-10-01-preview', 'full').properties.onboardingPackageLinux]\"},\"publisher\":\"Microsoft.Azure.AzureDefenderForServers\",\"settings\":{\"azureResourceId\":\"[parameters('azureResourceId')]\",\"installedBy\":\"Policy\"},\"type\":\"MDE.Linux\",\"typeHandlerVersion\":\"1.0\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.AzureDefenderForServers\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"MDE.Linux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"name\":\"MDE.Linux\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
          "schema_version": 0,
          "attributes": {
            "description": "Private DNS records allow private connections to private endpoints. Private endpoint connections allow secure communication by enabling private connectivity to Batch accounts without a need for public IP addresses at the source or destination. For more information on private endpoints and DNS zones in Batch, see https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints that connect to Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private DNS Zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"batchAccount\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"batchAccount-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c",
          "schema_version": 0,
          "attributes": {
            "description": "It is recommended to designate up to 3 subscription owners in order to reduce the potential for breach by a compromised owner.",
            "display_name": "A maximum of 3 owners should be designated for your subscription",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "4f11b553-d42e-4e3a-89be-32ca364cad4c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"6f90a6d6-d4d6-0794-0ec1-98fa77878c2e\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure the relevant people in your organization are notified when there is a potential security breach in one of your subscriptions, set a security contact to receive email notifications from Security Center.",
            "display_name": "Subscriptions should have a contact email address for security issues",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/securityContacts/email\",\"notEquals\":\"\"},\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
          "schema_version": 0,
          "attributes": {
            "description": "Anonymous public read access to containers and blobs in Azure Storage is a convenient way to share data but might present security risks. To prevent data breaches caused by undesired anonymous access, Microsoft recommends preventing public access to a storage account unless your scenario requires it.",
            "display_name": "Storage account public access should be disallowed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"3.1.1\"}",
            "mode": "Indexed",
            "name": "4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"not\":{\"allOf\":[{\"contains\":\"/resourceGroups/aro-\",\"field\":\"id\"},{\"anyOf\":[{\"field\":\"name\",\"like\":\"cluster*\"},{\"field\":\"name\",\"like\":\"imageregistry*\"}]}]}},{\"not\":{\"equals\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/allowBlobPublicAccess\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
          "schema_version": 0,
          "attributes": {
            "description": "Audits virtual machines to detect whether they are running a supported vulnerability assessment solution. A core component of every cyber risk and security program is the identification and analysis of vulnerabilities. Azure Security Center's standard pricing tier includes vulnerability scanning for your virtual machines at no extra cost. Additionally, Security Center can automatically deploy this tool for you.",
            "display_name": "A vulnerability assessment solution should be enabled on your virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "501541f7-f7e7-4cd6-868c-4190fdad3ac9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"ffff0522-1e88-47fc-8382-2a80ba848f5d\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Configure Azure Defender for SQL servers on machines to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "50ea7265-7d8c-429e-9a7d-ca1f410191c3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"SqlServerVirtualMachines\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServerVirtualMachines\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/511f5417-5d12-434d-ab2e-816901e72a5e",
          "schema_version": 0,
          "attributes": {
            "description": "Containers should only use allowed AppArmor profiles in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster containers should only use allowed AppArmor profiles",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/511f5417-5d12-434d-ab2e-816901e72a5e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"6.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "511f5417-5d12-434d-ab2e-816901e72a5e",
            "parameters": "{\"allowedProfiles\":{\"type\":\"Array\",\"defaultValue\":[\"runtime/default\"],\"metadata\":{\"description\":\"The list of AppArmor profiles that containers are allowed to use. E.g. [ \\\"runtime/default\\\", \\\"docker/default\\\" ]. Provide empty list as input to block everything.\",\"displayName\":\"Allowed AppArmor profiles\",\"portalReview\":true}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/enforce-apparmor-profile/v3/template.yaml\"},\"values\":{\"allowedProfiles\":\"[parameters('allowedProfiles')]\",\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/51c1490f-3319-459c-bbbc-7f391bbed753",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public IP of clusters in Azure Databricks Workspaces improves security by ensuring that the clusters aren't exposed on the public internet. Learn more at: https://learn.microsoft.com/azure/databricks/security/secure-cluster-connectivity.",
            "display_name": "Azure Databricks Clusters should disable public IP",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/51c1490f-3319-459c-bbbc-7f391bbed753",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Databricks\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "51c1490f-3319-459c-bbbc-7f391bbed753",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value\",\"notEquals\":\"true\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling local authentication methods improves security by ensuring that Cosmos DB database accounts exclusively require Azure Active Directory identities for authentication. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-setup-rbac#disable-local-auth.",
            "display_name": "Cosmos DB database accounts should have local authentication methods disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.DocumentDB/databaseAccounts/disableLocalAuth\",\"notEquals\":true},{\"field\":\"Microsoft.DocumentDB/databaseAccounts/capabilities[*].name\",\"notin\":[\"EnableMongo\",\"EnableCassandra\",\"EnableTable\",\"EnableGremlin\"]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67",
          "schema_version": 0,
          "attributes": {
            "description": "To prevent service secrets from being shared with read-only users, the minimum API version should be set to 2019-12-01 or higher.",
            "display_name": "API Management minimum API version should be set to 2019-12-01 or higher",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "549814b6-3212-4203-bdc8-1548d342fb67",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},{\"field\":\"Microsoft.ApiManagement/service/apiVersionConstraint.minApiVersion\",\"notMatch\":\"2019-12-01\"},{\"field\":\"Microsoft.ApiManagement/service/apiVersionConstraint.minApiVersion\",\"notMatch\":\"202#-##-##-preview\"},{\"field\":\"Microsoft.ApiManagement/service/apiVersionConstraint.minApiVersion\",\"notMatch\":\"202#-##-##\"},{\"field\":\"Microsoft.ApiManagement/service/sku.name\",\"notEquals\":\"Consumption\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the key vault firewall so that the key vault is not accessible by default to any public IPs or disable public network access for your key vault so that it's not accessible over the public internet. Optionally, you can configure specific IP ranges to limit access to those networks. Learn more at: https://docs.microsoft.com/azure/key-vault/general/network-security and https://aka.ms/akvprivatelink",
            "display_name": "Azure Key Vault should have firewall enabled or public network access disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"3.3.0\"}",
            "mode": "Indexed",
            "name": "55615ac9-af46-4a59-874e-391cc3dfb490",
            "parameters": "{\"allowedIPAddresses\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array with allowed public IP addresses. An empty array is evaluated as to allow all IPs.\",\"displayName\":\"Allowed IP addresses\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"forbiddenIPAddresses\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array with forbidden public IP addresses. An empty array is evaluated as there are no forbidden IP addresses.\",\"displayName\":\"Forbidden IP addresses\"}},\"restrictIPAddresses\":{\"type\":\"String\",\"allowedValues\":[\"Yes\",\"No\"],\"defaultValue\":\"No\",\"metadata\":{\"description\":\"Select (Yes) to allow or forbid a list of IP addresses. If (No), the list of IP addresses won't have any effect in the policy enforcement\",\"displayName\":\"Would you like to restrict specific IP addresses?\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/createMode\",\"notEquals\":\"recover\"},{\"anyOf\":[{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.defaultAction\",\"notEquals\":\"Deny\"},{\"allOf\":[{\"equals\":\"Yes\",\"value\":\"[parameters('restrictIPAddresses')]\"},{\"anyOf\":[{\"allOf\":[{\"count\":{\"name\":\"allowedIPAddresses\",\"value\":\"[parameters('allowedIPAddresses')]\"},\"notEquals\":0},{\"not\":{\"count\":{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.ipRules[*]\",\"where\":{\"count\":{\"name\":\"allowedIpAddress\",\"value\":\"[parameters('allowedIPAddresses')]\",\"where\":{\"equals\":true,\"value\":\"[ipRangeContains(current('allowedIpAddress'), current('Microsoft.KeyVault/vaults/networkAcls.ipRules[*].value'))]\"}},\"greater\":0}},\"equals\":\"[length(field('Microsoft.KeyVault/vaults/networkAcls.ipRules[*]'))]\"}}]},{\"allOf\":[{\"count\":{\"name\":\"forbiddenIPAddresses\",\"value\":\"[parameters('forbiddenIPAddresses')]\"},\"notEquals\":0},{\"not\":{\"count\":{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.ipRules[*]\",\"where\":{\"count\":{\"name\":\"forbiddenIPAddresses\",\"value\":\"[parameters('forbiddenIPAddresses')]\",\"where\":{\"equals\":true,\"value\":\"[ipRangeContains(current('forbiddenIPAddresses'), current('Microsoft.KeyVault/vaults/networkAcls.ipRules[*].value'))]\"}},\"greater\":0}},\"equals\":0}}]}]}]}]},{\"anyOf\":[{\"less\":\"2021-06-01-preview\",\"value\":\"[requestContext().apiVersion]\"},{\"allOf\":[{\"greaterOrEquals\":\"2021-06-01-preview\",\"value\":\"[requestContext().apiVersion]\"},{\"field\":\"Microsoft.KeyVault/vaults/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.",
            "display_name": "Web Application Firewall (WAF) should be enabled for Application Gateway",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/applicationGateways/webApplicationFirewallConfiguration\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/applicationGateways/firewallPolicy\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
          "schema_version": 0,
          "attributes": {
            "description": "Cross-Origin Resource Sharing (CORS) should not allow all domains to access your app. Allow only required domains to interact with your app.",
            "display_name": "App Service apps should not have CORS configured to allow every resource to access your apps",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\",\"notEquals\":\"*\"},\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5752e6d6-1206-46d8-8ab1-ecc2f71a8112",
          "schema_version": 0,
          "attributes": {
            "description": "To protect the privacy of information communicated over the Internet, your machines should use the latest version of the industry-standard cryptographic protocol, Transport Layer Security (TLS). TLS secures communications over a network by encrypting a connection between machines.",
            "display_name": "Windows machines should be configured to use secure communication protocols",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5752e6d6-1206-46d8-8ab1-ecc2f71a8112",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"MinimumTLSVersion\":\"[SecureWebServer]s1;MinimumTLSVersion\"},\"name\":\"AuditSecureProtocol\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"4.1.1\"}",
            "mode": "Indexed",
            "name": "5752e6d6-1206-46d8-8ab1-ecc2f71a8112",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"MinimumTLSVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.1\",\"1.2\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"The minimum TLS protocol version that should be enabled. Windows machines with lower TLS versions will be marked as non-compliant.\",\"displayName\":\"Minimum TLS version\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('[SecureWebServer]s1;MinimumTLSVersion', '=', parameters('MinimumTLSVersion')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AuditSecureProtocol\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/58440f8a-10c5-4151-bdce-dfbaad4a20b7",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your CosmosDB account, data leakage risks are reduced. Learn more about private links at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints.",
            "display_name": "CosmosDB accounts should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/58440f8a-10c5-4151-bdce-dfbaad4a20b7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "58440f8a-10c5-4151-bdce-dfbaad4a20b7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.DocumentDB/databaseAccounts/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Storage accounts to stream resource logs to a Log Analytics workspace when any storage accounts which is missing this diagnostic settings is created or updated.",
            "display_name": "Configure diagnostic settings for Storage Accounts to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.0\"}",
            "mode": "Indexed",
            "name": "59759c62-9a22-4cdf-ae64-074495983fef",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from the dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"storageAccountsDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/acr/CMK.",
            "display_name": "Container registries should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.1.2\"}",
            "mode": "Indexed",
            "name": "5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/encryption.status\",\"notEquals\":\"enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "Log Analytics extension should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "mode": "Indexed",
            "name": "5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for PostgreSQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP based firewall rules.",
            "display_name": "Public network access should be disabled for PostgreSQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"3.1.0\"}",
            "mode": "Indexed",
            "name": "5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleServers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.privateDnsZoneArmResourceId\"},{\"allOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.publicNetworkAccess\"},{\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.privateDnsZoneArmResourceId\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5e6bf724-0154-49bc-985f-27b2e07e636b",
          "schema_version": 0,
          "attributes": {
            "description": "Ensure that all Azure Stack HCI servers meet the Secured-core requirements. To enable the Secured-core server requirements: 1. From the Azure Stack HCI clusters page, go to Windows Admin Center and select Connect. 2. Go to the Security extension and select Secured-core. 3. Select any setting that is not enabled and click Enable.",
            "display_name": "[Preview]: Azure Stack HCI servers should meet Secured-core requirements",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5e6bf724-0154-49bc-985f-27b2e07e636b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stack HCI\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "mode": "Indexed",
            "name": "5e6bf724-0154-49bc-985f-27b2e07e636b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"AuditIfNotExists\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.AzureStackHCI/clusters\",\"field\":\"type\"},{\"field\":\"Microsoft.AzureStackHCI/clusters/reportedProperties.clusterVersion\",\"greater\":\"10.0.20350\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"field\":\"Microsoft.AzureStackHCI/clusters/securitySettings/securityComplianceStatus.securedCoreCompliance\",\"in\":[\"Compliant\",\"Pending\"]}]},\"type\":\"Microsoft.AzureStackHCI/clusters/securitySettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5e8168db-69e3-4beb-9822-57cb59202a9d",
          "schema_version": 0,
          "attributes": {
            "description": "Bots should be set to 'isolated only' mode. This setting configures Bot Service channels that require traffic over the public internet to be disabled.",
            "display_name": "Bot Service should have public network access disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5e8168db-69e3-4beb-9822-57cb59202a9d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Bot Service\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "5e8168db-69e3-4beb-9822-57cb59202a9d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.BotService/botServices\",\"field\":\"type\"},{\"field\":\"Microsoft.BotService/botServices/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the extension is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. Deprecation notice: The Log Analytics agent will not be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux virtual machine scale sets. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146",
          "schema_version": 0,
          "attributes": {
            "description": "If a key is too close to expiration, an organizational delay to rotate the key may result in an outage. Keys should be rotated at a specified number of days prior to expiration to provide sufficient time to react to a failure.",
            "display_name": "Keys should have more than the specified number of days before expiration",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.0.1\"}",
            "mode": "Microsoft.KeyVault.Data",
            "name": "5ff38825-c5d8-47c5-b70e-069a21955146",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\"}},\"minimumDaysBeforeExpiration\":{\"type\":\"Integer\",\"metadata\":{\"description\":\"Specify the minimum number of days that a key should remain usable prior to expiration.\",\"displayName\":\"The minimum days before expiration\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault.Data/vaults/keys\",\"field\":\"type\"},{\"exists\":true,\"field\":\"Microsoft.KeyVault.Data/vaults/keys/attributes.expiresOn\"},{\"field\":\"Microsoft.KeyVault.Data/vaults/keys/attributes.expiresOn\",\"less\":\"[addDays(utcNow(), parameters('minimumDaysBeforeExpiration'))]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68",
          "schema_version": 0,
          "attributes": {
            "description": "Service Fabric provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node communication using a primary cluster certificate. Set the protection level to ensure that all node-to-node messages are encrypted and digitally signed",
            "display_name": "Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68",
            "management_group_name": null,
            "metadata": "{\"category\":\"Service Fabric\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "617c02be-7f02-4efd-8836-3180d47b6c68",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ServiceFabric/clusters\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.ServiceFabric/clusters/fabricSettings[*].name\",\"notEquals\":\"Security\"},{\"field\":\"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name\",\"notEquals\":\"ClusterProtectionLevel\"},{\"field\":\"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value\",\"notEquals\":\"EncryptAndSign\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/630c64f9-8b6b-4c64-b511-6544ceff6fd6",
          "schema_version": 0,
          "attributes": {
            "description": "Although SSH itself provides an encrypted connection, using passwords with SSH still leaves the VM vulnerable to brute-force attacks. The most secure option for authenticating to an Azure Linux virtual machine over SSH is with a public-private key pair, also known as SSH keys. Learn more: https://docs.microsoft.com/azure/virtual-machines/linux/create-ssh-keys-detailed.",
            "display_name": "Authentication to Linux machines should require SSH keys",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/630c64f9-8b6b-4c64-b511-6544ceff6fd6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"LinuxNoPasswordForSSH\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.2.0\"}",
            "mode": "Indexed",
            "name": "630c64f9-8b6b-4c64-b511-6544ceff6fd6",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-win*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"linux*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"LinuxNoPasswordForSSH\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/640d2586-54d2-465f-877f-9ffc1d2109f4",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Storage detects potential threats to your storage accounts. It helps prevent the three major impacts on your data and workload: malicious file uploads, sensitive data exfiltration, and data corruption. The new Defender for Storage plan includes Malware Scanning and Sensitive Data Threat Detection. This plan also provides a predictable pricing structure (per storage account) for control over coverage and costs.",
            "display_name": "Microsoft Defender for Storage should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/640d2586-54d2-465f-877f-9ffc1d2109f4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "640d2586-54d2-465f-877f-9ffc1d2109f4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},{\"equals\":\"DefenderForStorageV2\",\"field\":\"Microsoft.Security/pricings/subPlan\"},{\"count\":{\"field\":\"Microsoft.Security/pricings/extensions[*]\",\"where\":{\"allOf\":[{\"field\":\"Microsoft.Security/pricings/extensions[*].name\",\"in\":[\"OnUploadMalwareScanning\",\"SensitiveDataDiscovery\"]},{\"equals\":\"true\",\"field\":\"Microsoft.Security/pricings/extensions[*].isEnabled\"}]}},\"equals\":2}]},\"existenceScope\":\"subscription\",\"name\":\"StorageAccounts\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Containers provides cloud-native Kubernetes security capabilities including environment hardening, workload protection, and run-time protection. When you enable the SecurityProfile.Defender on your Azure Kubernetes Service cluster, an agent is deployed to your cluster to collect security event data. Learn more about Microsoft Defender for Containers: https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks.",
            "display_name": "Configure Azure Kubernetes Service clusters to enable Defender profile",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"4.3.0\"}",
            "mode": "Indexed",
            "name": "64def556-fbad-4622-930e-72d1d5589bf5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalyticsWorkspaceResourceId\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Optional Log Analytics workspace resource id. If provided, will be used as part of the feature configuration. Otherwise, default workspace will be provisioned. Value format should be '/subscriptions/XXX/resourcegroups/XXX/providers/Microsoft.OperationalInsights/workspaces/XXX'.\",\"displayName\":\"LogAnalyticsWorkspaceResourceId\",\"strongType\":\"Microsoft.OperationalInsights/workspaces\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"clusterName\":{\"value\":\"[field('name')]\"},\"clusterRegion\":{\"value\":\"[field('location')]\"},\"clusterResourceId\":{\"value\":\"[field('id')]\"},\"logAnalyticsWorkspaceResourceId\":{\"value\":\"[parameters('logAnalyticsWorkspaceResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"clusterName\":{\"type\":\"string\"},\"clusterRegion\":{\"type\":\"string\"},\"clusterResourceId\":{\"type\":\"string\"},\"logAnalyticsWorkspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-05-01\",\"condition\":\"[variables('shouldProvisionDefaultWorkspace')]\",\"location\":\"[parameters('clusterRegion')]\",\"name\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2020-06-01\",\"condition\":\"[variables('shouldProvisionDefaultWorkspace')]\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', variables('defaultRGName'))]\"],\"name\":\"[variables('deployDefaultAscResourceGroup')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"clusterRegion\":{\"value\":\"[parameters('clusterRegion')]\"},\"workspaceName\":{\"value\":\"[variables('workspaceName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"clusterRegion\":{\"type\":\"string\"},\"workspaceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-06-01\",\"location\":\"[parameters('clusterRegion')]\",\"name\":\"[parameters('workspaceName')]\",\"properties\":{\"features\":{\"searchVersion\":1},\"retentionInDays\":30,\"sku\":{\"name\":\"pernode\"}},\"type\":\"Microsoft.OperationalInsights/workspaces\"}],\"variables\":{}}},\"resourceGroup\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-10-01\",\"dependsOn\":[\"[variables('deployDefaultAscResourceGroup')]\"],\"name\":\"[concat('securityprofile-deploy-', uniqueString(parameters('clusterResourceId')))]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"aksClusterContent\":{\"value\":\"[reference(parameters('clusterResourceId'), '2022-06-01', 'Full')]\"},\"clusterName\":{\"value\":\"[parameters('clusterName')]\"},\"clusterRegion\":{\"value\":\"[parameters('clusterRegion')]\"},\"workspaceResourceId\":{\"value\":\"[if(variables('shouldProvisionDefaultWorkspace'), concat('/subscriptions/', variables('subscriptionId'), '/resourcegroups/', variables('defaultRGName'), '/providers/Microsoft.OperationalInsights/workspaces/', variables('workspaceName')), parameters('logAnalyticsWorkspaceResourceId'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"aksClusterContent\":{\"type\":\"object\"},\"clusterName\":{\"type\":\"string\"},\"clusterRegion\":{\"type\":\"string\"},\"workspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2022-06-01\",\"location\":\"[parameters('clusterRegion')]\",\"name\":\"[parameters('clusterName')]\",\"properties\":{\"aadProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'aadProfile'), parameters('aksClusterContent').properties.aadProfile, json('null'))]\",\"apiServerAccessProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'apiServerAccessProfile'), parameters('aksClusterContent').properties.apiServerAccessProfile, json('null'))]\",\"autoScalerProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'autoScalerProfile'), parameters('aksClusterContent').properties.autoScalerProfile, json('null'))]\",\"diskEncryptionSetID\":\"[if(contains(parameters('aksClusterContent').properties, 'diskEncryptionSetID'), parameters('aksClusterContent').properties.diskEncryptionSetID, json('null'))]\",\"enablePodSecurityPolicy\":\"[if(contains(parameters('aksClusterContent').properties, 'enablePodSecurityPolicy'), parameters('aksClusterContent').properties.enablePodSecurityPolicy, json('null'))]\",\"enableRBAC\":\"[if(contains(parameters('aksClusterContent').properties, 'enableRBAC'), parameters('aksClusterContent').properties.enableRBAC, json('null'))]\",\"identityProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'identityProfile'), parameters('aksClusterContent').properties.identityProfile, json('null'))]\",\"networkProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'networkProfile'), parameters('aksClusterContent').properties.networkProfile, json('null'))]\",\"nodeResourceGroup\":\"[parameters('aksClusterContent').properties.nodeResourceGroup]\",\"securityProfile\":{\"defender\":{\"logAnalyticsWorkspaceResourceId\":\"[parameters('workspaceResourceId')]\",\"securityMonitoring\":{\"enabled\":true}}}},\"type\":\"Microsoft.ContainerService/ManagedClusters\"}]}},\"resourceGroup\":\"[split(parameters('clusterResourceId'),'/')[4]]\",\"subscriptionId\":\"[variables('subscriptionId')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"defaultRGName\":\"[concat('DefaultResourceGroup-', variables('locationCode'))]\",\"deployDefaultAscResourceGroup\":\"[concat('deployDefaultAscResourceGroup-', uniqueString(deployment().name))]\",\"locationCode\":\"[variables('locationLongNameToShortMap')[parameters('clusterRegion')]]\",\"locationLongNameToShortMap\":{\"australiacentral\":\"CAU\",\"australiacentral2\":\"CBR2\",\"australiaeast\":\"EAU\",\"australiasoutheast\":\"SEAU\",\"brazilsouth\":\"CQ\",\"brazilsoutheast\":\"BRSE\",\"canadacentral\":\"CCA\",\"canadaeast\":\"YQ\",\"centralindia\":\"CIN\",\"centralus\":\"CUS\",\"chinaeast2\":\"E2\",\"chinaeast3\":\"NE3\",\"chinanorth3\":\"NN3\",\"eastasia\":\"EA\",\"eastus\":\"EUS\",\"eastus2\":\"EUS2\",\"eastus2euap\":\"eus2p\",\"francecentral\":\"PAR\",\"francesouth\":\"MRS\",\"germanynorth\":\"DEN\",\"germanywestcentral\":\"DEWC\",\"israelcentral\":\"ILC\",\"italynorth\":\"ITN\",\"japaneast\":\"EJP\",\"japanwest\":\"OS\",\"jioindiacentral\":\"JINC\",\"jioindiawest\":\"JINW\",\"koreacentral\":\"SE\",\"koreasouth\":\"PS\",\"mexicocentral\":\"MXC\",\"northcentralus\":\"NCUS\",\"northeurope\":\"NEU\",\"norwayeast\":\"NOE\",\"norwaywest\":\"NOW\",\"polandcentral\":\"PLC\",\"qatarcentral\":\"QLC\",\"southafricanorth\":\"JNB\",\"southafricawest\":\"CPT\",\"southcentralus\":\"SCUS\",\"southeastasia\":\"SEA\",\"southindia\":\"MA\",\"spaincentral\":\"ESC\",\"swedencentral\":\"SEC\",\"switzerlandnorth\":\"CHN\",\"switzerlandwest\":\"CHW\",\"uaecentral\":\"AUH\",\"uaenorth\":\"DXB\",\"uksouth\":\"SUK\",\"ukwest\":\"WUK\",\"usgovarizona\":\"USGA\",\"usgovvirginia\":\"USGV\",\"westcentralus\":\"WCUS\",\"westeurope\":\"WEU\",\"westus\":\"WUS\",\"westus2\":\"WUS2\",\"westus3\":\"USW3\"},\"shouldProvisionDefaultWorkspace\":\"[empty(parameters('logAnalyticsWorkspaceResourceId'))]\",\"subscriptionId\":\"[subscription().subscriptionId]\",\"workspaceName\":\"[concat('DefaultWorkspace-', variables('subscriptionId'),'-', variables('locationCode'))]\"}}}},\"deploymentScope\":\"subscription\",\"evaluationDelay\":\"PT30M\",\"existenceCondition\":{\"equals\":\"true\",\"field\":\"Microsoft.ContainerService/managedClusters/securityProfile.defender.securityMonitoring.enabled\"},\"name\":\"[field('name')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/5e93ba01-8f92-4c7a-b12a-801e3df23824\",\"/providers/microsoft.authorization/roleDefinitions/8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5\"],\"type\":\"Microsoft.ContainerService/managedClusters\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/5e93ba01-8f92-4c7a-b12a-801e3df23824",
              "/providers/microsoft.authorization/roleDefinitions/8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Azure Defender for SQL servers on machines should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "6581d072-105e-4418-827f-bd446d56421b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServerVirtualMachines\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
          "schema_version": 0,
          "attributes": {
            "description": "Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management. This is particularly relevant for organizations with related compliance requirements. This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements. If not enabled, the data will be encrypted using platform-managed keys. To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.",
            "display_name": "Azure AI Services resources should encrypt data at rest with a customer-managed key (CMK)",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"2.2.0\"}",
            "mode": "Indexed",
            "name": "67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"excludedKinds\":{\"type\":\"Array\",\"defaultValue\":[\"CognitiveServices\",\"ContentSafety\",\"ImmersiveReader\",\"HealthInsights\",\"LUIS.Authoring\",\"LUIS\",\"QnAMaker\",\"QnAMaker.V2\",\"AIServices\",\"MetricsAdvisor\",\"SpeechTranslation\",\"Internal.AllInOne\",\"ConversationalLanguageUnderstanding\",\"knowledge\",\"TranscriptionIntelligence\",\"HealthDecisionSupport\"],\"metadata\":{\"description\":\"The list of excluded API kinds for customer-managed key, default is the list of API kinds that don't have data stored in Cognitive Services\",\"displayName\":\"Excluded Kinds\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"field\":\"Microsoft.CognitiveServices/accounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"},{\"field\":\"kind\",\"notIn\":\"[parameters('excludedKinds')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/672fe5a1-2fcd-42d7-b85d-902b6e28c6ff",
          "schema_version": 0,
          "attributes": {
            "description": "Install Guest Attestation extension on supported Linux virtual machines to allow Azure Security Center to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Linux virtual machines.",
            "display_name": "[Preview]: Guest Attestation extension should be installed on supported Linux virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/672fe5a1-2fcd-42d7-b85d-902b6e28c6ff",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"6.0.0-preview\"}",
            "mode": "Indexed",
            "name": "672fe5a1-2fcd-42d7-b85d-902b6e28c6ff",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"18_04-lts-gen2\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"20_04-lts-gen2\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-confidential-vm-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"20_04-lts-cvm\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"RHEL\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"83-gen2\"}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"SLES-15-SP2\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"gen2\"}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"CENTOS\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"8_3-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"ol83-lvm-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]},{\"allOf\":[{\"equals\":\"microsoftcblmariner\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cbl-mariner\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"1-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]},{\"allOf\":[{\"equals\":\"debian\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"debian-11\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"11-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]}]},{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.securityType\",\"in\":[\"TrustedLaunch\",\"ConfidentialVM\"]},{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.secureBootEnabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.vTpmEnabled\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.Security.LinuxAttestation\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"GuestAttestation\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\"in\":[\"Succeeded\",\"Provisioning succeeded\"]}]},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/689f7782-ef2c-4270-a6d0-7664869076bd",
          "schema_version": 0,
          "attributes": {
            "description": "Defender Cloud Security Posture Management (CSPM) provides enhanced posture capabilities and a new intelligent cloud security graph to help identify, prioritize, and reduce risk. Defender CSPM is available in addition to the free foundational security posture capabilities turned on by default in Defender for Cloud.",
            "display_name": "Configure Microsoft Defender CSPM to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/689f7782-ef2c-4270-a6d0-7664869076bd",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "689f7782-ef2c-4270-a6d0-7664869076bd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"CloudPosture\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"CloudPosture\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "mode": "Indexed",
            "name": "69af7d4a-7b18-4044-93a9-2651498ef203",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6b2122c1-8120-4ff5-801b-17625a355590",
          "schema_version": 0,
          "attributes": {
            "description": "The Azure Policy extension for Azure Arc provides at-scale enforcements and safeguards on your Arc enabled Kubernetes clusters in a centralized, consistent manner. Learn more at https://aka.ms/akspolicydoc.",
            "display_name": "Azure Arc enabled Kubernetes clusters should have the Azure Policy extension installed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6b2122c1-8120-4ff5-801b-17625a355590",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "6b2122c1-8120-4ff5-801b-17625a355590",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Kubernetes/connectedClusters\",\"field\":\"type\"},{\"field\":\"Microsoft.Kubernetes/connectedClusters/distribution\",\"notEquals\":\"aks\"}]},\"then\":{\"details\":{\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"microsoft.policyinsights\",\"field\":\"Microsoft.KubernetesConfiguration/extensions/extensionType\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.KubernetesConfiguration/extensions/provisioningState\"}]},\"type\":\"Microsoft.KubernetesConfiguration/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6ba6d016-e7c3-4842-b8f2-4992ebc0d72d",
          "schema_version": 0,
          "attributes": {
            "description": "SQL vulnerability assessment scans your database for security vulnerabilities, and exposes any deviations from best practices such as misconfigurations, excessive permissions, and unprotected sensitive data. Resolving the vulnerabilities found can greatly improve your database security posture.",
            "display_name": "SQL servers on machines should have vulnerability findings resolved",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6ba6d016-e7c3-4842-b8f2-4992ebc0d72d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "6ba6d016-e7c3-4842-b8f2-4992ebc0d72d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.HybridCompute/machines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"f97aa83c-9b63-4f9a-99f6-b22c4398f936\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
          "schema_version": 0,
          "attributes": {
            "description": "Restrict which resource types can be deployed in your environment. Limiting resource types can reduce the complexity and attack surface of your environment while also helping to manage costs. Compliance results are only shown for non-compliant resources.",
            "display_name": "Not allowed resource types",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
            "management_group_name": null,
            "metadata": "{\"category\":\"General\",\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfResourceTypesNotAllowed\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of resource types that cannot be deployed.\",\"displayName\":\"Not allowed resource types\",\"strongType\":\"resourceTypes\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":\"[parameters('listOfResourceTypesNotAllowed')]\"},{\"exists\":true,\"value\":\"[field('type')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Kubernetes Service to stream resource logs to a Log Analytics workspace.",
            "display_name": "Deploy - Configure diagnostic settings for Azure Kubernetes Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "parameters": "{\"AllMetrics\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AllMetrics logs to the Log Analytics workspace - True or False\",\"displayName\":\"AllMetrics - Enabled\"}},\"cloud-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cloud-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"cloud-controller-manager - Enabled\"}},\"cluster-autoscaler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cluster-autoscaler logs to the Log Analytics workspace - True or False\",\"displayName\":\"cluster-autoscaler - Enabled\"}},\"csi-azuredisk-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azuredisk-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azuredisk-controller - Enabled\"}},\"csi-azurefile-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azurefile-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azurefile-controller - Enabled\"}},\"csi-snapshot-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-snapshot-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-snapshot-controller - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"AzureKubernetesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"guard\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream guard logs to the Log Analytics workspace - True or False\",\"displayName\":\"guard - Enabled\"}},\"kube-apiserver\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-apiserver logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-apiserver - Enabled\"}},\"kube-audit\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit - Enabled\"}},\"kube-audit-admin\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit-admin logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit-admin - Enabled\"}},\"kube-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-controller-manager - Enabled\"}},\"kube-scheduler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-scheduler logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-scheduler - Enabled\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the Azure Kubernetes Service should be connected to\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AllMetrics\":{\"value\":\"[parameters('AllMetrics')]\"},\"cloud-controller-manager\":{\"value\":\"[parameters('cloud-controller-manager')]\"},\"cluster-autoscaler\":{\"value\":\"[parameters('cluster-autoscaler')]\"},\"csi-azuredisk-controller\":{\"value\":\"[parameters('csi-azuredisk-controller')]\"},\"csi-azurefile-controller\":{\"value\":\"[parameters('csi-azurefile-controller')]\"},\"csi-snapshot-controller\":{\"value\":\"[parameters('csi-snapshot-controller')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"guard\":{\"value\":\"[parameters('guard')]\"},\"kube-apiserver\":{\"value\":\"[parameters('kube-apiserver')]\"},\"kube-audit\":{\"value\":\"[parameters('kube-audit')]\"},\"kube-audit-admin\":{\"value\":\"[parameters('kube-audit-admin')]\"},\"kube-controller-manager\":{\"value\":\"[parameters('kube-controller-manager')]\"},\"kube-scheduler\":{\"value\":\"[parameters('kube-scheduler')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AllMetrics\":{\"type\":\"string\"},\"cloud-controller-manager\":{\"type\":\"string\"},\"cluster-autoscaler\":{\"type\":\"string\"},\"csi-azuredisk-controller\":{\"type\":\"string\"},\"csi-azurefile-controller\":{\"type\":\"string\"},\"csi-snapshot-controller\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"guard\":{\"type\":\"string\"},\"kube-apiserver\":{\"type\":\"string\"},\"kube-audit\":{\"type\":\"string\"},\"kube-audit-admin\":{\"type\":\"string\"},\"kube-controller-manager\":{\"type\":\"string\"},\"kube-scheduler\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('AllMetrics')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerService/managedClusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"count\":{\"name\":\"logCategoriesParameter\",\"value\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"where\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[current('logCategoriesParameter').enabled]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"[current('logCategoriesParameter').category]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greater\":0}},\"equals\":11},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"allOf\":[{\"equals\":\"AllMetrics\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('AllMetrics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}},\"greater\":0},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "Function apps should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. You need private DNS zone properly configured to connect to Azure Automation account via Azure Private Link. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Automation accounts with private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
            "management_group_name": null,
            "metadata": "{\"category\":\"Automation\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateEndpointGroupId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A group Id for the private endpoint\",\"displayName\":\"Private endpoint group id\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"[parameters('privateEndpointGroupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"[parameters('privateEndpointGroupId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointGroupId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"automationAccounts-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a file groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for file groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "6df98d03-368a-4438-8730-a93c4d7693d6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a file groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for file groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"file\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure the relevant people in your organization are notified when there is a potential security breach in one of your subscriptions, enable email notifications for high severity alerts in Security Center.",
            "display_name": "Email notification for high severity alerts should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.2.0\"}",
            "mode": "All",
            "name": "6e2593d9-add6-4083-9c9b-4b7d2188c899",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"anyOf\":[{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications\"},{\"allOf\":[{\"equals\":true,\"field\":\"Microsoft.Security/securityContacts/isEnabled\"},{\"count\":{\"field\":\"Microsoft.Security/securityContacts/notificationsSources[*]\",\"where\":{\"equals\":\"Alert\",\"field\":\"Microsoft.Security/securityContacts/notificationsSources[*].sourceType\"}},\"greater\":0}]}]},\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6ea81a52-5ca7-4575-9669-eaa910b7edf8",
          "schema_version": 0,
          "attributes": {
            "description": "Require Synapse Workspaces to use Microsoft Entra-only authentication. This policy doesn't block workspaces from being created with local authentication enabled. It does block local authentication from being enabled on resources after create. Consider using the 'Microsoft Entra-only authentication' initiative instead to require both. Learn more at: https://aka.ms/Synapse.",
            "display_name": "Synapse Workspaces should have Microsoft Entra-only authentication enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6ea81a52-5ca7-4575-9669-eaa910b7edf8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "6ea81a52-5ca7-4575-9669-eaa910b7edf8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Synapse/workspaces/azureADOnlyAuthentications\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Synapse/workspaces/azureADOnlyAuthentications/azureADOnlyAuthentication\"},{\"equals\":false,\"field\":\"Microsoft.Synapse/workspaces/azureADOnlyAuthentications/azureADOnlyAuthentication\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your storage account, data leakage risks are reduced. Learn more about private links at - https://aka.ms/azureprivatelinkoverview",
            "display_name": "Storage accounts should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "6edd7eda-6dd8-40f7-810d-67160c639cd9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Approved\",\"field\":\"Microsoft.Storage/storageAccounts/privateEndpointConnections/privateLinkServiceConnectionState.status\"},\"type\":\"Microsoft.Storage/storageAccounts/privateEndpointConnections\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
          "schema_version": 0,
          "attributes": {
            "description": "Secure your blob and file storage account with greater flexibility using customer-managed keys. When you specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. Using customer-managed keys provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.",
            "display_name": "Storage accounts should use customer-managed key for encryption",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.3\"}",
            "mode": "Indexed",
            "name": "6fac406b-40ca-413b-bf8e-0bf964659c25",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"not\":{\"equals\":\"Microsoft.Keyvault\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.keySource\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc",
          "schema_version": 0,
          "attributes": {
            "description": "Key access (local authentication) is recommended to be disabled for security. Azure OpenAI Studio, typically used in development/testing, requires key access and will not function if key access is disabled. After disabling, Microsoft Entra ID becomes the only access method, which allows maintaining minimum privilege principle and granular control. Learn more at: https://aka.ms/AI/auth",
            "display_name": "Azure AI Services resources should have key access disabled (disable local authentication)",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Ai Services\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "71ef260a-8f18-47b7-abcb-62d0673d94dc",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"field\":\"Microsoft.CognitiveServices/accounts/disableLocalAuth\",\"notEquals\":true}]},{\"allOf\":[{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},{\"field\":\"Microsoft.Search/searchServices/disableLocalAuth\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine is not configured correctly for one of the recommendations in the Azure compute security baseline.",
            "display_name": "Windows machines should meet requirements of the Azure compute security baseline",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureWindowsBaseline\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureWindowsBaseline\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Storage (Classic) provides detections of unusual and potentially harmful attempts to access or exploit storage accounts.",
            "display_name": "Configure Microsoft Defender for Storage (Classic) to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "74c30959-af11-47b3-9ed2-a26e03f427a3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"StorageAccounts\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"StorageAccounts\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access on a Batch account improves security by ensuring your Batch account can only be accessed from a private endpoint. Learn more about disabling public network access at https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Public network access should be disabled for Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "74c5a0ae-5e48-4738-b093-65e23a060488",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
          "schema_version": 0,
          "attributes": {
            "description": "Enable resource logs for public IP addressess in diagnostic settings to stream to a Log Analytics workspace. Get detailed visibility into attack traffic and actions taken to mitigate DDoS attacks via notifications, reports and flow logs.",
            "display_name": "Public IP addresses should have resource logs enabled for Azure DDoS Protection",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The target Log Analytics workspace for the diagnostic settings\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Enable Logs - True or False\",\"displayName\":\"Enable Logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Enable Metrics - True or False\",\"displayName\":\"Enable Metrics\"}},\"profileName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Profile name for the Azure diagnostic settings resource\",\"displayName\":\"Diagnostic setting name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"name\":{\"value\":\"[field('name')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('name'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DDoSProtectionNotifications\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationFlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationReports\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/publicIPAddresses/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('LogsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('MetricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Azure Migrate project. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Migrate resources to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Migrate\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "7590a335-57cf-4c95-babd-ecbc8fafeb1f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"equals\":\"Default\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"},{\"anyOf\":[{\"contains\":\"Microsoft.Migrate/assessmentProjects\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"contains\":\"Microsoft.Migrate/migrateProjects\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"contains\":\"Microsoft.OffAzure/masterSites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"}]}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"default-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7595c971-233d-4bcf-bd18-596129188c49",
          "schema_version": 0,
          "attributes": {
            "description": "Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for MySQL. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.",
            "display_name": "Private endpoint should be enabled for MySQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7595c971-233d-4bcf-bd18-596129188c49",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "7595c971-233d-4bcf-bd18-596129188c49",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Approved\",\"field\":\"Microsoft.DBforMySQL/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\"},\"type\":\"Microsoft.DBforMySQL/servers/privateEndpointConnections\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a blob groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for blob groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "75973700-529f-4de2-b794-fb9b6781b6b0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a blob groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for blob groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"blob\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all virtual machines in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Deploy Dependency agent for Linux virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"5.1.0\"}",
            "mode": "Indexed",
            "name": "765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-sp4-gen2\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7698e800-9299-47a6-b3b6-5a0fee576eed",
          "schema_version": 0,
          "attributes": {
            "description": "Private endpoint connections enforce secure communication by enabling private connectivity to Azure SQL Database.",
            "display_name": "Private endpoint connections on Azure SQL Database should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7698e800-9299-47a6-b3b6-5a0fee576eed",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "7698e800-9299-47a6-b3b6-5a0fee576eed",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Sql/servers/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.Sql/servers/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7803067c-7d34-46e3-8c79-0ca68fc4036d",
          "schema_version": 0,
          "attributes": {
            "description": "Private endpoints lets you connect your virtual network to Azure services without a public IP address at the source or destination. By mapping private endpoints to your Azure Cache for Redis instances, data leakage risks are reduced. Learn more at: https://docs.microsoft.com/azure/azure-cache-for-redis/cache-private-link.",
            "display_name": "Azure Cache for Redis should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7803067c-7d34-46e3-8c79-0ca68fc4036d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cache\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "7803067c-7d34-46e3-8c79-0ca68fc4036d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Approved\",\"field\":\"Microsoft.Cache/redis/privateEndpointConnections/privateLinkServiceConnectionState.status\"},\"type\":\"Microsoft.Cache/redis/privateEndpointConnections\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7804b5c7-01dc-4723-969b-ae300cc07ff1",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Virtual Networks provide enhanced security and isolation for your Azure Machine Learning Compute Clusters and Instances, as well as subnets, access control policies, and other features to further restrict access. When a compute is configured with a virtual network, it is not publicly addressable and can only be accessed from virtual machines and applications within the virtual network.",
            "display_name": "Azure Machine Learning Computes should be in a virtual network",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7804b5c7-01dc-4723-969b-ae300cc07ff1",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "7804b5c7-01dc-4723-969b-ae300cc07ff1",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/subnet.id\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
          "schema_version": 0,
          "attributes": {
            "description": "Require Azure SQL Managed Instance to be created with Microsoft Entra-only authentication. This policy doesn't block local authentication from being re-enabled on resources after create. Consider using the 'Microsoft Entra-only authentication' initiative instead to require both. Learn more at: https://aka.ms/adonlycreate.",
            "display_name": "Azure SQL Managed Instances should have Microsoft Entra-only authentication enabled during creation",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "78215662-041e-49ed-a9dd-5385911b3a1f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Sql/managedInstances/administrators.azureADOnlyAuthentication\"},{\"equals\":false,\"field\":\"Microsoft.Sql/managedInstances/administrators.azureADOnlyAuthentication\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7926a6d1-b268-4586-8197-e8ae90c877d7",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for APIs brings new discovery, protection, detection, \u0026 response coverage to monitor for common API based attacks \u0026 security misconfigurations.",
            "display_name": "Microsoft Defender for APIs should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7926a6d1-b268-4586-8197-e8ae90c877d7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.3\"}",
            "mode": "All",
            "name": "7926a6d1-b268-4586-8197-e8ae90c877d7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Api\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that your CosmosDB account isn't exposed on the public internet. Creating private endpoints can limit exposure of your CosmosDB account. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation.",
            "display_name": "Azure Cosmos DB should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "797b37f7-06b8-444c-b1ad-fc62867f335a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.DocumentDB/databaseAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve app configuration instances. Learn more at: https://aka.ms/appconfig/private-endpoint.",
            "display_name": "Configure private DNS zones for private endpoints connected to App Configuration",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Configuration\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"configurationStores\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-azconfig-io\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Queue Services to stream resource logs to a Log Analytics workspace when any queue Service which is missing this diagnostic settings is created or updated. Note: This policy is not triggered upon Storage Account creation and requires creation of a remediation task in order to update for the account.",
            "display_name": "Configure diagnostic settings for Queue Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.1\"}",
            "mode": "All",
            "name": "7bd000e3-37c7-4928-9f31-86c4b77c5c45",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"queueServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/queueServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/queueServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
          "schema_version": 0,
          "attributes": {
            "description": "Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Both operating systems and data disks in Azure Kubernetes Service clusters should be encrypted by customer-managed keys",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"False\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"},{\"equals\":\"\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Azure Defender for Azure SQL Database servers should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServers\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Advanced Threat Protection on your non-Basic tier Azure database for MySQL servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Advanced Threat Protection to be enabled on Azure database for MySQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "80ed5239-4122-41ed-b54a-6f1fa7552816",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMySQL/servers/sku.tier\",\"notContains\":\"basic\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"emailAccountAdmins\":false,\"state\":\"Enabled\"},\"type\":\"Microsoft.DBforMySQL/servers/securityAlertPolicies\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioningSuccess\",\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/servers/securityAlertPolicies/Default.state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.DBforMySQL/servers/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/82339799-d096-41ae-8538-b108becf0970",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for MySQL allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.",
            "display_name": "Geo-redundant backup should be enabled for Azure Database for MySQL",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/82339799-d096-41ae-8538-b108becf0970",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "82339799-d096-41ae-8538-b108becf0970",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMySQL/servers/storageProfile.geoRedundantBackup\",\"notEquals\":\"Enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/82985f06-dc18-4a48-bc1c-b9f4f0098cfe",
          "schema_version": 0,
          "attributes": {
            "description": "Restrict pod access to the host network and the allowable host port range in a Kubernetes cluster. This recommendation is part of CIS 5.2.4 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster pods should only use approved host network and port range",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/82985f06-dc18-4a48-bc1c-b9f4f0098cfe",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"6.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "82985f06-dc18-4a48-bc1c-b9f4f0098cfe",
            "parameters": "{\"allowHostNetwork\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Set this value to true if pod is allowed to use host network otherwise false.\",\"displayName\":\"Allow host network usage\",\"portalReview\":true}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"maxPort\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"The maximum value in the allowable host port range that pods can use in the host network namespace.\",\"displayName\":\"Max host port\",\"portalReview\":true}},\"minPort\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"The minimum value in the allowable host port range that pods can use in the host network namespace.\",\"displayName\":\"Min host port\",\"portalReview\":true}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/host-network-ports/v3/template.yaml\"},\"values\":{\"allowHostNetwork\":\"[parameters('allowHostNetwork')]\",\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\",\"maxPort\":\"[parameters('maxPort')]\",\"minPort\":\"[parameters('minPort')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Azure Cosmos DB is an Azure-native layer of security that detects attempts to exploit databases in your Azure Cosmos DB accounts.\nDefender for Azure Cosmos DB detects potential SQL injections, known bad actors based on Microsoft Threat Intelligence, suspicious access patterns, and potential exploitations of your database through compromised identities or malicious insiders.",
            "display_name": "Configure Microsoft Defender for Azure Cosmos DB to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "82bf5b87-728b-4a74-ba4d-6123845cf542",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"CosmosDbs\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"CosmosDbs\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Event Hub should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Hub\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "83a214f7-d01a-484b-91a9-ed54470c9a6a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventHub/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a dfs groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for dfs groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a dfs groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for dfs groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"dfs\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "MySQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "mode": "Indexed",
            "name": "83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforMySQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforMySQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/842c54e8-c2f9-4d79-ae8d-38d8b8019373",
          "schema_version": 0,
          "attributes": {
            "description": "This policy audits Linux Azure Arc machines if the Log Analytics extension is not installed.",
            "display_name": "[Preview]: Log Analytics extension should be installed on your Linux Azure Arc machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/842c54e8-c2f9-4d79-ae8d-38d8b8019373",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"1.0.1-preview\"}",
            "mode": "Indexed",
            "name": "842c54e8-c2f9-4d79-ae8d-38d8b8019373",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
          "schema_version": 0,
          "attributes": {
            "description": "Firewall rules should be defined on your Azure Cosmos DB accounts to prevent traffic from unauthorized sources. Accounts that have at least one IP rule defined with the virtual network filter enabled are deemed compliant. Accounts disabling public access are also deemed compliant.",
            "display_name": "Azure Cosmos DB accounts should have firewall rules",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"2.1.0\"}",
            "mode": "All",
            "name": "862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Policy Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/publicNetworkAccess\"},{\"equals\":\"Enabled\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/publicNetworkAccess\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/isVirtualNetworkFilterEnabled\"},{\"equals\":\"false\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/isVirtualNetworkFilterEnabled\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/ipRules\"},{\"count\":{\"field\":\"Microsoft.DocumentDB/databaseAccounts/ipRules[*]\"},\"equals\":0}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/ipRangeFilter\"},{\"equals\":\"\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/ipRangeFilter\"}]},{\"anyOf\":[{\"count\":{\"field\":\"Microsoft.DocumentDB/databaseAccounts/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.DocumentDB/databaseAccounts/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
          "schema_version": 0,
          "attributes": {
            "description": "Enables transparent data encryption on SQL databases",
            "display_name": "Deploy SQL DB transparent data encryption",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.2.0\"}",
            "mode": "Indexed",
            "name": "86a912f6-9a06-4e26-b447-11b16ba8659f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notEquals\":\"master\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"fullDbName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"fullDbName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2022-05-01-preview\",\"name\":\"[concat(parameters('fullDbName'), '/current')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"}]}}},\"existenceCondition\":{\"anyOf\":[{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/transparentDataEncryption.status\"},{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/servers/databases/transparentDataEncryption/state\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec\"],\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
          "schema_version": 0,
          "attributes": {
            "description": "Private DNS records allow private connections to private endpoints. Private endpoint connections allow secure communication by enabling private connectivity to your Azure Data Factory without a need for public IP addresses at the source or destination. For more information on private endpoints and DNS zones in Azure Data Factory, see https://docs.microsoft.com/azure/data-factory/data-factory-private-link.",
            "display_name": "Configure private DNS zones for private endpoints that connect to Azure Data Factory",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Factory\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "86cd96e1-1745-420d-94d4-d3f2fe415aa4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfGroupIds\":{\"type\":\"Array\",\"allowedValues\":[\"dataFactory\",\"portal\"],\"defaultValue\":[\"dataFactory\",\"portal\"],\"metadata\":{\"description\":\"The list of Group Ids that can be specified for Private Endpoints.\",\"displayName\":\"Allowed Group Ids\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private DNS Zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"in\":\"[parameters('listOfGroupIds')]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"dataFactory-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.",
            "display_name": "Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Box\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "86efb160-8de7-451d-bc08-5d475b0aadae",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}},\"supportedSKUs\":{\"type\":\"Array\",\"allowedValues\":[\"DataBox\",\"DataBoxHeavy\"],\"defaultValue\":[\"DataBox\",\"DataBoxHeavy\"],\"metadata\":{\"description\":\"The list of SKUs that support customer-managed key encryption key\",\"displayName\":\"Supported SKUs\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DataBox/jobs\",\"field\":\"type\"},{\"field\":\"Microsoft.Databox/jobs/sku.name\",\"in\":\"[parameters('supportedSKUs')]\"},{\"field\":\"Microsoft.DataBox/jobs/details.keyEncryptionKey.kekType\",\"notEquals\":\"CustomerManaged\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.",
            "display_name": "Azure Stream Analytics jobs should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stream Analytics\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"SystemAccount\",\"field\":\"Microsoft.StreamAnalytics/streamingJobs/contentStoragePolicy\"},{\"equals\":\"Microsoft.StreamAnalytics/streamingJobs\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure's check of the source and destination for a network interface. This should be reviewed by the network security team.",
            "display_name": "Network interfaces should disable IP forwarding",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "88c0b9da-ce96-4b03-9635-f29a937e2900",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkInterfaces\",\"field\":\"type\"},{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkInterfaces/enableIpForwarding\"}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
          "schema_version": 0,
          "attributes": {
            "description": "For incident investigation purposes, we recommend setting the data retention for your SQL Server' auditing to storage account destination to at least 90 days. Confirm that you are meeting the necessary retention rules for the regions in which you are operating. This is sometimes required for compliance with regulatory standards.",
            "display_name": "SQL servers with auditing to storage account destination should be configured with 90 days retention or higher",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "89099bee-89e0-4b26-a5f4-165451757743",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"anyOf\":[{\"allOf\":[{\"equals\":true,\"field\":\"Microsoft.Sql/servers/auditingSettings/isAzureMonitorTargetEnabled\"},{\"equals\":\"\",\"field\":\"Microsoft.Sql/servers/auditingSettings/storageEndpoint\"}]},{\"equals\":0,\"field\":\"Microsoft.Sql/servers/auditingSettings/retentionDays\"},{\"field\":\"Microsoft.Sql/servers/auditingSettings/retentionDays\",\"greaterOrEquals\":90}]},\"name\":\"default\",\"type\":\"Microsoft.Sql/servers/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8ac833bd-f505-48d5-887e-c993a1d3eea0",
          "schema_version": 0,
          "attributes": {
            "description": "API endpoints published within Azure API Management should enforce authentication to help minimize security risk. Authentication mechanisms are sometimes implemented incorrectly or are missing. This allows attackers to exploit implementation flaws and to access data. Learn More about the OWASP API Threat for Broken User Authentication here: https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats#broken-user-authentication",
            "display_name": "API endpoints in Azure API Management should be authenticated",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8ac833bd-f505-48d5-887e-c993a1d3eea0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "8ac833bd-f505-48d5-887e-c993a1d3eea0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ApiManagement/service/apis/operations\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"91af2040-7874-4659-abf0-578e1f8d07dc\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Azure Active Directory (Azure AD) to authorize requests for your storage account. By default, requests can be authorized with either Azure Active Directory credentials, or by using the account access key for Shared Key authorization. Of these two types of authorization, Azure AD provides superior security and ease of use over Shared Key, and is recommended by Microsoft.",
            "display_name": "Storage accounts should prevent shared key access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/allowSharedKeyAccess\"},{\"equals\":\"\",\"field\":\"Microsoft.Storage/storageAccounts/allowSharedKeyAccess\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/allowSharedKeyAccess\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8d7e1fde-fe26-4b5f-8108-f8e432cbc2be",
          "schema_version": 0,
          "attributes": {
            "description": "Deprecated accounts should be removed from your subscriptions.  Deprecated accounts are accounts that have been blocked from signing in.",
            "display_name": "Blocked accounts with read and write permissions on Azure resources should be removed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8d7e1fde-fe26-4b5f-8108-f8e432cbc2be",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "8d7e1fde-fe26-4b5f-8108-f8e432cbc2be",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"1ff0b4c9-ed56-4de6-be9c-d7ab39645926\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8dfab9c4-fe7b-49ad-85e4-1e9be085358f",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Cloud extension for Azure Arc provides threat protection for your Arc enabled Kubernetes clusters. The extension collects data from all nodes in the cluster and sends it to the Azure Defender for Kubernetes backend in the cloud for further analysis. Learn more in https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable?pivots=defender-for-container-arc.",
            "display_name": "[Preview]: Azure Arc enabled Kubernetes clusters should have Microsoft Defender for Cloud extension installed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8dfab9c4-fe7b-49ad-85e4-1e9be085358f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"preview\":\"true\",\"version\":\"6.0.0-preview\"}",
            "mode": "Indexed",
            "name": "8dfab9c4-fe7b-49ad-85e4-1e9be085358f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Kubernetes/connectedClusters\",\"field\":\"type\"},{\"field\":\"Microsoft.Kubernetes/connectedClusters/distribution\",\"notIn\":[\"aks\",\"aks_management\",\"eks\",\"gke\"]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"microsoft.azuredefender.kubernetes\",\"field\":\"Microsoft.KubernetesConfiguration/extensions/extensionType\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.KubernetesConfiguration/extensions/provisioningState\"}]},\"type\":\"Microsoft.KubernetesConfiguration/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy resource group containing Log Analytics workspace and linked automation account to centralize logs and monitoring. The automation account is aprerequisite for solutions like Updates and Change Tracking.",
            "display_name": "Configure Log Analytics workspace and automation account to centralize logs and monitoring",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "parameters": "{\"automationAccountName\":{\"type\":\"String\",\"defaultValue\":\"CentralAutomationAccount\",\"metadata\":{\"description\":\"Provide name for automation account\",\"displayName\":\"automationAccountName\"}},\"automationRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for automation account\",\"displayName\":\"automationRegion\",\"strongType\":\"location\"}},\"dataRetention\":{\"type\":\"String\",\"defaultValue\":\"30\",\"metadata\":{\"description\":\"Enter the retention period in workspace, can be between 7 to 730 days. Billing is per 30 days at the minimum even when retention is shorter\",\"displayName\":\"dataRetention\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Select DeployIfNotExists to deploy central Log Analytics workspace, Audit or Disable to disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"defaultValue\":\"CentralRG\",\"metadata\":{\"description\":\"Provide name for resource group\",\"displayName\":\"rgName\"}},\"sku\":{\"type\":\"String\",\"allowedValues\":[\"pergb2018\",\"Free\",\"Standalone\",\"PerNode\",\"Standard\",\"Premium\"],\"defaultValue\":\"pergb2018\",\"metadata\":{\"description\":\"Select pricing tier. Legacy tiers (Free, Standalone, PerNode, Standard or Premium) are not available to all customers\",\"displayName\":\"sku\"}},\"workspaceName\":{\"type\":\"String\",\"defaultValue\":\"CentralWorkspace\",\"metadata\":{\"description\":\"Provide name for log analytics workspace\",\"displayName\":\"workspaceName\"}},\"workspaceRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enter Azure region for Log Analytics workspace\",\"displayName\":\"workspaceRegion\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('rgName')]\",\"deployment\":{\"location\":\"West Central US\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"automationAccountName\":{\"value\":\"[parameters('automationAccountName')]\"},\"automationRegion\":{\"value\":\"[parameters('automationRegion')]\"},\"dataRetention\":{\"value\":\"[parameters('dataRetention')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"},\"sku\":{\"value\":\"[parameters('sku')]\"},\"workspaceName\":{\"value\":\"[parameters('workspaceName')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"automationAccountName\":{\"type\":\"String\"},\"automationRegion\":{\"type\":\"String\"},\"dataRetention\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"},\"sku\":{\"type\":\"String\"},\"workspaceName\":{\"type\":\"String\"},\"workspaceRegion\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"log-analytics\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiversion\":\"2015-10-31\",\"comments\":\"Automation account for Log Analytics workapce\",\"location\":\"[parameters('AutomationRegion')]\",\"name\":\"[parameters('AutomationAccountName')]\",\"properties\":{\"sku\":{\"name\":\"OMS\"}},\"type\":\"Microsoft.Automation/automationAccounts\"},{\"apiVersion\":\"2020-08-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('workspaceName')]\",\"properties\":{\"enableLogAccessUsingOnlyResourcePermissions\":true,\"retentionInDays\":\"[parameters('dataRetention')]\",\"sku\":{\"name\":\"[parameters('sku')]\"}},\"resources\":[{\"apiVersion\":\"2020-08-01\",\"dependsOn\":[\"[parameters('workspaceName')]\",\"[parameters('AutomationAccountName')]\"],\"name\":\"Automation\",\"properties\":{\"resourceId\":\"[concat(subscription().id, '/resourceGroups/', parameters('rgName'), '/providers/Microsoft.Automation/automationAccounts/', parameters('AutomationAccountName'))]\"},\"type\":\"linkedServices\"}],\"type\":\"Microsoft.OperationalInsights/workspaces\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceScope\":\"resourcegroup\",\"name\":\"[parameters('workspaceName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.OperationalInsights/workspaces\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for servers provides real-time threat protection for server workloads and generates hardening recommendations as well as alerts about suspicious activities.",
            "display_name": "Configure Azure Defender for servers to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"VirtualMachines\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"VirtualMachines\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a dfs_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for dfs_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "90bd4cb3-9f59-45f7-a6ca-f69db2726671",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a dfs_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for dfs_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"dfs_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised.",
            "display_name": "App Service apps should have resource logs enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.1\"}",
            "mode": "Indexed",
            "name": "91a78b24-f231-4a8a-8da9-02c35b2b6510",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.0\"}",
            "mode": "Indexed",
            "name": "91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-11-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('DaExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"settings\":{},\"type\":\"[variables('DaExtensionType')]\",\"typeHandlerVersion\":\"[variables('DaExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"DaExtensionName\":\"DependencyAgentWindows\",\"DaExtensionType\":\"DependencyAgentWindows\",\"DaExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
          "schema_version": 0,
          "attributes": {
            "description": "To improve the API security, API Management should validate the backend server certificate for all API calls. Enable SSL certificate thumbprint and name validation.",
            "display_name": "API Management calls to API backends should not bypass certificate thumbprint or name validation",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "92bb331d-ac71-416a-8c91-02f2cb734ce4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service/backends\",\"field\":\"type\"},{\"anyof\":[{\"equals\":false,\"field\":\"Microsoft.ApiManagement/service/backends/tls.validateCertificateChain\"},{\"equals\":false,\"field\":\"Microsoft.ApiManagement/service/backends/tls.validateCertificateName\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/938c4981-c2c9-4168-9cd6-972b8675f906",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, discovering and classifying sensitive data. Once enabled, the protection status indicates that the resource is actively monitored. Even when Defender is enabled, multiple configuration settings should be validated on the agent, machine, workspace and SQL server to ensure active protection.",
            "display_name": "Microsoft Defender for SQL status should be protected for Arc-enabled SQL Servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/938c4981-c2c9-4168-9cd6-972b8675f906",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "938c4981-c2c9-4168-9cd6-972b8675f906",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.AzureArcData/sqlServerInstances\",\"field\":\"type\"},{\"anyOf\":[{\"Equals\":\"Not Protected\",\"field\":\"Microsoft.AzureArcData/sqlServerInstances/azureDefenderStatus\"},{\"allOf\":[{\"field\":\"Microsoft.AzureArcData/sqlServerInstances/azureDefenderStatus\",\"notEquals\":\"Not Protected\"},{\"less\":\"[addDays(utcNow(), -1)]\",\"value\":\"[field('Microsoft.AzureArcData/sqlServerInstances/azureDefenderStatusLastUpdated')]\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Recovery Services Vaults. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "[Preview]: Configure Azure Recovery Services vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Site Recovery\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "mode": "Indexed",
            "name": "942bd215-1a66-44be-af65-6a1c0318dbe2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone name required to resolve a private DNS Zone to recovery services vault private endpoint records.\",\"displayName\":\"Private DNS zone Id for Azure Recovery vaults resources\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"AzureSiteRecovery\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-siterecovery\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "parameters": "{\"ddosPlan\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoS Protection Plan resource to be associated to the virtual networks\",\"displayName\":\"DDoS Protection Plan\",\"strongType\":\"Microsoft.Network/ddosProtectionPlans\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Modify\",\"Audit\",\"Disabled\"],\"defaultValue\":\"Modify\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"notEquals\":true},{\"equals\":\"\",\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan\"}]}]},\"then\":{\"details\":{\"conflictEffect\":\"audit\",\"operations\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"operation\":\"addOrReplace\",\"value\":true},{\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan.id\",\"operation\":\"addOrReplace\",\"value\":\"[parameters('ddosPlan')]\"}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"]},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/94e1c2ac-cbbe-4cac-a2b5-389c812dee87",
          "schema_version": 0,
          "attributes": {
            "description": "External accounts with write privileges should be removed from your subscription in order to prevent unmonitored access.",
            "display_name": "Guest accounts with write permissions on Azure resources should be removed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/94e1c2ac-cbbe-4cac-a2b5-389c812dee87",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "94e1c2ac-cbbe-4cac-a2b5-389c812dee87",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"0354476c-a12a-4fcc-a79d-f0ab7ffffdbb\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/951c1558-50a5-4ca3-abb6-a93e3e2367a6",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Microsoft Defender for SQL on your Azure Synapse workspaces to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit SQL databases.",
            "display_name": "Configure Microsoft Defender for SQL to be enabled on Synapse workspaces",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/951c1558-50a5-4ca3-abb6-a93e3e2367a6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "951c1558-50a5-4ca3-abb6-a93e3e2367a6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Synapse/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"workspaceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"workspaceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-06-01\",\"name\":\"[concat(parameters('workspaceName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.Synapse/workspaces/securityAlertPolicies\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Synapse/workspaces/securityAlertPolicies/state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Synapse/workspaces/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can limit exposure of your Automation account resources by creating private endpoints instead. Learn more at: https://docs.microsoft.com/azure/automation/how-to/private-link-security.",
            "display_name": "Automation accounts should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Automation\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "955a914f-bf86-4f0e-acd5-e0766b0efcb6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Automation/automationAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Automation/automationAccounts/publicNetworkAccess\",\"notEquals\":\"false\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow privileged containers creation in a Kubernetes cluster. This recommendation is part of CIS 5.2.1 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster should not allow privileged containers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"9.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "95edb821-ddaf-4404-9732-666045e056b4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/container-no-privilege/v2/template.yaml\"},\"values\":{\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/969ac98b-88a8-449f-883c-2e9adb123127",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that the Function app is not exposed on the public internet. Creating private endpoints can limit exposure of a Function App. Learn more at: https://aka.ms/app-service-private-endpoint.",
            "display_name": "Function apps should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/969ac98b-88a8-449f-883c-2e9adb123127",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "969ac98b-88a8-449f-883c-2e9adb123127",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Web/sites/publicNetworkAccess\"},{\"field\":\"Microsoft.Web/sites/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/97566dd7-78ae-4997-8b36-1c7bfe0d8121",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Secure Boot on supported Windows virtual machines to mitigate against malicious and unauthorized changes to the boot chain. Once enabled, only trusted bootloaders, kernel and kernel drivers will be allowed to run. This assessment applies to Trusted Launch and Confidential Windows virtual machines.",
            "display_name": "[Preview]: Secure Boot should be enabled on supported Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/97566dd7-78ae-4997-8b36-1c7bfe0d8121",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"4.0.0-preview\"}",
            "mode": "Indexed",
            "name": "97566dd7-78ae-4997-8b36-1c7bfe0d8121",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.imageReference.offer\",\"like\":\"windows*\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.securityType\",\"in\":[\"TrustedLaunch\",\"ConfidentialVM\"]},{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings\"},{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.secureBootEnabled\",\"notequals\":\"true\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9830b652-8523-49cc-b1b3-e17dce1127ca",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your Event Grid domain instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/privateendpoints.",
            "display_name": "Azure Event Grid domains should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9830b652-8523-49cc-b1b3-e17dce1127ca",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "9830b652-8523-49cc-b1b3-e17dce1127ca",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.EventGrid/domains\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.EventGrid/domains/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.EventGrid/domains/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
          "schema_version": 0,
          "attributes": {
            "description": "Secrets should have a defined expiration date and not be permanent. Secrets that are valid forever provide a potential attacker with more time to compromise them. It is a recommended security practice to set expiration dates on secrets.",
            "display_name": "Key Vault secrets should have an expiration date",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.0.2\"}",
            "mode": "Microsoft.KeyVault.Data",
            "name": "98728c90-32c7-4049-8429-847dc0f4fe37",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault.Data/vaults/secrets\",\"field\":\"type\"},{\"exists\":false,\"field\":\"Microsoft.KeyVault.Data/vaults/secrets/attributes.expiresOn\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"9.4.0\"}",
            "mode": "Indexed",
            "name": "98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"auditIfNotExists\",\"AuditIfNotExists\",\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"exclusionTagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding VMs from the scope of this policy. This should be used along with the Exclusion Tag Value parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Name\"}},\"exclusionTagValue\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Value of the tag to use for excluding VMs from the scope of this policy (in case of multiple values, use a comma-separated list). This should be used along with the Exclusion Tag Name parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Values\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"field\":\"[concat('tags[', parameters('exclusionTagName'), ']')]\",\"in\":\"[parameters('exclusionTagValue')]\"}},{\"field\":\"id\",\"notContains\":\"/resourceGroups/databricks-rg-\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"azureopenshift\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"AzureDatabricks\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter-g2\",\"2022-datacenter\",\"2022-datacenter-azure-edition\",\"2022-datacenter-azure-edition-smalldisk\",\"2022-datacenter-azure-edition-core\",\"2022-datacenter-azure-edition-core-smalldisk\",\"2022-datacenter-smalldisk-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-core-g2\",\"2022-datacenter-core\",\"2022-datacenter-core-smalldisk-g2\",\"2022-datacenter-core-smalldisk\",\"2022-datacenter-azure-edition-hotpatch\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sql2019-ws2022\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"sqldev\",\"sqldev-gen2\",\"standard\",\"standard-gen2\"]}]},{\"allOf\":[{\"equals\":\"sql2022-ws2022\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"web-gen2\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2019\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-11\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"RHEL-BYOS\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"rhel-lvm77\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"contains\":\"ubuntu\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*20_04-lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04-lts*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"22_04-lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"CentOS-HPC\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"7_9-gen2\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmRgName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"status\":{\"type\":\"string\",\"value\":\"[concat('Backup enabled successfully for VM:', ' ', parameters('vmName'), 'Backup Vault: ', variables('vaultName'))]\"}},\"parameters\":{\"location\":{\"metadata\":{\"description\":\"Location for VM and Backup vault\"},\"type\":\"string\"},\"vmName\":{\"metadata\":{\"description\":\"Name of Azure Virtual Machines\"},\"type\":\"string\"},\"vmRgName\":{\"metadata\":{\"description\":\"Resource group containing the virtual machines.\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2016-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('vaultName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard\"},\"type\":\"Microsoft.RecoveryServices/vaults\"},{\"apiVersion\":\"2016-12-01\",\"dependsOn\":[\"[resourceId('Microsoft.RecoveryServices/vaults/', variables('vaultName'))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('vaultName'), '/', variables('backupFabric'), '/', variables('v2VmContainer'), concat(parameters('vmRgName'),';',parameters('vmName')), '/', variables('v2Vm'), concat(parameters('vmRgName'),';',parameters('vmName')))]\",\"properties\":{\"policyId\":\"[resourceId('Microsoft.RecoveryServices/vaults/backupPolicies', variables('vaultName'),variables('backupPolicy'))]\",\"protectedItemType\":\"[variables('v2VmType')]\",\"sourceResourceId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', parameters('vmRgName'), '/providers/Microsoft.Compute/virtualMachines/', parameters('vmName'))]\"},\"type\":\"Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\"}],\"variables\":{\"backupFabric\":\"Azure\",\"backupPolicy\":\"DefaultPolicy\",\"v2Vm\":\"vm;iaasvmcontainerv2;\",\"v2VmContainer\":\"iaasvmcontainer;iaasvmcontainerv2;\",\"v2VmType\":\"Microsoft.Compute/virtualMachines\",\"vaultName\":\"[take(concat('RSVault-', parameters('location'), '-', guid(resourceGroup().id)),50)]\"}}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\"/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\"],\"type\":\"Microsoft.RecoveryServices/backupprotecteditems\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
              "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/Batch-CMK.",
            "display_name": "Azure Batch account should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a web groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for web groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "9adab2a5-05ba-4fbd-831a-5bf958d04218",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a web groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for web groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"web\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9c25c9e4-ee12-4882-afd2-11fb9d87893f",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Virtual Networks provide enhanced security and isolation for your Azure Databricks Workspaces, as well as subnets, access control policies, and other features to further restrict access. Learn more at: https://docs.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject.",
            "display_name": "Azure Databricks Workspaces should be in a virtual network",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9c25c9e4-ee12-4882-afd2-11fb9d87893f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Databricks\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "9c25c9e4-ee12-4882-afd2-11fb9d87893f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Databricks/workspaces/parameters.customPublicSubnetName.value\"},{\"exists\":\"false\",\"field\":\"Microsoft.Databricks/workspaces/parameters.customPrivateSubnetName.value\"},{\"exists\":\"false\",\"field\":\"Microsoft.Databricks/workspaces/parameters.customVirtualNetworkId.value\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Linux servers. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "mode": "Indexed",
            "name": "9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Security Center has identified some of your network security groups' inbound rules to be too permissive. Inbound rules should not allow access from 'Any' or 'Internet' ranges. This can potentially enable attackers to target your resources.",
            "display_name": "All network ports should be restricted on network security groups associated to your virtual machine",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "9daedab3-fb2d-461e-b861-71790eead4f6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"3b20e985-f71f-483b-b078-f30d73936d43\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access (public endpoint) on Azure SQL Managed Instances improves security by ensuring that they can only be accessed from inside their virtual networks or via Private Endpoints. To learn more about public network access, visit https://aka.ms/mi-public-endpoint.",
            "display_name": "Azure SQL Managed Instances should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "9dfea752-dd46-4766-aed1-c355fa93fb91",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"equals\":true,\"field\":\"Microsoft.Sql/managedInstances/publicDataEndpointEnabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373",
          "schema_version": 0,
          "attributes": {
            "description": "Prevent usage of the default namespace in Kubernetes clusters to protect against unauthorized access for ConfigMap, Pod, Secret, Service, and ServiceAccount resource types. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should not use the default namespace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"4.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "9f061a12-e40d-4183-a00e-171812443373",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[\"default\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\",\"Service\",\"ServiceAccount\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/block-default-namespace/v1/template.yaml\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to specify the resource types that your organization can deploy. Only resource types that support 'tags' and 'location' will be affected by this policy. To restrict all resources please duplicate this policy and change the 'mode' to 'All'.",
            "display_name": "Allowed resource types",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c",
            "management_group_name": null,
            "metadata": "{\"category\":\"General\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "a08ec900-254a-4555-9bf5-e42af04b5c5c",
            "parameters": "{\"listOfResourceTypesAllowed\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of resource types that can be deployed.\",\"displayName\":\"Allowed resource types\",\"strongType\":\"resourceTypes\"}}}",
            "policy_rule": "{\"if\":{\"not\":{\"field\":\"type\",\"in\":\"[parameters('listOfResourceTypesAllowed')]\"}},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a1840de2-8088-4ea8-b153-b4c723e9cb01",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Containers provides cloud-native Kubernetes security capabilities including environment hardening, workload protection, and run-time protection. When you enable the SecurityProfile.AzureDefender on your Azure Kubernetes Service cluster, an agent is deployed to your cluster to collect security event data. Learn more about Microsoft Defender for Containers in https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks",
            "display_name": "Azure Kubernetes Service clusters should have Defender profile enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a1840de2-8088-4ea8-b153-b4c723e9cb01",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"2.0.1\"}",
            "mode": "Indexed",
            "name": "a1840de2-8088-4ea8-b153-b4c723e9cb01",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerService/managedClusters/securityProfile.defender.securityMonitoring.enabled\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a21f8c92-9e22-4f09-b759-50500d1d2dda",
          "schema_version": 0,
          "attributes": {
            "description": "Install Guest Attestation extension on supported Linux virtual machines scale sets to allow Azure Security Center to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation.  This assessment applies to Trusted Launch and Confidential Linux virtual machine scale sets.",
            "display_name": "[Preview]: Guest Attestation extension should be installed on supported Linux virtual machines scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a21f8c92-9e22-4f09-b759-50500d1d2dda",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"5.1.0-preview\"}",
            "mode": "Indexed",
            "name": "a21f8c92-9e22-4f09-b759-50500d1d2dda",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"18_04-lts-gen2\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"20_04-lts-gen2\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-confidential-vm-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"20_04-lts-cvm\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"RHEL\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"83-gen2\"}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"SLES-15-SP2\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSku\",\"like\":\"gen2\"}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"CENTOS\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"8_3-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"ol83-lvm-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]},{\"allOf\":[{\"equals\":\"microsoftcblmariner\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cbl-mariner\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"1-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]},{\"allOf\":[{\"equals\":\"debian\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"debian-11\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"11-gen2\",\"field\":\"Microsoft.Compute/imageSku\"}]}]},{\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.securityType\",\"in\":[\"TrustedLaunch\",\"ConfidentialVM\"]},{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings.vTpmEnabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings.secureBootEnabled\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.Security.LinuxAttestation\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},{\"equals\":\"GuestAttestation\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"}]},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5",
          "schema_version": 0,
          "attributes": {
            "description": "Audit built-in roles such as 'Owner, Contributer, Reader' instead of custom RBAC roles, which are error prone. Using custom roles is treated as an exception and requires a rigorous review and threat modeling",
            "display_name": "Audit usage of custom RBAC roles",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5",
            "management_group_name": null,
            "metadata": "{\"category\":\"General\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "a451c1ef-c6ca-483d-87ed-f49761e3ffb5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Authorization/roleDefinitions\",\"field\":\"type\"},{\"equals\":\"CustomRole\",\"field\":\"Microsoft.Authorization/roleDefinitions/type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "App Service apps should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"4.0.0\"}",
            "mode": "Indexed",
            "name": "a4af4a39-4135-47fb-b175-47fbdf85311d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to CosmosDB account. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure CosmosDB accounts to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "a63cc0bd-cda4-4178-b705-37dc439d3e0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private Dns Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"privateEndpointGroupId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A group Id for the private endpoint\",\"displayName\":\"Private Endpoint Group Id\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.DocumentDb/databaseAccounts\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('privateEndpointGroupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"cosmosDB-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to key vault, you can reduce data leakage risks. Learn more about private links at: https://aka.ms/akvprivatelink.",
            "display_name": "Azure Key Vaults should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.2.1\"}",
            "mode": "Indexed",
            "name": "a6abeaec-4d90-4a02-805f-6b26c4d3fbe9",
            "parameters": "{\"audit_effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"deprecated\":true,\"description\":\"The Deny effect has been deprecated for this policy given that the simultaneous creation of a Key Vault and its associated private endpoint is not possible. Therefore, Deny prevents the creation of any new Key Vault.\",\"displayName\":\"[Deprecated]: Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.KeyVault/vaults/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.KeyVault/vaults/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('audit_effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a6cf7411-da9e-49e2-aec0-cba0250eaf8c",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Advanced Threat Protection on your non-Basic tier Azure database for MariaDB servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Advanced Threat Protection to be enabled on Azure database for MariaDB servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a6cf7411-da9e-49e2-aec0-cba0250eaf8c",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "a6cf7411-da9e-49e2-aec0-cba0250eaf8c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/sku.tier\",\"notContains\":\"basic\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"emailAccountAdmins\":false,\"state\":\"Enabled\"},\"type\":\"Microsoft.DBforMariaDB/servers/securityAlertPolicies\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioningSuccess\",\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMariaDB/servers/securityAlertPolicies/Default.state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.DBforMariaDB/servers/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
          "schema_version": 0,
          "attributes": {
            "description": "Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.",
            "display_name": "Auditing on SQL server should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"setting\":{\"type\":\"String\",\"allowedValues\":[\"enabled\",\"disabled\"],\"defaultValue\":\"enabled\",\"metadata\":{\"displayName\":\"Desired Auditing setting\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"[parameters('setting')]\",\"field\":\"Microsoft.Sql/auditingSettings.state\"},\"name\":\"default\",\"type\":\"Microsoft.Sql/servers/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd",
          "schema_version": 0,
          "attributes": {
            "description": "DDoS protection should be enabled for all virtual networks with a subnet that is part of an application gateway with a public IP.",
            "display_name": "Azure DDoS Protection should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.1\"}",
            "mode": "All",
            "name": "a7aca53f-2ed4-4466-a25e-0b45ade68efd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"microsoft.network/virtualNetworks\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"e3de1cc0-f4dd-3b34-e496-8b5381ba2d70\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
          "schema_version": 0,
          "attributes": {
            "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
            "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"4.2.0\"}",
            "mode": "Indexed",
            "name": "a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"clusterName\":{\"value\":\"[field('name')]\"},\"clusterResourceGroupName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"clusterName\":{\"type\":\"string\"},\"clusterResourceGroupName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterGetDeploymentName')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"aksCluster\":{\"type\":\"object\",\"value\":\"[reference(resourceId(parameters('clusterResourceGroupName'), 'Microsoft.ContainerService/managedClusters', parameters('clusterName')), '2021-07-01', 'Full')]\"}},\"resources\":[]}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterUpdateDeploymentName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"aksClusterContent\":{\"value\":\"[reference(variables('clusterGetDeploymentName')).outputs.aksCluster.value]\"},\"aksClusterName\":{\"value\":\"[parameters('clusterName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"aksClusterContent\":{\"type\":\"object\"},\"aksClusterName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-07-01\",\"location\":\"[parameters('aksClusterContent').location]\",\"name\":\"[parameters('aksClusterName')]\",\"properties\":{\"aadProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'aadProfile'), parameters('aksClusterContent').properties.aadProfile, json('null'))]\",\"addonProfiles\":{\"azurepolicy\":{\"enabled\":true}},\"agentPoolProfiles\":\"[if(contains(parameters('aksClusterContent').properties, 'agentPoolProfiles'), parameters('aksClusterContent').properties.agentPoolProfiles, json('null'))]\",\"apiServerAccessProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'apiServerAccessProfile'), parameters('aksClusterContent').properties.apiServerAccessProfile, json('null'))]\",\"autoScalerProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'autoScalerProfile'), parameters('aksClusterContent').properties.autoScalerProfile, json('null'))]\",\"disableLocalAccounts\":\"[if(contains(parameters('aksClusterContent').properties, 'disableLocalAccounts'), parameters('aksClusterContent').properties.disableLocalAccounts, json('null'))]\",\"diskEncryptionSetID\":\"[if(contains(parameters('aksClusterContent').properties, 'diskEncryptionSetID'), parameters('aksClusterContent').properties.diskEncryptionSetID, json('null'))]\",\"enablePodSecurityPolicy\":\"[if(contains(parameters('aksClusterContent').properties, 'enablePodSecurityPolicy'), parameters('aksClusterContent').properties.enablePodSecurityPolicy, json('null'))]\",\"enableRBAC\":\"[if(contains(parameters('aksClusterContent').properties, 'enableRBAC'), parameters('aksClusterContent').properties.enableRBAC, json('null'))]\",\"identityProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'identityProfile'), parameters('aksClusterContent').properties.identityProfile, json('null'))]\",\"kubernetesVersion\":\"[parameters('aksClusterContent').properties.kubernetesVersion]\",\"linuxProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'linuxProfile'), parameters('aksClusterContent').properties.linuxProfile, json('null'))]\",\"networkProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'networkProfile'), parameters('aksClusterContent').properties.networkProfile, json('null'))]\",\"nodeResourceGroup\":\"[parameters('aksClusterContent').properties.nodeResourceGroup]\",\"servicePrincipalProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'servicePrincipalProfile'), parameters('aksClusterContent').properties.servicePrincipalProfile, json('null'))]\",\"windowsProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'windowsProfile'), parameters('aksClusterContent').properties.windowsProfile, json('null'))]\"},\"sku\":\"[parameters('aksClusterContent').sku]\",\"tags\":\"[if(contains(parameters('aksClusterContent'), 'tags'), parameters('aksClusterContent').tags, json('null'))]\",\"type\":\"Microsoft.ContainerService/managedClusters\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"clusterGetDeploymentName\":\"[take(concat('Policy-Get-', parameters('clusterName')), 64)]\",\"clusterUpdateDeploymentName\":\"[take(concat('Policy-Update-', parameters('clusterName')), 64)]\"}}}},\"existenceCondition\":{\"equals\":\"true\",\"field\":\"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\"},\"name\":\"[field('name')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8\",\"/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064\"],\"type\":\"Microsoft.ContainerService/managedClusters\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
              "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to an IoT Hub device provisioning service instance. Learn more at: https://aka.ms/iotdpsvnet.",
            "display_name": "Configure IoT Hub device provisioning instances to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotDps\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices-provisioning.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ab6a902f-9493-453b-928d-62c30b11b5a6",
          "schema_version": 0,
          "attributes": {
            "description": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app. This policy applies to apps with Http version set to 1.1.",
            "display_name": "Function apps should have Client Certificates (Incoming client certificates) enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ab6a902f-9493-453b-928d-62c30b11b5a6",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "ab6a902f-9493-453b-928d-62c30b11b5a6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"},{\"field\":\"Microsoft.Web/sites/clientCertEnabled\",\"notEquals\":\"true\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"true\",\"field\":\"Microsoft.Web/sites/config/web.http20Enabled\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
          "schema_version": 0,
          "attributes": {
            "description": "Require Azure SQL logical servers to be created with Microsoft Entra-only authentication. This policy doesn't block local authentication from being re-enabled on resources after create. Consider using the 'Microsoft Entra-only authentication' initiative instead to require both. Learn more at: https://aka.ms/adonlycreate.",
            "display_name": "Azure SQL Database should have Microsoft Entra-only authentication enabled during creation",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "abda6d70-9778-44e7-84a8-06713e6db027",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"notContains\":\"/providers/Microsoft.Synapse/\",\"value\":\"[resourcegroup().managedBy]\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Sql/servers/administrators.azureADOnlyAuthentication\"},{\"equals\":false,\"field\":\"Microsoft.Sql/servers/administrators.azureADOnlyAuthentication\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
          "schema_version": 0,
          "attributes": {
            "description": "Audit SQL servers without Advanced Data Security",
            "display_name": "Azure Defender for SQL should be enabled for unprotected Azure SQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.1\"}",
            "mode": "Indexed",
            "name": "abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/servers/securityAlertPolicies/state\"},\"name\":\"Default\",\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9",
          "schema_version": 0,
          "attributes": {
            "description": "Audit each SQL Managed Instance without advanced data security.",
            "display_name": "Azure Defender for SQL should be enabled for unprotected SQL Managed Instances",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/managedInstances/securityAlertPolicies/state\"},\"name\":\"Default\",\"type\":\"Microsoft.Sql/managedInstances/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
          "schema_version": 0,
          "attributes": {
            "description": "Implementing Transparent Data Encryption (TDE) with your own key provides you with increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.",
            "display_name": "SQL managed instances should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Sql/managedInstances/keyid\"},{\"equals\":\"\",\"field\":\"Microsoft.Sql/managedInstances/keyid\"}]}]},{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances/encryptionProtector\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/managedInstances/encryptionProtector/serverKeyType\",\"notequals\":\"AzureKeyVault\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
          "schema_version": 0,
          "attributes": {
            "description": "To provide granular filtering on the actions that users can perform, use Role-Based Access Control (RBAC) to manage permissions in Kubernetes Service Clusters and configure relevant authorization policies.",
            "display_name": "Role-Based Access Control (RBAC) should be used on Kubernetes Services",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"exists\":\"true\",\"field\":\"Microsoft.ContainerService/managedClusters/enableRBAC\"},{\"equals\":\"false\",\"field\":\"Microsoft.ContainerService/managedClusters/enableRBAC\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to key vault. Learn more at: https://aka.ms/akvprivatelink.",
            "display_name": "Configure Azure Key Vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"A private DNS zone ID to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"vault\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"keyvault-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ae89ebca-1c92-4898-ac2c-9f63decb045c",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure secure configurations of in-guest settings of your machine, install the Guest Configuration extension. In-guest settings that the extension monitors include the configuration of the operating system, application configuration or presence, and environment settings. Once installed, in-guest policies will be available such as 'Windows Exploit guard should be enabled'. Learn more at https://aka.ms/gcpol.",
            "display_name": "Guest Configuration extension should be installed on your machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ae89ebca-1c92-4898-ac2c-9f63decb045c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.3\"}",
            "mode": "Indexed",
            "name": "ae89ebca-1c92-4898-ac2c-9f63decb045c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\",\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"dsvm-windows\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.GuestConfiguration\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/af35e2a4-ef96-44e7-a9ae-853dd97032c4",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Spring Cloud instances should use virtual network injection for the following purposes: 1. Isolate Azure Spring Cloud from Internet. 2. Enable Azure Spring Cloud to interact with systems in either on premises data centers or Azure service in other virtual networks. 3. Empower customers to control inbound and outbound network communications for Azure Spring Cloud.",
            "display_name": "Azure Spring Cloud should use network injection",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/af35e2a4-ef96-44e7-a9ae-853dd97032c4",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Platform\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "af35e2a4-ef96-44e7-a9ae-853dd97032c4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"evaluatedSkuNames\":{\"type\":\"Array\",\"allowedValues\":[\"Standard\",\"Enterprise\"],\"defaultValue\":[\"Standard\",\"Enterprise\"],\"metadata\":{\"description\":\"List of Azure Spring Cloud SKUs against which this policy will be evaluated.\",\"displayName\":\"Azure Spring Cloud SKU Names\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.AppPlatform/Spring\",\"field\":\"type\"},{\"field\":\"Microsoft.AppPlatform/Spring/sku.tier\",\"in\":\"[parameters('evaluatedSkuNames')]\"},{\"exists\":false,\"field\":\"Microsoft.AppPlatform/Spring/networkProfile.serviceRuntimeSubnetId\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/afe0c3be-ba3b-4544-ba52-0c99672a8ad6",
          "schema_version": 0,
          "attributes": {
            "description": "Resource logs enable recreating activity trails to use for investigation purposes when a security incident occurs or when your network is compromised.",
            "display_name": "Resource logs in Azure Machine Learning Workspaces should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/afe0c3be-ba3b-4544-ba52-0c99672a8ad6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "afe0c3be-ba3b-4544-ba52-0c99672a8ad6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days if exporting to an Azure Storage account\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure SignalR Service resource. Learn more at: https://aka.ms/asrs/privatelink.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints connect to Azure SignalR Service",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "management_group_name": null,
            "metadata": "{\"category\":\"SignalR\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"defaultValue\":\"privatelink.service.signalr.net\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"signalr\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-service-signalr-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a",
          "schema_version": 0,
          "attributes": {
            "description": "If a secret is too close to expiration, an organizational delay to rotate the secret may result in an outage. Secrets should be rotated at a specified number of days prior to expiration to provide sufficient time to react to a failure.",
            "display_name": "Secrets should have more than the specified number of days before expiration",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.0.1\"}",
            "mode": "Microsoft.KeyVault.Data",
            "name": "b0eb591a-5e70-4534-a8bf-04b9c489584a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\"}},\"minimumDaysBeforeExpiration\":{\"type\":\"Integer\",\"metadata\":{\"description\":\"Specify the minimum number of days that a secret should remain usable prior to expiration.\",\"displayName\":\"The minimum days before expiration\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault.Data/vaults/secrets\",\"field\":\"type\"},{\"exists\":true,\"field\":\"Microsoft.KeyVault.Data/vaults/secrets/attributes.expiresOn\"},{\"field\":\"Microsoft.KeyVault.Data/vaults/secrets/attributes.expiresOn\",\"less\":\"[addDays(utcNow(), parameters('minimumDaysBeforeExpiration'))]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
          "schema_version": 0,
          "attributes": {
            "description": "Possible network Just In Time (JIT) access will be monitored by Azure Security Center as recommendations",
            "display_name": "Management ports of virtual machines should be protected with just-in-time network access control",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "b0f33259-77d7-4c9e-aac6-3aabcfae693c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"805651bc-6ecd-4c73-9b55-97a19d0582d0\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
          "schema_version": 0,
          "attributes": {
            "description": "To improve the security of Storage Accounts, ensure that they aren't exposed to the public internet and can only be accessed from a private endpoint. Disable the public network access property as described in https://aka.ms/storageaccountpublicnetworkaccess. This option disables access from any public address space outside the Azure IP range, and denies all logins that match IP or virtual network-based firewall rules. This reduces data leakage risks.",
            "display_name": "Storage accounts should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "b2982f36-99f2-4db5-8eff-283140c09693",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Storage/storageAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links a virtual network to an App Service. Learn more at: https://docs.microsoft.com/azure/app-service/networking/private-endpoint#dns.",
            "display_name": "Configure App Service apps to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "b318f84a-b872-429b-ac6d-a01b96814452",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private Dns Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Web/sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"websites-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b3a22bc9-66de-45fb-98fa-00f5df42f41a",
          "schema_version": 0,
          "attributes": {
            "description": "Require Azure SQL logical servers to use Microsoft Entra-only authentication. This policy doesn't block servers from being created with local authentication enabled. It does block local authentication from being enabled on resources after create. Consider using the 'Microsoft Entra-only authentication' initiative instead to require both. Learn more at: https://aka.ms/adonlycreate.",
            "display_name": "Azure SQL Database should have Microsoft Entra-only authentication enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b3a22bc9-66de-45fb-98fa-00f5df42f41a",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "b3a22bc9-66de-45fb-98fa-00f5df42f41a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/azureADOnlyAuthentications\",\"field\":\"type\"},{\"notContains\":\"/providers/Microsoft.Synapse/\",\"value\":\"[resourcegroup().managedBy]\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Sql/servers/azureADOnlyAuthentications/azureADOnlyAuthentication\"},{\"equals\":false,\"field\":\"Microsoft.Sql/servers/azureADOnlyAuthentications/azureADOnlyAuthentication\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for App Service leverages the scale of the cloud, and the visibility that Azure has as a cloud provider, to monitor for common web app attacks.",
            "display_name": "Configure Azure Defender for App Service to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"AppServices\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"AppServices\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Search services should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Search\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "b4330a05-a843-4bc8-bf9a-cacce50c67f4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Media Services account. Learn more at: https://aka.ms/mediaservicesprivatelinkdocs.",
            "display_name": "Configure Azure Media Services to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
            "management_group_name": null,
            "metadata": "{\"category\":\"Media Services\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"groupId\":{\"type\":\"String\",\"allowedValues\":[\"keydelivery\",\"liveevent\",\"streamingendpoint\"],\"metadata\":{\"description\":\"The group ID of the private endpoint.\",\"displayName\":\"Private endpoint group ID\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Media Services to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for Media Services\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Media/mediaservices\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('groupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"mediaservices-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b4dec045-250a-48c2-b5cc-e0c4eec8b5b4",
          "schema_version": 0,
          "attributes": {
            "description": "Audit provisioning of a Microsoft Entra administrator for your PostgreSQL server to enable Microsoft Entra authentication. Microsoft Entra authentication enables simplified permission management and centralized identity management of database users and other Microsoft services",
            "display_name": "A Microsoft Entra administrator should be provisioned for PostgreSQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b4dec045-250a-48c2-b5cc-e0c4eec8b5b4",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "b4dec045-250a-48c2-b5cc-e0c4eec8b5b4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"type\":\"Microsoft.DBforPostgreSQL/servers/administrators\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Blob Services to stream resource logs to a Log Analytics workspace when any blob Service which is missing this diagnostic settings is created or updated.",
            "display_name": "Configure diagnostic settings for Blob Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"4.0.0\"}",
            "mode": "All",
            "name": "b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"blobServicesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts/blobServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"bool\"},\"metricsEnabled\":{\"type\":\"bool\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/blobServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
          "schema_version": 0,
          "attributes": {
            "description": "Disable the public network access property to improve security and ensure your Azure Database for PostgreSQL can only be accessed from a private endpoint. This configuration disables access from any public address space outside of Azure IP range, and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for PostgreSQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.1\"}",
            "mode": "Indexed",
            "name": "b52376f7-9612-48a1-81cd-1ffe4b61032c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0",
          "schema_version": 0,
          "attributes": {
            "description": "Audit usage of client authentication only via Azure Active Directory in Service Fabric",
            "display_name": "Service Fabric clusters should only use Azure Active Directory for client authentication",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Service Fabric\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "b54ed75b-3e1a-44ac-a333-05ba39b99ff0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ServiceFabric/clusters\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\"},{\"equals\":\"\",\"field\":\"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
          "schema_version": 0,
          "attributes": {
            "description": "Network Watcher is a regional service that enables you to monitor and diagnose conditions at a network scenario level in, to, and from Azure. Scenario level monitoring enables you to diagnose problems at an end to end network level view. It is required to have a network watcher resource group to be created in every region where a virtual network is present. An alert is enabled if a network watcher resource group is not available in a particular region.",
            "display_name": "Network Watcher should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfLocations\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"deprecated\":true,\"description\":\"Audit if Network Watcher is not enabled for region(s).\",\"displayName\":\"[Deprecated]: Locations\",\"strongType\":\"location\"}},\"resourceGroupName\":{\"type\":\"String\",\"defaultValue\":\"NetworkWatcherRG\",\"metadata\":{\"description\":\"Name of the resource group of NetworkWatcher, such as NetworkWatcherRG. This is the resource group where the Network Watchers are located.\",\"displayName\":\"NetworkWatcher resource group name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"[field('location')]\",\"field\":\"location\"},\"resourceGroupName\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Network/networkWatchers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Resource Manager automatically monitors the resource management operations in your organization. Azure Defender detects threats and alerts you about suspicious activity. Learn more about the capabilities of Azure Defender for Resource Manager at https://aka.ms/defender-for-resource-manager . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .",
            "display_name": "Configure Azure Defender for Resource Manager to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"subPlan\":{\"type\":\"String\",\"allowedValues\":[\"PerSubscription\",\"PerApiCall\"],\"defaultValue\":\"PerApiCall\",\"metadata\":{\"description\":\"Select a Defender for Resource Manager plan\",\"displayName\":\"Defender for Resource Manager plans\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"subPlan\":{\"value\":\"[parameters('subPlan')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"subPlan\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"Arm\",\"properties\":{\"pricingTier\":\"Standard\",\"subPlan\":\"[parameters('subPlan')]\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},{\"equals\":\"[parameters('subPlan')]\",\"field\":\"Microsoft.Security/pricings/subPlan\"}]},\"existenceScope\":\"subscription\",\"name\":\"Arm\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4",
          "schema_version": 0,
          "attributes": {
            "description": "The direct management REST API in Azure API Management bypasses Azure Resource Manager role-based access control, authorization, and throttling mechanisms, thus increasing the vulnerability of your service.",
            "display_name": "API Management direct management endpoint should not be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "b741306c-968e-4b67-b916-5675e5c709f4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service/tenant\",\"field\":\"type\"},{\"equals\":true,\"field\":\"Microsoft.ApiManagement/service/tenant/enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Databases to stream resource logs to a Log Analytics workspace when any SQL Database which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy - Configure diagnostic settings for SQL Databases to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"4.0.0\"}",
            "mode": "Indexed",
            "name": "b79fa14e-238a-4c2d-b376-442ce508fc84",
            "parameters": "{\"AutomaticTuningEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AutomaticTuning logs to the Log Analytics workspace - True or False\",\"displayName\":\"AutomaticTuning - Enabled\"}},\"Basic\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Basic metrics to the Log Analytics workspace - True or False\",\"displayName\":\"Basic (metric) - Enabled\"}},\"BlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Blocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Blocks - Enabled\"}},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream DatabaseWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"DatabaseWaitStatistics - Enabled\"}},\"DeadlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Deadlocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Deadlocks - Enabled\"}},\"ErrorsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Errors logs to the Log Analytics workspace - True or False\",\"displayName\":\"Errors - Enabled\"}},\"InstanceAndAppAdvanced\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream InstanceAndAppAdvanced metrics to the Log Analytics workspace - True or False\",\"displayName\":\"InstanceAndAppAdvanced (metric) - Enabled\"}},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreRuntimeStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreRuntimeStatistics - Enabled\"}},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreWaitStatistics - Enabled\"}},\"SQLInsightsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLInsights logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLInsights - Enabled\"}},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLSecurityAuditEvents logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLSecurityAuditEvents - Enabled\"}},\"TimeoutsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Timeouts logs to the Log Analytics workspace - True or False\",\"displayName\":\"Timeouts - Enabled\"}},\"WorkloadManagement\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream WorkloadManagement metrics to the Log Analytics workspace - True or False\",\"displayName\":\"WorkloadManagement (metric) - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"SQLDatabaseDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select the Log Analytics workspace from dropdown list\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notEquals\":\"master\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AutomaticTuningEnabled\":{\"value\":\"[parameters('AutomaticTuningEnabled')]\"},\"Basic\":{\"value\":\"[parameters('Basic')]\"},\"BlocksEnabled\":{\"value\":\"[parameters('BlocksEnabled')]\"},\"DatabaseWaitStatisticsEnabled\":{\"value\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},\"DeadlocksEnabled\":{\"value\":\"[parameters('DeadlocksEnabled')]\"},\"ErrorsEnabled\":{\"value\":\"[parameters('ErrorsEnabled')]\"},\"InstanceAndAppAdvanced\":{\"value\":\"[parameters('InstanceAndAppAdvanced')]\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},\"QueryStoreWaitStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},\"SQLInsightsEnabled\":{\"value\":\"[parameters('SQLInsightsEnabled')]\"},\"SQLSecurityAuditEventsEnabled\":{\"value\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"},\"TimeoutsEnabled\":{\"value\":\"[parameters('TimeoutsEnabled')]\"},\"WorkloadManagement\":{\"value\":\"[parameters('WorkloadManagement')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AutomaticTuningEnabled\":{\"type\":\"string\"},\"Basic\":{\"type\":\"string\"},\"BlocksEnabled\":{\"type\":\"string\"},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"string\"},\"DeadlocksEnabled\":{\"type\":\"string\"},\"ErrorsEnabled\":{\"type\":\"string\"},\"InstanceAndAppAdvanced\":{\"type\":\"string\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"string\"},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"string\"},\"SQLInsightsEnabled\":{\"type\":\"string\"},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"string\"},\"TimeoutsEnabled\":{\"type\":\"string\"},\"WorkloadManagement\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"SQLInsights\",\"enabled\":\"[parameters('SQLInsightsEnabled')]\"},{\"category\":\"AutomaticTuning\",\"enabled\":\"[parameters('AutomaticTuningEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},{\"category\":\"Errors\",\"enabled\":\"[parameters('ErrorsEnabled')]\"},{\"category\":\"DatabaseWaitStatistics\",\"enabled\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},{\"category\":\"Timeouts\",\"enabled\":\"[parameters('TimeoutsEnabled')]\"},{\"category\":\"Blocks\",\"enabled\":\"[parameters('BlocksEnabled')]\"},{\"category\":\"Deadlocks\",\"enabled\":\"[parameters('DeadlocksEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"}],\"metrics\":[{\"category\":\"Basic\",\"enabled\":\"[parameters('Basic')]\"},{\"category\":\"InstanceAndAppAdvanced\",\"enabled\":\"[parameters('InstanceAndAppAdvanced')]\"},{\"category\":\"WorkloadManagement\",\"enabled\":\"[parameters('WorkloadManagement')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/databases/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"SQLInsights\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLInsightsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"AutomaticTuning\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('AutomaticTuningEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreRuntimeStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Errors\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('ErrorsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"DatabaseWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DatabaseWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Timeouts\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('TimeoutsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Blocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('BlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Deadlocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DeadlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"SQLSecurityAuditEvents\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLSecurityAuditEventsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]}]}},\"equals\":10},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Basic\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('Basic')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"InstanceAndAppAdvanced\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('InstanceAndAppAdvanced')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"WorkloadManagement\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('WorkloadManagement')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}]}},\"equals\":3}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Logic Apps to stream to a regional Log Analytics workspace when any Logic Apps which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Logic Apps to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "b889a06c-ec72-4b03-910a-cb169ee18721",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/workflows\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"WorkflowRuntime\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/workflows/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Configure Azure Defender for Azure SQL database to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "b99b73e7-074b-4089-9395-b7236f094491",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"SqlServers\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServers\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
          "schema_version": 0,
          "attributes": {
            "description": "Manage encryption at rest of Azure Machine Learning workspace data with customer-managed keys. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/azureml-workspaces-cmk.",
            "display_name": "Azure Machine Learning workspaces should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"not\":{\"equals\":\"project\",\"field\":\"kind\"}},{\"not\":{\"equals\":\"enabled\",\"field\":\"Microsoft.MachineLearningServices/workspaces/encryption.status\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid topics to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "baf19753-7502-405f-8745-370519b20483",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"topic\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"topic-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your non-internet-facing virtual machines from potential threats by restricting access with network security groups (NSG). Learn more about controlling traffic with NSGs at https://aka.ms/nsg-doc",
            "display_name": "Non-internet-facing virtual machines should be protected with network security groups",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "bb91dfba-c30d-4263-9add-9c2384e659a6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"a9341235-9389-42f0-a0bf-9bfb57960d44\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to a managed disk. Learn more at: https://aka.ms/disksprivatelinksdoc.",
            "display_name": "Configure disk access resources to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for managed disks to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for managed disks\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Compute/diskAccesses\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"disks\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"diskAccess-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a queue groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for queue groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "bcff79fb-2b0d-47c9-97e5-3023479b00d1",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a blob groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for queue groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"queue\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744",
          "schema_version": 0,
          "attributes": {
            "description": "Enabling IP forwarding on a virtual machine's NIC allows the machine to receive traffic addressed to other destinations. IP forwarding is rarely required (e.g., when using the VM as a network virtual appliance), and therefore, this should be reviewed by the network security team.",
            "display_name": "IP Forwarding on your virtual machine should be disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "bd352bd5-2853-4985-bf0d-73806b4a5744",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"c3b51c94-588b-426b-a892-24696f9e54cc\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bd876905-5b84-4f73-ab2d-2e7a7c4568d9",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure periodic assessments for missing system updates are triggered automatically every 24 hours, the AssessmentMode property should be set to 'AutomaticByPlatform'. Learn more about AssessmentMode property for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
            "display_name": "Machines should be configured to periodically check for missing system updates",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bd876905-5b84-4f73-ab2d-2e7a7c4568d9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Update Manager\",\"version\":\"3.7.0\"}",
            "mode": "Indexed",
            "name": "bd876905-5b84-4f73-ab2d-2e7a7c4568d9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Policy Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.HybridCompute/machines\"]},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"anyOf\":[{\"contains\":\"Microsoft.Compute/galleries\",\"value\":\"[field('Microsoft.Compute/imageId')]\"},{\"contains\":\"Microsoft.Compute/images\",\"value\":\"[field('Microsoft.Compute/imageId')]\"}]},{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.computerName\"}]},{\"allOf\":[{\"anyOf\":[{\"contains\":\"Microsoft.Compute/galleries\",\"value\":\"[field('Microsoft.Compute/imageId')]\"},{\"contains\":\"Microsoft.Compute/images\",\"value\":\"[field('Microsoft.Compute/imageId')]\"},{\"equals\":\"Attach\",\"value\":\"[field('Microsoft.Compute/virtualMachines/storageProfile.osDisk.createOption')]\"}]},{\"exists\":\"false\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.computerName\"},{\"greaterOrEquals\":\"2023-07-01\",\"value\":\"[requestContext().apiVersion]\"}]},{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"allOf\":[{\"equals\":\"microsoftcblmariner\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cbl-mariner\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"cbl-mariner-1\",\"1-gen2\",\"cbl-mariner-2\",\"cbl-mariner-2-gen2\"]}]},{\"allOf\":[{\"equals\":\"oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"oracle-linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"8\",\"8-ci\",\"81\",\"81-ci\",\"81-gen2\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"ol7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"ol8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"ol9*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"ol9-lvm*\"}]}]},{\"allOf\":[{\"equals\":\"oracle-database\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"oracle_db_21\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"oracle-database-*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.*\"}]},{\"allOf\":[{\"equals\":\"oracle-database-19-3\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"oracle-database-19-0904\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"microsoft-aks\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"aks\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"aks-engine-ubuntu-1804-202112\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"aml-workstation\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"ubuntu-20\",\"ubuntu-20-gen2\"]}]},{\"allOf\":[{\"equals\":\"Redhat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"RHEL\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"notEquals\":\"74-gen2\"}]},{\"allOf\":[{\"equals\":\"RHEL-RAW\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"rhel-sap-ha\"]},{\"anyOf\":[{\"equals\":\"90sapha-gen2\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"notEquals\":\"7.5\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"rhel-sap-apps\"]},{\"anyOf\":[{\"equals\":\"90sapha-gen2\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"rhel-sap-*\"},{\"equals\":\"9_0\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"rhel-ha\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notIn\":[\"7.4\",\"7.5\",\"7.6\",\"8.1\",\"81_gen2\"]}]},{\"allOf\":[{\"equals\":\"rhel-sap\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notIn\":[\"7.4\",\"7.5\",\"7.7\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"allOf\":[{\"anyOf\":[{\"allOf\":[{\"equals\":\"Centos\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"8*\"}]},{\"allOf\":[{\"equals\":\"centos-lvm\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"7-lvm\",\"8-lvm\",\"7-lvm-gen2\"]}]},{\"allOf\":[{\"equals\":\"centos-ci\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"7-ci\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]},{\"field\":\"Microsoft.Compute/imageOffer\",\"notEquals\":\"centos-hpc\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"sles-12-sp5\",\"sles-15-sp2\",\"sle-hpc-15-sp4\",\"sles-15-sp1-sapcal\",\"sles-15-sp3-sapcal\",\"sles-15-sp4-basic\",\"sles-15-sp4\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"sles\",\"sles-standard\"]},{\"equals\":\"12-sp4-gen2\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"sles-15-sp2-basic\",\"sles-15-sp2-hpc\"]},{\"equals\":\"gen2\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"sles-15-sp4-sapcal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"sles-byos\",\"sles-sap\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-sp4\",\"12-sp4-gen2\"]}]},{\"allOf\":[{\"equals\":\"sles-sap-byos\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-sp4\",\"12-sp4-gen2\",\"gen2-12-sp4\"]}]},{\"allOf\":[{\"equals\":\"sles-sapcal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"12-sp3\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"gen*\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"opensuse-leap-15-*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5-*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-12-sp5*\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"sles-sap-15-*-byos\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"windowsserver\",\"windows-cvm\",\"windowsserverdotnet\",\"windowsserver-gen2preview\",\"windowsserversemiannual\",\"windowsserverupgrade\"]},{\"allOf\":[{\"equals\":\"microsoftserveroperatingsystems-previews\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"windows-server-vnext-azure-edition-core\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"windowsserverhotpatch-previews\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"windows-server-2022-azure-edition-hotpatch\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"sql2019-sles*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notIn\":[\"sql2019-rhel7\",\"sql2017-rhel7\"]}]},{\"allOf\":[{\"equals\":\"microsoftdynamicsax\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"microsoftazuresiterecovery\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"process-server\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"windows-2012-r2-datacenter\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoftbiztalkserver\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"biztalk-server\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"equals\":\"microsoftpowerbi\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"allOf\":[{\"equals\":\"microsoftsharepoint\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"microsoftsharepointserver\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"microsoftwindowsserverhpcpack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windowsserverhpcpack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"microsoftvisualstudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"visualstudio*\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*-ws2012r2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*-ws2016\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*-ws2019\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*-ws2022\"}]}]}]},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"microsoft-ads\"},{\"notEquals\":\"AutomaticByPlatform\",\"value\":\"[if(equals(tolower(field('Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType')), 'windows'), field('Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration.patchSettings.assessmentMode'), field('Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration.patchSettings.assessmentMode'))]\"}]},{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"notEquals\":\"AutomaticByPlatform\",\"value\":\"[if(equals(tolower(field('Microsoft.HybridCompute/machines/osName')), 'windows'), field('Microsoft.HybridCompute/machines/osProfile.windowsConfiguration.patchSettings.assessmentMode'), field('Microsoft.HybridCompute/machines/osProfile.linuxConfiguration.patchSettings.assessmentMode'))]\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bed48b13-6647-468e-aa2f-1af1d3f4dd40",
          "schema_version": 0,
          "attributes": {
            "description": "Windows Defender Exploit Guard uses the Azure Policy Guest Configuration agent. Exploit Guard has four components that are designed to lock down devices against a wide variety of attack vectors and block behaviors commonly used in malware attacks while enabling enterprises to balance their security risk and productivity requirements (Windows only).",
            "display_name": "Windows Defender Exploit Guard should be enabled on your machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bed48b13-6647-468e-aa2f-1af1d3f4dd40",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"NotAvailableMachineState\":\"[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\"},\"name\":\"WindowsDefenderExploitGuard\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "bed48b13-6647-468e-aa2f-1af1d3f4dd40",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"NotAvailableMachineState\":{\"type\":\"String\",\"allowedValues\":[\"Compliant\",\"Non-Compliant\"],\"defaultValue\":\"Compliant\",\"metadata\":{\"description\":\"Windows Defender Exploit Guard is only available starting with Windows 10/Windows Server with update 1709. Setting this value to 'Non-Compliant' shows machines with older versions on which Windows Defender Exploit Guard is not available (such as Windows Server 2012 R2) as non-compliant. Setting this value to 'Compliant' shows these machines as compliant.\",\"displayName\":\"Status if Windows Defender is not available on machine\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState', '=', parameters('NotAvailableMachineState')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"WindowsDefenderExploitGuard\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Key Vault to stream to a regional Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Key Vault to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"matchWorkspace\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to require that the workspace of the diagnostic settings matches the workspace deployed by this policy\",\"displayName\":\"Workspace id must match\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzurePolicyEvaluationDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.KeyVault/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"AuditEvent\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greaterOrEquals\":1},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}},\"greaterOrEquals\":1},{\"anyOf\":[{\"equals\":false,\"value\":\"[parameters('matchWorkspace')]\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
          "schema_version": 0,
          "attributes": {
            "description": "Calls from API Management to backends should use some form of authentication, whether via certificates or credentials. Does not apply to Service Fabric backends.",
            "display_name": "API Management calls to API backends should be authenticated",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "c15dcc82-b93c-4dcb-9332-fbf121685b54",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service/backends\",\"field\":\"type\"},{\"exists\":\"true\",\"field\":\"Microsoft.ApiManagement/service/backends/url\"},{\"equals\":\"http\",\"field\":\"Microsoft.ApiManagement/service/backends/protocol\"},{\"allOf\":[{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.ApiManagement/service/backends/credentials.certificate\"},{\"equals\":0,\"value\":\"[length(field('Microsoft.ApiManagement/service/backends/credentials.certificate[*]'))]\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.ApiManagement/service/backends/credentials.authorization.scheme\"},{\"exists\":\"false\",\"field\":\"Microsoft.ApiManagement/service/backends/credentials.authorization.parameter\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
          "schema_version": 0,
          "attributes": {
            "description": "Restrict the capabilities to reduce the attack surface of containers in a Kubernetes cluster. This recommendation is part of CIS 5.2.8 and CIS 5.2.9 which are intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster containers should only use allowed capabilities",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"6.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
            "parameters": "{\"allowedCapabilities\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of capabilities that are allowed to be added to a container. Provide empty list as input to block everything.\",\"displayName\":\"Allowed capabilities\",\"portalReview\":true}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"requiredDropCapabilities\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of capabilities that must be dropped by a container.\",\"displayName\":\"Required drop capabilities\",\"portalReview\":true}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/container-allowed-capabilities/v3/template.yaml\"},\"values\":{\"allowedCapabilities\":\"[parameters('allowedCapabilities')]\",\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\",\"requiredDropCapabilities\":\"[parameters('requiredDropCapabilities')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c3d20c29-b36d-48fe-808b-99a87530ad99",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Resource Manager automatically monitors the resource management operations in your organization. Azure Defender detects threats and alerts you about suspicious activity. Learn more about the capabilities of Azure Defender for Resource Manager at https://aka.ms/defender-for-resource-manager . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .",
            "display_name": "Azure Defender for Resource Manager should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c3d20c29-b36d-48fe-808b-99a87530ad99",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "c3d20c29-b36d-48fe-808b-99a87530ad99",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Arm\",\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Cognitive Services accounts. Learn more at: https://go.microsoft.com/fwlink/?linkid=2110097.",
            "display_name": "Configure Cognitive Services accounts to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Cognitive Services to resolve a private DNS Zone to your Cognitive Services account.\",\"displayName\":\"Private DNS Zone ID for Cognitive Services account\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"account\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-cognitiveservices-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Defender on your Azure SQL Managed Instances to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Azure Defender to be enabled on SQL managed instances",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"instanceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"instanceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-11-01-preview\",\"name\":\"[concat(parameters('instanceName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.Sql/managedInstances/securityAlertPolicies\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/managedInstances/securityAlertPolicies/state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/managedInstances/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c6283572-73bb-4deb-bf2c-7a2b8f7462cb",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure your SQL VMs and Arc-enabled SQL Servers are protected, ensure the SQL-targeted Azure Monitoring Agent is configured to automatically deploy. This is also necessary if you've previously configured autoprovisioning of the Microsoft Monitoring Agent, as that component is being deprecated. Learn more: https://aka.ms/SQLAMAMigration",
            "display_name": "SQL server-targeted autoprovisioning should be enabled for SQL servers on machines plan",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c6283572-73bb-4deb-bf2c-7a2b8f7462cb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "c6283572-73bb-4deb-bf2c-7a2b8f7462cb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Security/pricings\",\"field\":\"type\"},{\"equals\":\"sqlservervirtualmachines\",\"field\":\"name\"},{\"equals\":\"standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"anyOf\":[{\"equals\":\"/providers/Microsoft.Authorization/policySetDefinitions/de01d381-bae9-4670-8870-786f89f49e26\",\"field\":\"Microsoft.Authorization/policyAssignments/policyDefinitionId\"},{\"equals\":\"/providers/Microsoft.Authorization/policySetDefinitions/d7c3ea3a-edf3-4bd5-bd64-d5b635b05393\",\"field\":\"Microsoft.Authorization/policyAssignments/policyDefinitionId\"}]},\"type\":\"Microsoft.Authorization/policyAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Diagnostic Settings for Recovery Services Vault to stream to Log Analytics workspace for Resource specific categories. If any of the Resource specific categories are not enabled, a new diagnostic setting is created.",
            "display_name": "Deploy Diagnostic Settings for Recovery Services Vault to Log Analytics workspace for resource specific categories.",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "parameters": "{\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}},\"tagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Value parameter.\",\"displayName\":\"Exclusion Tag Name\"}},\"tagValue\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Value of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Name parameter.\",\"displayName\":\"Exclusion Tag Value\"}}}",
            "policy_rule": "{\"if\":{\"allof\":[{\"equals\":\"Microsoft.RecoveryServices/vaults\",\"field\":\"type\"},{\"not\":{\"equals\":\"[parameters('tagValue')]\",\"field\":\"[concat('tags[',parameters('tagName'), ']')]\"}}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"vaultName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"vaultName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"Dedicated\",\"logs\":[{\"category\":\"CoreAzureBackup\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupAlerts\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupJobs\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupPolicy\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupProtectedInstance\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupStorage\",\"enabled\":\"true\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.RecoveryServices/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allof\":[{\"Equals\":6,\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allof\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Category\",\"in\":[\"CoreAzureBackup\",\"AddonAzureBackupJobs\",\"AddonAzureBackupAlerts\",\"AddonAzureBackupPolicy\",\"AddonAzureBackupStorage\",\"AddonAzureBackupProtectedInstance\"]},{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Enabled\"}]}}},{\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\",\"notEquals\":\"\"},{\"equals\":\"Dedicated\",\"field\":\"Microsoft.Insights/diagnosticSettings/logAnalyticsDestinationType\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Batch Account to stream to a regional Log Analytics workspace when any Batch Account which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Batch Account to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "c84e5349-db6d-4769-805e-e14037dab9b5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ServiceLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AuditLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Batch/batchAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c8acafaf-3d23-44d1-9624-978ef0f8652c",
          "schema_version": 0,
          "attributes": {
            "description": "As a security best practice, API endpoints that haven't received traffic for 30 days are considered unused and should be removed from the Azure API Management service. Keeping unused API endpoints may pose a security risk to your organization. These may be APIs that should have been deprecated from the Azure API Management service but may have been accidentally left active. Such APIs typically do not receive the most up to date security coverage.",
            "display_name": "API endpoints that are unused should be disabled and removed from the Azure API Management service",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c8acafaf-3d23-44d1-9624-978ef0f8652c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "c8acafaf-3d23-44d1-9624-978ef0f8652c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ApiManagement/service/apis/operations\",\"field\":\"type\"},\"then\":{\"details\":{\"existencecondition\":{\"field\":\"microsoft.security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"4e8c00a2-e8bc-42a8-9e12-99584a51ad10\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for MySQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for MySQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.2.0\"}",
            "mode": "Indexed",
            "name": "c9299215-ae47-4f50-9c54-8a392f68a052",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/flexibleServers\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.privateDnsZoneResourceId\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Create\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/createMode\"},{\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},{\"allOf\":[{\"equals\":\"PointInTimeRestore\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/createMode\"},{\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},{\"allOf\":[{\"equals\":\"GeoRestore\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/createMode\"},{\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},{\"allOf\":[{\"equals\":\"Replica\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/createMode\"},{\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},{\"allOf\":[{\"field\":\"Microsoft.DBforMySQL/flexibleServers/createMode\",\"notEquals\":\"Create\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.publicNetworkAccess\"},{\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Data Lake Analytics should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Lake\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "c95c74d9-38fe-4f0d-af86-0c7d626a315c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private DNS provides a reliable, secure DNS service to manage and resolve domain names in a virtual network without the need to add a custom DNS solution. You can use private DNS zones to override the DNS resolution by using your own custom domain names for a private endpoint. This policy deploys a private DNS Zone for IoT Hub private endpoints.",
            "display_name": "Deploy - Configure Azure IoT Hubs to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotHub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.",
            "display_name": "Configure Microsoft Defender for Containers to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "c9ddb292-b203-4738-aead-18e2716e858f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"Containers\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Containers\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ca610c1d-041c-4332-9d88-7ed3094967c7",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your app configuration instances instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/appconfig/private-endpoint.",
            "display_name": "App Configuration should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ca610c1d-041c-4332-9d88-7ed3094967c7",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Configuration\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "ca610c1d-041c-4332-9d88-7ed3094967c7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.AppConfiguration/configurationStores\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Approved\",\"field\":\"Microsoft.AppConfiguration/configurationStores/privateEndpointConnections/privateLinkServiceConnectionState.status\"},\"type\":\"Microsoft.AppConfiguration/configurationStores/privateEndpointConnections\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ca88aadc-6e2b-416c-9de2-5a0f01d1693f",
          "schema_version": 0,
          "attributes": {
            "description": "Although a virtual machine's OS and data disks are encrypted-at-rest by default using platform managed keys; resource disks (temp disks), data caches, and data flowing between Compute and Storage resources are not encrypted. Use Azure Disk Encryption or EncryptionAtHost to remediate. Visit https://aka.ms/diskencryptioncomparison to compare encryption offerings. This policy requires two prerequisites to be deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Linux virtual machines should enable Azure Disk Encryption or EncryptionAtHost.",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ca88aadc-6e2b-416c-9de2-5a0f01d1693f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureLinuxVMEncryptionCompliance\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"1.2.1\"}",
            "mode": "Indexed",
            "name": "ca88aadc-6e2b-416c-9de2-5a0f01d1693f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.securityType\",\"notEquals\":\"ConfidentialVM\"},{\"field\":\"Microsoft.Compute/virtualMachines/additionalCapabilities.ultraSSDEnabled\",\"notEquals\":\"true\"},{\"field\":\"Microsoft.Compute/virtualMachines/sku.name\",\"notIn\":[\"standard_a0\",\"standard_a1\",\"basic_a0\",\"basic_a1\",\"basic_a2\",\"basic_a3\",\"basic_a4\"]},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"microsoft-aks\",\"AzureDatabricks\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"aks*\"}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-win*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"azureopenshift\"]}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureLinuxVMEncryptionCompliance\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
          "schema_version": 0,
          "attributes": {
            "description": "Remote debugging requires inbound ports to be opened on an App Service app. Remote debugging should be turned off.",
            "display_name": "App Service apps should have remote debugging turned off",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/config/web.remoteDebuggingEnabled\"},\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/cddd188c-4b82-4c48-a19d-ddf74ee66a01",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Cognitive Services, you'll reduce the potential for data leakage. Learn more about private links at: https://go.microsoft.com/fwlink/?linkid=2129800.",
            "display_name": "[Deprecated]: Cognitive Services should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/cddd188c-4b82-4c48-a19d-ddf74ee66a01",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"deprecated\":true,\"version\":\"3.0.1-deprecated\"}",
            "mode": "Indexed",
            "name": "cddd188c-4b82-4c48-a19d-ddf74ee66a01",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.CognitiveServices/accounts/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.CognitiveServices/accounts/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Key Vault should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "cf820ca0-f99e-4f3e-84fb-66e913812d21",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
          "schema_version": 0,
          "attributes": {
            "description": "Azure container registries by default accept connections over the internet from hosts on any network. To protect your registries from potential threats, allow access from only specific private endpoints, public IP addresses or address ranges. If your registry doesn't have network rules configured, it will appear in the unhealthy resources. Learn more about Container Registry network rules here: https://aka.ms/acr/privatelink, https://aka.ms/acr/portal/public-network and https://aka.ms/acr/vnet.",
            "display_name": "Container registries should not allow unrestricted network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "d0793b48-0edc-4296-a390-4c75d1bdfd71",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"allOf\":[{\"anyof\":[{\"exists\":\"false\",\"field\":\"Microsoft.ContainerRegistry/registries/networkRuleSet.defaultAction\"},{\"equals\":\"Allow\",\"field\":\"Microsoft.ContainerRegistry/registries/networkRuleSet.defaultAction\"}]},{\"anyof\":[{\"exists\":\"false\",\"field\":\"Microsoft.ContainerRegistry/registries/publicNetworkAccess\"},{\"equals\":\"Enabled\",\"field\":\"Microsoft.ContainerRegistry/registries/publicNetworkAccess\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d158790f-bfb0-486c-8631-2dc6b4e8e6af",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Enforce SSL connection should be enabled for PostgreSQL database servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d158790f-bfb0-486c-8631-2dc6b4e8e6af",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "d158790f-bfb0-486c-8631-2dc6b4e8e6af",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a web_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for web_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "d19ae5f1-b303-4b82-9ca8-7682749faf0c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a web_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for web_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"web_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d26f7642-7545-4e18-9b75-8c9bbdee3a9a",
          "schema_version": 0,
          "attributes": {
            "description": "The Guest Configuration extension requires a system assigned managed identity. Azure virtual machines in the scope of this policy will be non-compliant when they have the Guest Configuration extension installed but do not have a system assigned managed identity. Learn more at https://aka.ms/gcpol",
            "display_name": "Virtual machines' Guest Configuration extension should be deployed with system-assigned managed identity",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d26f7642-7545-4e18-9b75-8c9bbdee3a9a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "d26f7642-7545-4e18-9b75-8c9bbdee3a9a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines/extensions\",\"field\":\"type\"},{\"equals\":\"Microsoft.GuestConfiguration\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"contains\":\"SystemAssigned\",\"field\":\"identity.type\"},\"name\":\"[first(split(field('fullName'), '/'))]\",\"type\":\"Microsoft.Compute/virtualMachines\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d2e7ea85-6b44-4317-a0be-1b951587f626",
          "schema_version": 0,
          "attributes": {
            "description": "To reduce the attack surface of your containers, restrict CAP_SYS_ADMIN Linux capabilities. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should not grant CAP_SYS_ADMIN security capabilities",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d2e7ea85-6b44-4317-a0be-1b951587f626",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"5.1.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "d2e7ea85-6b44-4317-a0be-1b951587f626",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/container-disallowed-capabilities/v3/template.yaml\"},\"values\":{\"disallowedCapabilities\":[\"SYS_ADMIN\"],\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\"}},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d30025d0-6d64-656d-6465-67688881b632",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys Microsoft Defender for Endpoint agent on applicable Linux VM images.",
            "display_name": "[Preview]: Deploy Microsoft Defender for Endpoint agent on Linux virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d30025d0-6d64-656d-6465-67688881b632",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"3.0.0-preview\"}",
            "mode": "Indexed",
            "name": "d30025d0-6d64-656d-6465-67688881b632",
            "parameters": "{\"ImageIdsToExclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoImage'\",\"displayName\":\"Optional: List of virtual machine images to exclude\"}},\"PublishersToExclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Linux image Publishers to exclude from MDE provision\",\"displayName\":\"Optional: List Of Image Publishers to exclude\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"linux*\"},{\"anyOf\":[{\"not\":{\"field\":\"Microsoft.Compute/virtualMachines/imagePublisher\",\"in\":\"[parameters('PublishersToExclude')]\"}},{\"equals\":\"true\",\"value\":\"[empty(parameters('PublishersToExclude'))]\"}]},{\"anyOf\":[{\"not\":{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.imageReference.id\",\"in\":\"[parameters('ImageIdsToExclude')]\"}},{\"equals\":\"true\",\"value\":\"[empty(parameters('ImageIdsToExclude'))]\"}]},{\"allOf\":[{\"not\":{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"AzureDatabricks\",\"azureopenshift\",\"cisco\",\"fortinet\",\"juniper-networks\",\"barracudanetworks\",\"checkpoint\",\"imperva\",\"qualysguard\",\"f5-networks\",\"paloaltonetworks\",\"rohdeschwarzcybersecuritysas\",\"sonicwall-inc\",\"esdenera\",\"brocade_communications\",\"5nine-software-inc\",\"forcepoint-llc\",\"hillstone-networks\",\"netgate\",\"microsoft-aks\"]}},{\"not\":{\"contains\":\"firewall\",\"field\":\"Microsoft.Compute/imageOffer\"}},{\"not\":{\"Like\":\"centos-6*\",\"field\":\"Microsoft.Compute/imageSKU\"}},{\"not\":{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"contains\":\"6\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"equals\":\"CentOS\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"Like\":\"6*\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"Like\":\"RHEL\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"Like\":\"6*\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"Like\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"Like\":\"12*\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"Like\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"Like\":\"14*\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"Like\":\"RightImage-Ubuntu\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"Like\":\"14*\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"Like\":\"RightImage-Ubuntu\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"Like\":\"12*\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"Like\":\"Debian*\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"Like\":\"8*\",\"field\":\"Microsoft.Compute/imageSKU\"}]}},{\"not\":{\"allOf\":[{\"Like\":\"Oracle-Linux*\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"contains\":\"6\",\"field\":\"Microsoft.Compute/imageSKU\"}]}}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"azureResourceId\":{\"value\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/',field('name'))]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"azureResourceId\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/MDE.Linux')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"defenderForEndpointOnboardingScript\":\"[reference(subscriptionResourceId('Microsoft.Security/mdeOnboardings', 'Linux'), '2021-10-01-preview', 'full').properties.onboardingPackageLinux]\"},\"publisher\":\"Microsoft.Azure.AzureDefenderForServers\",\"settings\":{\"azureResourceId\":\"[parameters('azureResourceId')]\",\"installedBy\":\"Policy\"},\"type\":\"MDE.Linux\",\"typeHandlerVersion\":\"1.0\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.AzureDefenderForServers\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"MDE.Linux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"name\":\"MDE.Linux\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d31e5c31-63b2-4f12-887b-e49456834fa1",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Defender for SQL to protect your Synapse workspaces. Defender for SQL monitors your Synapse SQL to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Microsoft Defender for SQL should be enabled for unprotected Synapse workspaces",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d31e5c31-63b2-4f12-887b-e49456834fa1",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "d31e5c31-63b2-4f12-887b-e49456834fa1",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Synapse/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Synapse/workspaces/securityAlertPolicies/state\"},\"name\":\"Default\",\"type\":\"Microsoft.Synapse/workspaces/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d38668f5-d155-42c7-ab3d-9b57b50f8fbf",
          "schema_version": 0,
          "attributes": {
            "description": "Audit PostgreSQL flexible servers without Advanced Data Security",
            "display_name": "Azure Defender for SQL should be enabled for unprotected PostgreSQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d38668f5-d155-42c7-ab3d-9b57b50f8fbf",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "d38668f5-d155-42c7-ab3d-9b57b50f8fbf",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleservers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/advancedThreatProtectionSettings/state\"},\"name\":\"Default\",\"type\":\"Microsoft.DBforPostgreSQL/flexibleservers/advancedThreatProtectionSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid domains to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"domain\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"domain-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d6759c02-b87f-42b7-892e-71b3f471d782",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform reduces data leakage risks by handling the connectivity between the consumer and services over the Azure backbone network. Learn more about private links at: https://aka.ms/AzurePrivateLink/Overview",
            "display_name": "Azure AI Services resources should use Azure Private Link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d6759c02-b87f-42b7-892e-71b3f471d782",
            "management_group_name": null,
            "metadata": "{\"category\":\"Azure Ai Services\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "d6759c02-b87f-42b7-892e-71b3f471d782",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.CognitiveServices/accounts/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.CognitiveServices/accounts/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},{\"allOf\":[{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Search/searchServices/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.Search/searchServices/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d69b1763-b96d-40b8-a2d9-ca31e9fd0d3e",
          "schema_version": 0,
          "attributes": {
            "description": "This policy audits Windows Azure Arc machines if the Log Analytics extension is not installed.",
            "display_name": "[Preview]: Log Analytics extension should be installed on your Windows Azure Arc machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d69b1763-b96d-40b8-a2d9-ca31e9fd0d3e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"1.0.1-preview\"}",
            "mode": "Indexed",
            "name": "d69b1763-b96d-40b8-a2d9-ca31e9fd0d3e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a blob_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for blob_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "d847d34b-9337-4e2d-99a5-767e5ac9c582",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a blob_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for blob_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"blob_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
          "schema_version": 0,
          "attributes": {
            "description": "Disable the public network access property to improve security and ensure your Azure Database for MySQL can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range, and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for MySQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "d9844e8a-1437-4aeb-a32c-0c992f056095",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMySQL/servers/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
          "schema_version": 0,
          "attributes": {
            "description": "Configure private DNS zone group to override the DNS resolution for a queue_secondary groupID private endpoint.",
            "display_name": "Configure a private DNS Zone ID for queue_secondary groupID",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Configure private DNS zone group to override the DNS resolution for a queue_secondary groupID private endpoint.\",\"displayName\":\"Configure a private DNS Zone ID for queue_secondary groupID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"queue_secondary\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/dad3a6b9-4451-492f-a95c-69efc6f3fada",
          "schema_version": 0,
          "attributes": {
            "description": "At a minimum, apply the Microsoft WDAC base policy in enforced mode on all Azure Stack HCI servers. Applied Windows Defender Application Control (WDAC) policies must be consistent across servers in the same cluster.",
            "display_name": "[Preview]: Azure Stack HCI servers should have consistently enforced application control policies",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/dad3a6b9-4451-492f-a95c-69efc6f3fada",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stack HCI\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "mode": "Indexed",
            "name": "dad3a6b9-4451-492f-a95c-69efc6f3fada",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"AuditIfNotExists\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.AzureStackHCI/clusters\",\"field\":\"type\"},{\"field\":\"Microsoft.AzureStackHCI/clusters/reportedProperties.clusterVersion\",\"greater\":\"10.0.20350\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"field\":\"Microsoft.AzureStackHCI/clusters/securitySettings/securityComplianceStatus.wdacCompliance\",\"in\":[\"Compliant\",\"Pending\"]}]},\"type\":\"Microsoft.AzureStackHCI/clusters/securitySettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Advanced Threat Protection on your non-Basic tier Azure database for PostgreSQL servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Advanced Threat Protection to be enabled on Azure database for PostgreSQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "db048e65-913c-49f9-bb5f-1084184671d3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/sku.tier\",\"notContains\":\"basic\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"emailAccountAdmins\":false,\"state\":\"Enabled\"},\"type\":\"Microsoft.DBforPostgreSQL/servers/securityAlertPolicies\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioningSuccess\",\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/servers/securityAlertPolicies/Default.state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.DBforPostgreSQL/servers/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Linux servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.0\"}",
            "mode": "Indexed",
            "name": "deacecc0-9f84-44d2-bb82-46f32d766d43",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/df49d893-a74c-421d-bc95-c663042e5b80",
          "schema_version": 0,
          "attributes": {
            "description": "Run containers with a read only root file system to protect from changes at run-time with malicious binaries being added to PATH in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster containers should run with a read only root file system",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/df49d893-a74c-421d-bc95-c663042e5b80",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"6.3.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "df49d893-a74c-421d-bc95-c663042e5b80",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/read-only-root-filesystem/v3/template.yaml\"},\"values\":{\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
          "schema_version": 0,
          "attributes": {
            "description": "To improve the security of API Management services, restrict connectivity to service configuration endpoints, like direct access management API, Git configuration management endpoint, or self-hosted gateways configuration endpoint.",
            "display_name": "API Management should disable public network access to the service configuration endpoints",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "df73bd95-24da-4a4f-96b9-4e8b94b402bd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"endpointType\":{\"type\":\"String\",\"allowedValues\":[\"Management\",\"Git\",\"Gateway Configuration\"],\"defaultValue\":\"Management\",\"metadata\":{\"description\":\"Public Endpoint Type for which to enforce the access check\",\"displayName\":\"Public Endpoint Type\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},{\"field\":\"Microsoft.ApiManagement/service/sku.name\",\"notEquals\":\"Consumption\"}]},\"then\":{\"details\":{\"evaluationDelay\":\"AfterProvisioningSuccess\",\"existenceCondition\":{\"equals\":false,\"field\":\"Microsoft.ApiManagement/service/tenant/enabled\"},\"name\":\"[if(equals(parameters('endpointType'), 'Management'), 'access', if(equals(parameters('endpointType'), 'Git'), 'gitaccess', 'gatewayaccess'))]\",\"type\":\"Microsoft.ApiManagement/service/tenant\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve to Azure Cache for Redis. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Cache for Redis to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cache\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource id of the private DNS zone\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"redisCache\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-redis-cache-windows-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e345eecc-fa47-480f-9e88-67dcc122b164",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce container CPU and memory resource limits to prevent resource exhaustion attacks in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster containers CPU and memory resource limits should not exceed the specified limits",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e345eecc-fa47-480f-9e88-67dcc122b164",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"9.3.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "e345eecc-fa47-480f-9e88-67dcc122b164",
            "parameters": "{\"cpuLimit\":{\"type\":\"String\",\"metadata\":{\"description\":\"The maximum CPU units allowed for a container. E.g. 200m. For more information, please refer https://aka.ms/k8s-policy-pod-limits\",\"displayName\":\"Max allowed CPU units\",\"portalReview\":true}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"memoryLimit\":{\"type\":\"String\",\"metadata\":{\"description\":\"The maximum memory bytes allowed for a container. E.g. 1Gi. For more information, please refer https://aka.ms/k8s-policy-pod-limits\",\"displayName\":\"Max allowed memory bytes\",\"portalReview\":true}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/container-resource-limits/v3/template.yaml\"},\"values\":{\"cpuLimit\":\"[parameters('cpuLimit')]\",\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\",\"memoryLimit\":\"[parameters('memoryLimit')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e54d2be9-5f2e-4d65-98e4-4f0e670b23d6",
          "schema_version": 0,
          "attributes": {
            "description": "This policy is deprecated because it does not complete all of the required steps to enable Defender for APIs, additional steps are required to complete onboarding available through the Defender for Cloud platform. Instead of continuing to use this policy, we recommend you enable Defender for APIs by following the steps outlined in the guide at https://learn.microsoft.com/azure/defender-for-cloud/defender-for-apis-deploy. Learn more about policy definition deprecation at aka.ms/policydefdeprecation",
            "display_name": "[Deprecated]: Configure Microsoft Defender for APIs should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e54d2be9-5f2e-4d65-98e4-4f0e670b23d6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"deprecated\":true,\"version\":\"1.0.3-deprecated\"}",
            "mode": "All",
            "name": "e54d2be9-5f2e-4d65-98e4-4f0e670b23d6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2023-01-01\",\"name\":\"Api\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Api\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.",
            "display_name": "Allowed locations",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "management_group_name": null,
            "metadata": "{\"category\":\"General\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "parameters": "{\"listOfAllowedLocations\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of locations that can be specified when deploying resources.\",\"displayName\":\"Allowed locations\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"location\",\"notIn\":\"[parameters('listOfAllowedLocations')]\"},{\"field\":\"location\",\"notEquals\":\"global\"},{\"field\":\"type\",\"notEquals\":\"Microsoft.AzureActiveDirectory/b2cDirectories\"}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your subnet from potential threats by restricting access to it with a Network Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your subnet.",
            "display_name": "Subnets should be associated with a Network Security Group",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "e71308d3-144b-4262-b144-efdc3cc90517",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"eade5b56-eefd-444f-95c8-23f29e5d93cb\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.",
            "display_name": "Allowed locations for resource groups",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
            "management_group_name": null,
            "metadata": "{\"category\":\"General\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "e765b5de-1225-4ba3-bd56-1ac6695af988",
            "parameters": "{\"listOfAllowedLocations\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of locations that resource groups can be created in.\",\"displayName\":\"Allowed locations\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions/resourceGroups\",\"field\":\"type\"},{\"field\":\"location\",\"notIn\":\"[parameters('listOfAllowedLocations')]\"}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e802a67a-daf5-4436-9ea6-f6d821dd0c5d",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Enforce SSL connection should be enabled for MySQL database servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e802a67a-daf5-4436-9ea6-f6d821dd0c5d",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "e802a67a-daf5-4436-9ea6-f6d821dd0c5d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e8eef0a8-67cf-4eb4-9386-14b0e78733d4",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network.By mapping private endpoints to your container registries instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/acr/private-link.",
            "display_name": "Container registries should use private link",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e8eef0a8-67cf-4eb4-9386-14b0e78733d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "e8eef0a8-67cf-4eb4-9386-14b0e78733d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.ContainerRegistry/registries/privateEndpointConnections[*]\",\"where\":{\"equals\":\"Approved\",\"field\":\"Microsoft.ContainerRegistry/registries/privateEndpointConnections[*].privateLinkServiceConnectionState.status\"}},\"less\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Container Registry. Learn more at: https://aka.ms/privatednszone and https://aka.ms/acr/private-link.",
            "display_name": "Configure Container registries to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"A private DNS zone id to connect to the private endpoint. It should be linked to the private endpoint's associated VNET.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"registry\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"containerRegistry-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling local authentication methods improves security by ensuring that Machine Learning Computes require Azure Active Directory identities exclusively for authentication. Learn more at: https://aka.ms/azure-ml-aad-policy.",
            "display_name": "Azure Machine Learning Computes should have local authentication methods disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"2.1.0\"}",
            "mode": "All",
            "name": "e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"ComputeInstance\",\"AmlCompute\"]},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/disableLocalAuth\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e9ac8f8e-ce22-4355-8f04-99b911d6be52",
          "schema_version": 0,
          "attributes": {
            "description": "External accounts with read privileges should be removed from your subscription in order to prevent unmonitored access.",
            "display_name": "Guest accounts with read permissions on Azure resources should be removed",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e9ac8f8e-ce22-4355-8f04-99b911d6be52",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "e9ac8f8e-ce22-4355-8f04-99b911d6be52",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"fde1c0c9-0fd2-4ecc-87b5-98956cbc1095\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Event Hub namespaces. Learn more at: https://docs.microsoft.com/azure/event-hubs/private-link-service.",
            "display_name": "Configure Event Hub namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Hub\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Machine Learning workspaces. Learn more at: https://docs.microsoft.com/azure/machine-learning/how-to-network-security-overview.",
            "display_name": "Configure Azure Machine Learning workspace to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"secondPrivateDnsZoneId\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint.\",\"displayName\":\"Second Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"amlworkspace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"},\"secondPrivateDnsZoneId\":{\"value\":\"[parameters('secondPrivateDnsZoneId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"},\"secondPrivateDnsZoneId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":\"[if(not(empty(parameters('secondPrivateDnsZoneId'))), variables('bothPrivateDnsZoneConfigs'), variables('singlePrivateDnsZoneConfigs') )]\"},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}],\"variables\":{\"bothPrivateDnsZoneConfigs\":[{\"name\":\"amlworkspace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}},{\"name\":\"amlworkspace-secondPrivateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('secondPrivateDnsZoneId')]\"}}],\"singlePrivateDnsZoneConfigs\":[{\"name\":\"amlworkspace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]}}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure security of data in transit, APIs should be available only through encrypted protocols, like HTTPS or WSS. Avoid using unsecured protocols, such as HTTP or WS.",
            "display_name": "API Management APIs should use only encrypted protocols",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"2.0.2\"}",
            "mode": "All",
            "name": "ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service/apis\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.ApiManagement/service/apis/protocols[*]\",\"where\":{\"anyOf\":[{\"equals\":\"http\",\"field\":\"Microsoft.ApiManagement/service/apis/protocols[*]\"},{\"equals\":\"ws\",\"field\":\"Microsoft.ApiManagement/service/apis/protocols[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ee8ca833-1583-4d24-837e-96c2af9488a4",
          "schema_version": 0,
          "attributes": {
            "description": "Use BitLocker to encrypt the OS and data volumes on Azure Stack HCI systems.",
            "display_name": "[Preview]: Azure Stack HCI systems should have encrypted volumes",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ee8ca833-1583-4d24-837e-96c2af9488a4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stack HCI\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "mode": "Indexed",
            "name": "ee8ca833-1583-4d24-837e-96c2af9488a4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"AuditIfNotExists\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.AzureStackHCI/clusters\",\"field\":\"type\"},{\"field\":\"Microsoft.AzureStackHCI/clusters/reportedProperties.clusterVersion\",\"greater\":\"10.0.20350\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"field\":\"Microsoft.AzureStackHCI/clusters/securitySettings/securityComplianceStatus.dataAtRestEncrypted\",\"in\":[\"Compliant\",\"Pending\"]}]},\"type\":\"Microsoft.AzureStackHCI/clusters/securitySettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9",
          "schema_version": 0,
          "attributes": {
            "description": "Audit Azure SQL servers which do not have vulnerability assessment properly configured. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.",
            "display_name": "Vulnerability assessment should be enabled on your SQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"3.0.0\"}",
            "mode": "Indexed",
            "name": "ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"exists\":\"true\",\"field\":\"Microsoft.Security/assessments/status\"},\"name\":\"82e20e14-edc5-4373-bfc4-f13121257c37\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Virtual Network deployment provides enhanced security, isolation and allows you to place your API Management service in a non-internet routable network that you control access to. These networks can then be connected to your on-premises networks using various VPN technologies, which enables access to your backend services within the network and/or on-premises. The developer portal and API gateway, can be configured to be accessible either from the Internet or only within the virtual network.",
            "display_name": "API Management services should use a virtual network",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.2\"}",
            "mode": "Indexed",
            "name": "ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"evaluatedSkuNames\":{\"type\":\"Array\",\"allowedValues\":[\"Developer\",\"Basic\",\"Standard\",\"Premium\",\"Consumption\"],\"defaultValue\":[\"Developer\",\"Premium\"],\"metadata\":{\"description\":\"List of API Management SKUs against which this policy will be evaluated.\",\"displayName\":\"API Management SKU Names\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},{\"field\":\"Microsoft.ApiManagement/service/sku.name\",\"in\":\"[parameters('evaluatedSkuNames')]\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.ApiManagement/service/virtualNetworkType\"},{\"equals\":\"None\",\"field\":\"Microsoft.ApiManagement/service/virtualNetworkType\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f06ddb64-5fa3-4b77-b166-acb36f7f6042",
          "schema_version": 0,
          "attributes": {
            "description": "Control the user, primary group, supplemental group and file system group IDs that pods and containers can use to run in a Kubernetes Cluster. This policy is generally available for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster pods and containers should only run with approved user and group IDs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f06ddb64-5fa3-4b77-b166-acb36f7f6042",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"6.2.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "f06ddb64-5fa3-4b77-b166-acb36f7f6042",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Image exclusions\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"fsGroupRanges\":{\"type\":\"Object\",\"defaultValue\":{\"ranges\":[]},\"metadata\":{\"description\":\"The file system group ranges that are allowed for pods to use. Set 'max' as '-1' to skip max limit evaluation. Empty array blocks every defined value for 'MustRunAs' and 'MayRunAs'.\",\"displayName\":\"Allowed file system group ID ranges\",\"portalReview\":true}},\"fsGroupRule\":{\"type\":\"String\",\"allowedValues\":[\"MustRunAs\",\"MayRunAs\",\"RunAsAny\"],\"defaultValue\":\"RunAsAny\",\"metadata\":{\"description\":\"The 'FSGroup' rule that containers are allowed to run with. MustRunAs requires at least one range to be specified. MayRunAs does not require that 'FSGroup' be specified. RunAsAny allows any\",\"displayName\":\"File system group rule\",\"portalReview\":true}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"runAsGroupRanges\":{\"type\":\"Object\",\"defaultValue\":{\"ranges\":[]},\"metadata\":{\"description\":\"The group ID ranges that are allowed for containers to use. Set 'max' as '-1' to skip max limit evaluation. Empty array blocks every defined value for 'MustRunAs' and 'MayRunAs'.\",\"displayName\":\"Allowed group ID ranges\",\"portalReview\":true}},\"runAsGroupRule\":{\"type\":\"String\",\"allowedValues\":[\"MustRunAs\",\"MayRunAs\",\"RunAsAny\"],\"defaultValue\":\"RunAsAny\",\"metadata\":{\"description\":\"The 'RunAsGroup' rule that containers are allowed to run with. MustRunAs requires at least one range to be specified. MayRunAs does not require that 'RunAsGroup' be specified. RunAsAny allows any\",\"displayName\":\"Run as group rule\",\"portalReview\":true}},\"runAsUserRanges\":{\"type\":\"Object\",\"defaultValue\":{\"ranges\":[]},\"metadata\":{\"description\":\"The user ID ranges that are allowed for containers to use. Set 'max' as '-1' to skip max limit evaluation. Empty array blocks every defined value for 'MustRunAs'.\",\"displayName\":\"Allowed user ID ranges\",\"portalReview\":true}},\"runAsUserRule\":{\"type\":\"String\",\"allowedValues\":[\"MustRunAs\",\"MustRunAsNonRoot\",\"RunAsAny\"],\"defaultValue\":\"MustRunAsNonRoot\",\"metadata\":{\"description\":\"The 'RunAsUser' rule that containers are allowed to run with. MustRunAs requires at least one range to be specified. MustRunAsNonRoot requires the pod be submitted with non-zero runAsUser or have USER directive defined (using a numeric UID) in the image. RunAsAny allows any runAsUser to be specified\",\"displayName\":\"Run as user rule\",\"portalReview\":true}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"supplementalGroupsRanges\":{\"type\":\"Object\",\"defaultValue\":{\"ranges\":[]},\"metadata\":{\"description\":\"The supplemental group ID ranges that are allowed for containers to use. Set 'max' as '-1' to skip max limit evaluation. Empty array blocks every defined value for 'MustRunAs' and 'MayRunAs'.\",\"displayName\":\"Allowed supplemental group ID ranges\",\"portalReview\":true}},\"supplementalGroupsRule\":{\"type\":\"String\",\"allowedValues\":[\"MustRunAs\",\"MayRunAs\",\"RunAsAny\"],\"defaultValue\":\"RunAsAny\",\"metadata\":{\"description\":\"The 'SupplementalGroups' rule that containers are allowed to run with. MustRunAs requires at least one range to be specified. MayRunAs does not require that 'SupplementalGroups' be specified. RunAsAny allows any\",\"displayName\":\"Supplemental group rule\",\"portalReview\":true}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/allowed-users-groups/v3/template.yaml\"},\"values\":{\"excludedContainers\":\"[parameters('excludedContainers')]\",\"excludedImages\":\"[parameters('excludedImages')]\",\"fsGroup\":{\"ranges\":\"[parameters('fsGroupRanges').ranges]\",\"rule\":\"[parameters('fsGroupRule')]\"},\"runAsGroup\":{\"ranges\":\"[parameters('runAsGroupRanges').ranges]\",\"rule\":\"[parameters('runAsGroupRule')]\"},\"runAsUser\":{\"ranges\":\"[parameters('runAsUserRanges').ranges]\",\"rule\":\"[parameters('runAsUserRule')]\"},\"supplementalGroups\":{\"ranges\":\"[parameters('supplementalGroupsRanges').ranges]\",\"rule\":\"[parameters('supplementalGroupsRule')]\"}},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
          "schema_version": 0,
          "attributes": {
            "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for App Service apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "display_name": "App Service apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.1.0\"}",
            "mode": "Indexed",
            "name": "f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.3\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Service Bus namespaces. Learn more at: https://docs.microsoft.com/azure/service-bus-messaging/private-link-service.",
            "display_name": "Configure Service Bus namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
            "management_group_name": null,
            "metadata": "{\"category\":\"Service Bus\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "f0fcf93c-c063-4071-9668-c47474bd3564",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2",
          "schema_version": 0,
          "attributes": {
            "description": "Ensure Azure Machine Learning compute instances run on the latest available operating system. Security is improved and vulnerabilities reduced by running with the latest security patches. For more information, visit https://aka.ms/azureml-ci-updates/.",
            "display_name": "Azure Machine Learning compute instances should be recreated to get the latest software updates",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.0.3\"}",
            "mode": "All",
            "name": "f110a506-2dcb-422e-bcea-d533fc8c35e2",
            "parameters": "{\"effects\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"ComputeInstance\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"equals\":\"false\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/osImageMetadata.isLatestOsImageVersion\"}]},\"then\":{\"effect\":\"[parameters('effects')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
          "schema_version": 0,
          "attributes": {
            "description": "Named values are a collection of name and value pairs in each API Management service. Secret values can be stored either as encrypted text in API Management (custom secrets) or by referencing secrets in Azure Key Vault. To improve security of API Management and secrets, reference secret named values from Azure Key Vault. Azure Key Vault supports granular access management and secret rotation policies.",
            "display_name": "API Management secret named values should be stored in Azure Key Vault",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
            "management_group_name": null,
            "metadata": "{\"category\":\"API Management\",\"version\":\"1.0.2\"}",
            "mode": "All",
            "name": "f1cc7827-022c-473e-836e-5a51cae0b249",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service/namedValues\",\"field\":\"type\"},{\"exists\":\"true\",\"field\":\"Microsoft.ApiManagement/service/namedValues/displayName\"},{\"equals\":\"true\",\"field\":\"Microsoft.ApiManagement/service/namedValues/secret\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.ApiManagement/service/namedValues/keyVault\"},{\"exists\":\"false\",\"field\":\"Microsoft.ApiManagement/service/namedValues/keyVault.secretIdentifier\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f655e522-adff-494d-95c2-52d4f6d56a42",
          "schema_version": 0,
          "attributes": {
            "description": "Install Guest Attestation extension on supported virtual machines scale sets to allow Azure Security Center to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Windows virtual machine scale sets.",
            "display_name": "[Preview]: Guest Attestation extension should be installed on supported Windows virtual machines scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f655e522-adff-494d-95c2-52d4f6d56a42",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"3.1.0-preview\"}",
            "mode": "Indexed",
            "name": "f655e522-adff-494d-95c2-52d4f6d56a42",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.storageProfile.imageReference.offer\",\"like\":\"windows*\"},{\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.securityType\",\"in\":[\"TrustedLaunch\",\"ConfidentialVM\"]},{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings.vTpmEnabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings.secureBootEnabled\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.Azure.Security.WindowsAttestation\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},{\"equals\":\"GuestAttestation\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"}]},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual machines from potential threats by restricting access to them with network security groups (NSG). Learn more about controlling traffic with NSGs at https://aka.ms/nsg-doc",
            "display_name": "Internet-facing virtual machines should be protected with network security groups",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "mode": "All",
            "name": "f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"483f12ed-ae23-447e-a2de-a67a10db4353\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.",
            "display_name": "Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "f7d52b2d-e161-4dfa-a82b-55e564167385",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Synapse/workspaces\",\"field\":\"type\"},{\"exists\":false,\"field\":\"Microsoft.Synapse/workspaces/encryption.cmk.key.name\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f85bf3e0-d513-442e-89c3-1784ad63382b",
          "schema_version": 0,
          "attributes": {
            "description": "Your machines are missing system, security, and critical updates. Software updates often include critical patches to security holes. Such holes are frequently exploited in malware attacks so it's vital to keep your software updated. To install all outstanding patches and secure your machines, follow the remediation steps.",
            "display_name": "System updates should be installed on your machines (powered by Update Center)",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f85bf3e0-d513-442e-89c3-1784ad63382b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "f85bf3e0-d513-442e-89c3-1784ad63382b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.HybridCompute/machines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"e1145ab1-eb4f-43d8-911b-36ddf771d13f\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Service Bus should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45",
            "management_group_name": null,
            "metadata": "{\"category\":\"Service Bus\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "f8d36e2f-389b-4ee4-898d-21aeb69a0f45",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ServiceBus/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised",
            "display_name": "Resource logs in Azure Stream Analytics should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stream Analytics\",\"version\":\"5.0.0\"}",
            "mode": "Indexed",
            "name": "f9be5368-9bf5-4b84-9e0a-7850da98bb46",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"365\",\"metadata\":{\"description\":\"The required resource logs retention in days\",\"displayName\":\"Required retention (days)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.StreamAnalytics/streamingJobs\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\"},{\"anyOf\":[{\"equals\":\"0\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\"},{\"greaterOrEquals\":\"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\",\"value\":\"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\"}]},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"anyOf\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\"notEquals\":\"true\"},{\"exists\":false,\"field\":\"Microsoft.Insights/diagnosticSettings/storageAccountId\"}]}]}]}},\"greaterOrEquals\":1},\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
          "schema_version": 0,
          "attributes": {
            "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "display_name": "Function apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.1.0\"}",
            "mode": "Indexed",
            "name": "f9d614c5-c173-4d56-95a7-b4437057d193",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.3\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fa498b91-8a7e-4710-9578-da944c68d1fe",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling local authentication methods and allowing only Microsoft Entra Authentication improves security by ensuring that Azure PostgreSQL flexible server can exclusively be accessed by Microsoft Entra identities.",
            "display_name": "[Preview]: Azure PostgreSQL flexible server should have Microsoft Entra Only Authentication enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fa498b91-8a7e-4710-9578-da944c68d1fe",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "mode": "Indexed",
            "name": "fa498b91-8a7e-4710-9578-da944c68d1fe",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBForPostgreSql/flexibleServers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBForPostgreSql/flexibleServers/authConfig.activeDirectoryAuth\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBForPostgreSql/flexibleServers/authConfig.passwordAuth\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Azure AI Search service. Learn more at: https://aka.ms/azure-cognitive-search/inbound-private-endpoints.",
            "display_name": "Configure Azure AI Search services to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
            "management_group_name": null,
            "metadata": "{\"category\":\"Search\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "fbc14a67-53e4-4932-abcc-2049c6706009",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"searchService\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"searchService-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
          "schema_version": 0,
          "attributes": {
            "description": "Use encryption at host to get end-to-end encryption for your virtual machine and virtual machine scale set data. Encryption at host enables encryption at rest for your temporary disk and OS/data disk caches. Temporary and ephemeral OS disks are encrypted with platform-managed keys when encryption at host is enabled. OS/data disk caches are encrypted at rest with either customer-managed or platform-managed key, depending on the encryption type selected on the disk. Learn more at https://aka.ms/vm-hbe.",
            "display_name": "Virtual machines and virtual machine scale sets should have encryption at host enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "fc4d8e41-e223-45ea-9bf5-eada37891d87",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.encryptionAtHost\",\"notEquals\":\"true\"}]},{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.encryptionAtHost\",\"notEquals\":\"true\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Security Center has identified that some of your subnets aren't protected with a next generation firewall. Protect your subnets from potential threats by restricting access to them with Azure Firewall or a supported next generation firewall",
            "display_name": "[Preview]: All Internet traffic should be routed via your deployed Azure Firewall",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"preview\":true,\"version\":\"3.0.0-preview\"}",
            "mode": "All",
            "name": "fc5e4038-4584-4632-8c85-c0448d374b2c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable All Internet traffic should be routed via your deployed Azure Firewall\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].ipConfigurations[*]\",\"where\":{\"equals\":false,\"value\":\"[empty(field('Microsoft.Network/virtualNetworks/subnets[*].ipConfigurations[*].id'))]\"}},\"greaterOrEquals\":2},{\"exists\":false,\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].routeTable\"},{\"not\":{\"anyOf\":[{\"equals\":\"AzureBastionSubnet\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\"},{\"equals\":\"GatewaySubnet\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\"}]}}]}},\"greater\":0}]},\"then\":{\"details\":{\"existenceCondition\":{\"count\":{\"field\":\"Microsoft.Network/azureFirewalls/ipConfigurations[*]\",\"where\":{\"field\":\"Microsoft.Network/azureFirewalls/ipConfigurations[*].subnet.id\",\"like\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/*/providers/Microsoft.Network/virtualNetworks/', first(split(field('fullName'), '/')), '/subnets/AzureFirewallSubnet')]\"}},\"equals\":1},\"type\":\"Microsoft.Network/azureFirewalls\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine is not configured correctly for one of the recommendations in the Azure compute security baseline.",
            "display_name": "Linux machines should meet requirements for the Azure compute security baseline",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureLinuxBaseline\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.2.0\"}",
            "mode": "Indexed",
            "name": "fc9b3da7-8347-4380-8e70-0a0361d8dedd",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-win*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"linux*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureLinuxBaseline\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
          "schema_version": 0,
          "attributes": {
            "description": "Disable the public network access property to improve security and ensure your Azure Database for MariaDB can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range, and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for MariaDB servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/febd0533-8e55-448f-b837-bd0e06f16469",
          "schema_version": 0,
          "attributes": {
            "description": "Use images from trusted registries to reduce the Kubernetes cluster's exposure risk to unknown vulnerabilities, security issues and malicious images. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster containers should only use allowed images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/febd0533-8e55-448f-b837-bd0e06f16469",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"9.3.0\"}",
            "mode": "Microsoft.Kubernetes.Data",
            "name": "febd0533-8e55-448f-b837-bd0e06f16469",
            "parameters": "{\"allowedContainerImagesRegex\":{\"type\":\"String\",\"metadata\":{\"description\":\"The RegEx rule used to match allowed container image field in a Kubernetes cluster. For example, to allow any Azure Container Registry image by matching partial path: ^[^\\\\/]+\\\\.azurecr\\\\.io\\\\/.+$ and for multiple registries: ^([^\\\\/]+\\\\.azurecr\\\\.io|registry\\\\.io)\\\\/.+$\",\"displayName\":\"Allowed registry or registries regex\",\"portalReview\":true}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedContainers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from policy evaluation. The identify is the name of container. Use an empty list to apply this policy to all containers in all namespaces.\",\"displayName\":\"Containers exclusions\"}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Pod\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/container-allowed-images/v2/template.yaml\"},\"values\":{\"excludedContainers\":\"[parameters('excludedContainers')]\",\"imageRegex\":\"[parameters('allowedContainerImagesRegex')]\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc",
          "schema_version": 0,
          "attributes": {
            "description": "Monitor vulnerability assessment scan results and recommendations for how to remediate database vulnerabilities.",
            "display_name": "SQL databases should have vulnerability findings resolved",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"4.1.0\"}",
            "mode": "Indexed",
            "name": "feedbf84-6b99-488c-acc2-71c829aa5ffc",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Sql/servers\",\"Microsoft.Sql/managedinstances\"]},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"82e20e14-edc5-4373-bfc4-f13121257c37\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
          "schema_version": 0,
          "attributes": {
            "description": "Enable export to Log Analytics workspace of Microsoft Defender for Cloud data. This policy deploys an export to Log Analytics workspace configuration with your conditions and target workspace on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.",
            "display_name": "Deploy export to Log Analytics workspace for Microsoft Defender for Cloud data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"4.1.0\"}",
            "mode": "All",
            "name": "ffb6f416-7bd2-4488-8828-56585fef2be9",
            "parameters": "{\"alertSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security alerts. Determines alert severities. Example: High;Medium;Low;\",\"displayName\":\"Alert severities\"}},\"createResourceGroup\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"If a resource group does not exists in the scope, a new resource group will be created. If the resource group exists and this flag is set to 'true' the policy will re-deploy the resource group. Please note this will reset any Azure Tag on the resource group.\",\"displayName\":\"Create resource group\"}},\"exportedDataTypes\":{\"type\":\"Array\",\"allowedValues\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"defaultValue\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"metadata\":{\"description\":\"The data types to be exported. To export a snapshot (preview) of the data once a week, choose the data types which contains 'snapshot', other data types will be sent in real-time streaming.\",\"displayName\":\"Exported data types\"}},\"isSecurityFindingsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Security findings are results from vulnerability assessment solutions, and can be thought of as 'sub' recommendations grouped into a 'parent' recommendation.\",\"displayName\":\"Include security findings\"}},\"recommendationNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. To export all recommendations, leave this empty. To export specific recommendations, enter a list of recommendation IDs separated by semicolons (';'). Recommendation IDs are available through the Assessments API (https://docs.microsoft.com/rest/api/securitycenter/assessments), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/assessments.\",\"displayName\":\"Recommendation IDs\"}},\"recommendationSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. Determines recommendation severities. Example: High;Medium;Low;\",\"displayName\":\"Recommendation severities\"}},\"regulatoryComplianceStandardsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of regulatory compliance. To export all regulatory compliance, leave this empty. To export specific regulatory compliance standards, enter a list of these standards names separated by semicolons (';'). Regulatory compliance standards names are available through the regulatory compliance standards API (https://docs.microsoft.com/rest/api/securitycenter/regulatorycompliancestandards), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/regulatorycompliancestandards.\",\"displayName\":\"Regulatory compliance standards names\"}},\"resourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource group location\",\"strongType\":\"location\"}},\"resourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource group name\"}},\"secureScoreControlsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of secure score controls. To export all secure score controls, leave this empty. To export specific secure score controls, enter a list of secure score controls IDs separated by semicolons (';'). Secure score controls IDs are available through the Secure score controls API (https://docs.microsoft.com/rest/api/securitycenter/securescorecontrols), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/securescores/securescorecontrols.\",\"displayName\":\"Secure Score Controls IDs\"}},\"workspaceResourceId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The Log Analytics workspace of where the data should be exported to.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"Microsoft.OperationalInsights/workspaces\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('resourceGroupName')]\",\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"alertSeverities\":{\"value\":\"[parameters('alertSeverities')]\"},\"createResourceGroup\":{\"value\":\"[parameters('createResourceGroup')]\"},\"exportedDataTypes\":{\"value\":\"[parameters('exportedDataTypes')]\"},\"isSecurityFindingsEnabled\":{\"value\":\"[parameters('isSecurityFindingsEnabled')]\"},\"recommendationNames\":{\"value\":\"[parameters('recommendationNames')]\"},\"recommendationSeverities\":{\"value\":\"[parameters('recommendationSeverities')]\"},\"regulatoryComplianceStandardsNames\":{\"value\":\"[parameters('regulatoryComplianceStandardsNames')]\"},\"resourceGroupLocation\":{\"value\":\"[parameters('resourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('resourceGroupName')]\"},\"secureScoreControlsNames\":{\"value\":\"[parameters('secureScoreControlsNames')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('workspaceResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"alertSeverities\":{\"type\":\"array\"},\"createResourceGroup\":{\"type\":\"bool\"},\"exportedDataTypes\":{\"type\":\"array\"},\"guidValue\":{\"defaultValue\":\"[newGuid()]\",\"type\":\"string\"},\"isSecurityFindingsEnabled\":{\"type\":\"bool\"},\"recommendationNames\":{\"type\":\"array\"},\"recommendationSeverities\":{\"type\":\"array\"},\"regulatoryComplianceStandardsNames\":{\"type\":\"array\"},\"resourceGroupLocation\":{\"type\":\"string\"},\"resourceGroupName\":{\"type\":\"string\"},\"secureScoreControlsNames\":{\"type\":\"array\"},\"workspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"condition\":\"[parameters('createResourceGroup')]\",\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('resourceGroupName'))]\"],\"name\":\"[concat('nestedAutomationDeployment', '_', parameters('guidValue'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-01-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"ExportToWorkspace\",\"properties\":{\"actions\":[{\"actionType\":\"Workspace\",\"workspaceResourceId\":\"[parameters('workspaceResourceId')]\"}],\"description\":\"Export Microsoft Defender for Cloud data to Log Analytics workspace via policy\",\"isEnabled\":true,\"scopes\":[{\"description\":\"[replace(variables('scopeDescription'),'{0}', subscription().subscriptionId)]\",\"scopePath\":\"[subscription().id]\"}],\"sources\":\"[variables('sources')]\"},\"tags\":{},\"type\":\"Microsoft.Security/automations\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"alertSeveritiesLength\":\"[length(parameters('alertSeverities'))]\",\"alertSeveritiesLengthIfEmpty\":\"[if(equals(variables('alertSeveritiesLength'), 0), 1, variables('alertSeveritiesLength'))]\",\"alertSeverityMap\":{\"High\":\"high\",\"Low\":\"low\",\"Medium\":\"medium\"},\"customRuleSetsForRegulatoryComplianceObj\":{\"copy\":[{\"count\":\"[variables('regulatoryComplianceStandardsNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), parameters('regulatoryComplianceStandardsNames')[copyIndex('ruleSetsForRegulatoryCompliancArr')])]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForRegulatoryCompliancArr\"}]},\"customRuleSetsForSecureScoreControlsObj\":{\"copy\":[{\"count\":\"[variables('secureScoreControlsLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), parameters('secureScoreControlsNames')[copyIndex('ruleSetsForSecureScoreControlsArr')])]\",\"operator\":\"Equals\",\"propertyJPath\":\"name\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSecureScoreControlsArr\"}]},\"customRuleSetsForSubAssessmentsObj\":{\"copy\":[{\"count\":\"[variables('recommendationNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), replace(variables('subAssessmentRuleExpectedValue'),'{0}', parameters('recommendationNames')[copyIndex('ruleSetsForSubAssessmentsArr')]))]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSubAssessmentsArr\"}]},\"dataTypeMap\":{\"Overall secure score\":\"SecureScores\",\"Overall secure score - snapshot\":\"SecureScoresSnapshot\",\"Regulatory compliance\":\"RegulatoryComplianceAssessment\",\"Regulatory compliance - snapshot\":\"RegulatoryComplianceAssessmentSnapshot\",\"Secure score controls\":\"SecureScoreControls\",\"Secure score controls - snapshot\":\"SecureScoreControlsSnapshot\",\"Security alerts\":\"Alerts\",\"Security findings - snapshot\":\"SubAssessmentsSnapshot\",\"Security recommendations\":\"Assessments\",\"Security recommendations - snapshot\":\"AssessmentsSnapshot\"},\"exportedDataTypesLength\":\"[length(parameters('exportedDataTypes'))]\",\"exportedDataTypesLengthIfEmpty\":\"[if(equals(variables('exportedDataTypesLength'), 0), 1, variables('exportedDataTypesLength'))]\",\"recommendationNamesLength\":\"[length(parameters('recommendationNames'))]\",\"recommendationNamesLengthIfEmpty\":\"[if(equals(variables('recommendationNamesLength'), 0), 1, variables('recommendationNamesLength'))]\",\"recommendationSeveritiesLength\":\"[length(parameters('recommendationSeverities'))]\",\"recommendationSeveritiesLengthIfEmpty\":\"[if(equals(variables('recommendationSeveritiesLength'), 0), 1, variables('recommendationSeveritiesLength'))]\",\"regulatoryComplianceStandardsNamesLength\":\"[length(parameters('regulatoryComplianceStandardsNames'))]\",\"regulatoryComplianceStandardsNamesLengthIfEmpty\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), 1, variables('regulatoryComplianceStandardsNamesLength'))]\",\"ruleSetsForAlertsObj\":{\"copy\":[{\"count\":\"[variables('alertSeveritiesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[variables('alertSeverityMap')[parameters('alertSeverities')[mod(copyIndex('ruleSetsForAlertsArr'),variables('alertSeveritiesLengthIfEmpty'))]]]\",\"operator\":\"Equals\",\"propertyJPath\":\"Severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAlertsArr\"}]},\"ruleSetsForAssessmentsObj\":{\"copy\":[{\"count\":\"[mul(variables('recommendationNamesLengthIfEmpty'),variables('recommendationSeveritiesLengthIfEmpty'))]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'),0),'Microsoft.Security/assessments',parameters('recommendationNames')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationName')),variables('recommendationNamesLength'))])]\",\"operator\":\"Contains\",\"propertyJPath\":\"[if(equals(variables('recommendationNamesLength'),0),'type','name')]\",\"propertyType\":\"string\"},{\"expectedValue\":\"[parameters('recommendationSeverities')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationSeverity')),variables('recommendationSeveritiesLength'))]]\",\"operator\":\"Equals\",\"propertyJPath\":\"properties.metadata.severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAssessmentsArr\"}]},\"ruleSetsForSecureRegulatoryComplianceObj\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), variables('customRuleSetsForRegulatoryComplianceObj').ruleSetsForRegulatoryCompliancArr)]\",\"ruleSetsForSecureScoreControlsObj\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), variables('customRuleSetsForSecureScoreControlsObj').ruleSetsForSecureScoreControlsArr)]\",\"ruleSetsForSubAssessmentsObj\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), variables('customRuleSetsForSubAssessmentsObj').ruleSetsForSubAssessmentsArr)]\",\"ruleSetsMap\":{\"Overall secure score\":null,\"Overall secure score - snapshot\":null,\"Regulatory compliance\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Regulatory compliance - snapshot\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Secure score controls\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Secure score controls - snapshot\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Security alerts\":\"[variables('ruleSetsForAlertsObj').ruleSetsForAlertsArr]\",\"Security findings - snapshot\":\"[variables('ruleSetsForSubAssessmentsObj')]\",\"Security recommendations\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\",\"Security recommendations - snapshot\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\"},\"scopeDescription\":\"scope for subscription {0}\",\"secureScoreControlsLengthIfEmpty\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), 1, variables('secureScoreControlsNamesLength'))]\",\"secureScoreControlsNamesLength\":\"[length(parameters('secureScoreControlsNames'))]\",\"sources\":\"[if(equals(parameters('isSecurityFindingsEnabled'),bool('true')),variables('sourcesWithSubAssessments'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithSubAssessments\":\"[concat(variables('subAssessmentSource'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithoutSubAssessments\":{\"copy\":[{\"count\":\"[variables('exportedDataTypesLengthIfEmpty')]\",\"input\":{\"eventSource\":\"[variables('dataTypeMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\",\"ruleSets\":\"[variables('ruleSetsMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\"},\"name\":\"sources\"}]},\"subAssessmentRuleExpectedValue\":\"/assessments/{0}/\",\"subAssessmentSource\":[{\"eventSource\":\"SubAssessments\",\"ruleSets\":\"[variables('ruleSetsForSubAssessmentsObj')]\"}],\"totalRuleCombinationsForOneRecommendationName\":\"[variables('recommendationSeveritiesLengthIfEmpty')]\",\"totalRuleCombinationsForOneRecommendationSeverity\":1}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":true,\"field\":\"Microsoft.Security/automations/isEnabled\"},{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\"},\"equals\":\"[if(parameters('isSecurityFindingsEnabled'),add(length(parameters('exportedDataTypes')),1),length(parameters('exportedDataTypes')))]\"},{\"count\":{\"name\":\"dataType\",\"value\":\"[parameters('exportedDataTypes')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Assessments\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"Alerts\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security alerts\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScores\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControls\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessment\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoresSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControlsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessmentSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"AssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SubAssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security findings - snapshot\",\"value\":\"[current('dataType')]\"}]}]}},\"equals\":1}},\"equals\":\"[length(parameters('exportedDataTypes'))]\"}]},\"existenceScope\":\"resourcegroup\",\"name\":\"ExportToWorkspace\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Security/automations\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "data",
      "type": "azurerm_policy_set_definition",
      "name": "external_lookup",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
          "schema_version": 0,
          "attributes": {
            "description": "The Microsoft cloud security benchmark initiative represents the policies and controls implementing security recommendations defined in Microsoft cloud security benchmark, see https://aka.ms/azsecbm. This also serves as the Microsoft Defender for Cloud default policy initiative. You can directly assign this initiative, or manage its policies and compliance results within Microsoft Defender for Cloud.",
            "display_name": "Microsoft cloud security benchmark",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"57.49.0\"}",
            "name": "1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
            "parameters": "{\"ASCDependencyAgentAuditLinuxEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Dependency Agent for Linux VMs\",\"displayName\":\"Audit Dependency Agent for Linux VMs monitoring\"}},\"ASCDependencyAgentAuditWindowsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Dependency Agent for Windows VMs\",\"displayName\":\"Audit Dependency Agent for Windows VMs monitoring\"}},\"AllowHostNetworkingInKubernetesCluster\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Set this value to true if pod is allowed to use host network otherwise false.\",\"displayName\":\"Allow host network usage\"}},\"AllowedAppArmorProfilesInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of modification of Kubernetes containers' AppArmor profile\",\"displayName\":\"Containers should only use allowed AppArmor profiles\"}},\"AllowedAppArmorProfilesInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of containers modification of AppArmor profile\"}},\"AllowedAppArmorProfilesInKubernetesClusterList\":{\"type\":\"Array\",\"defaultValue\":[\"runtime/default\"],\"metadata\":{\"description\":\"The list of AppArmor profiles that containers are allowed to use. E.g. [ \\\"runtime/default\\\", \\\"docker/default\\\" ]. Provide empty list as input to block everything.\",\"displayName\":\"Allowed AppArmor profiles\"}},\"AllowedAppArmorProfilesInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to monitoring of containers modifying of AppArmor profile in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of containers modification of AppArmor profile\"}},\"AllowedCapabilitiesInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of Kubernetes containers using allowed capabilities only\",\"displayName\":\"Least privileged Linux capabilities should be enforced for containers\"}},\"AllowedCapabilitiesInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of containers use only allowed capabilities\"}},\"AllowedCapabilitiesInKubernetesClusterList\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of capabilities that are allowed to be added to a container. Provide empty list as input to block everything.\",\"displayName\":\"Allowed capabilities\"}},\"AllowedCapabilitiesInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to monitoring of containers using only allowed capabilities in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of containers use only allowed capabilities\"}},\"AllowedHostMaxPortInKubernetesCluster\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"The maximum value in the allowable host port range that pods can use in the host network namespace.\",\"displayName\":\"Max host port for pod in Kubernetes cluster\"}},\"AllowedHostMinPortInKubernetesCluster\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"The minimum value in the allowable host port range that pods can use in the host network namespace.\",\"displayName\":\"Min host port for pod in Kubernetes cluster\"}},\"AllowedHostNetworkingAndPortsInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of Kubernetes containers' host networking and port ranges\",\"displayName\":\"Usage of host networking and ports should be restricted\"}},\"AllowedHostNetworkingAndPortsInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of containers host networking and ports\"}},\"AllowedHostNetworkingAndPortsInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to monitoring of containers host networking and ports in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of containers host networking and ports\"}},\"AllowedHostPathVolumesInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of pod HostPath volume mounts in Kubernetes clusters\",\"displayName\":\"Usage of pod HostPath volume mounts should be restricted to a known list to restrict node access from compromised containers\"}},\"AllowedHostPathVolumesInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of pod HostPath volume mounts\"}},\"AllowedHostPathVolumesInKubernetesClusterList\":{\"type\":\"Object\",\"defaultValue\":{\"paths\":[]},\"metadata\":{\"description\":\"The host paths allowed for pod hostPath volumes to use. Provide an empty paths list to block all host paths.\",\"displayName\":\"Allowed host paths for pod in Kubernetes cluster\",\"schema\":{\"additionalProperties\":false,\"properties\":{\"paths\":{\"items\":{\"additionalProperties\":false,\"properties\":{\"pathPrefix\":{\"type\":\"string\"},\"readOnly\":{\"type\":\"boolean\"}},\"required\":[\"pathPrefix\",\"readOnly\"],\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"paths\"],\"type\":\"object\"}}},\"AllowedHostPathVolumesInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to monitoring of pod HostPath volume mounts in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of pod HostPath volume mounts\"}},\"ArcLinuxMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Log Analytics agent should be installed on your Linux Azure Arc machines\",\"displayName\":\"Log Analytics agent should be installed on your Linux Azure Arc machines\"}},\"ArcWindowsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable Log Analytics agent should be installed on your  Windows Azure Arc machines\",\"displayName\":\"[Deprecated]: Log Analytics agent should be installed on your  Windows Azure Arc machines\"}},\"AzureDefenderForDNSShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Azure Defender for DNS provides an additional layer of protection for your cloud resources by continuously monitoring all DNS queries from your Azure resources. Azure Defender alerts you about suspicious activity at the DNS layer. Learn more about the capabilities of Azure Defender for DNS at https://aka.ms/defender-for-dns . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .\",\"displayName\":\"[Deprecated]: Azure Defender for DNS should be enabled\"}},\"AzureDefenderForOpenSourceRelationalDatabasesShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Azure Defender for open-source relational databases detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. Learn more about the capabilities of Azure Defender for open-source relational databases at https://aka.ms/AzDforOpenSourceDBsDocu. Important: Enabling this plan will result in charges for protecting your open-source relational databases. Learn about the pricing on Security Center's pricing page: https://aka.ms/pricing-security-center.\",\"displayName\":\"Azure Defender for open-source relational databases should be enabled\"}},\"AzureDefenderForResourceManagerShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Azure Defender for Resource Manager automatically monitors the resource management operations in your organization. Azure Defender detects threats and alerts you about suspicious activity. Learn more about the capabilities of Azure Defender for Resource Manager at https://aka.ms/defender-for-resource-manager . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .\",\"displayName\":\"Azure Defender for Resource Manager should be enabled\"}},\"AzureFirewallEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable All Internet traffic should be routed via your deployed Azure Firewall\",\"displayName\":\"All Internet traffic should be routed via your deployed Azure Firewall\"}},\"BlockVulnerableImagesExcludeFindingIDs\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"deprecated\":true,\"description\":\"A list of finding IDs that the policy should exempt.\",\"displayName\":\"[Deprecated]: Exclude finding IDs for gating vulnerable images scan results in Kubernetes cluster\"}},\"BlockVulnerableImagesExcludedImages\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"deprecated\":true,\"description\":\"A list of RegEx rules used to exclude container images from policy evaluation. For example: exclude all images from the repo microsoft-defender-in-cluster-defense-repo in the blockreg ACR -  [\\\"(blockreg.azurecr.io/microsoft-defender-in-cluster-defense-repo).*\\\"]. Use an empty list to apply this policy to all container images.\",\"displayName\":\"[Deprecated]: Excluded images regex for gating vulnerable images in Kubernetes cluster\"}},\"BlockVulnerableImagesInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable gating containers' with vulnerable images in Kubernetes clusters\",\"displayName\":\"[Deprecated]: Kubernetes clusters should gate deployment of vulnerable images\"}},\"BlockVulnerableImagesInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"deprecated\":true,\"description\":\"List of Kubernetes namespaces to exclude from evaluation of block vulnerable images in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"[Deprecated]: Kubernetes namespaces to exclude from monitoring of containers with vulnerable images\"}},\"BlockVulnerableImagesNamespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"deprecated\":true,\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"[Deprecated]: Namespace inclusions\"}},\"BlockVulnerableImagesSeverityThresholdForExcludingNotPatchableFindings\":{\"type\":\"String\",\"allowedValues\":[\"None\",\"Low\",\"Medium\",\"High\"],\"defaultValue\":\"None\",\"metadata\":{\"deprecated\":true,\"description\":\"Specify the maximum severity for exempting vulnerabilities without a patch. For example, specify Medium to ignore Low and Medium vulnerabilities without a patch.\",\"displayName\":\"[Deprecated]: Severity threshold for excluding gating of image vulnerabilities without a patch in Kubernetes cluster\"}},\"CPUInKubernetesClusterLimit\":{\"type\":\"String\",\"defaultValue\":\"32\",\"metadata\":{\"description\":\"The maximum CPU units allowed for a container. E.g. 200m. For more information, please refer https://aka.ms/k8s-policy-pod-limits\",\"displayName\":\"Max allowed CPU units in Kubernetes cluster\"}},\"DropCapabilitiesInKubernetesClusterList\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of capabilities that must be dropped by a container.\",\"displayName\":\"Required drop capabilities\"}},\"GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Install Guest Attestation extension on supported Linux virtual machines to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment only applies to trusted launch enabled Linux virtual machines.\",\"displayName\":\"Guest Attestation extension should be installed on supported Linux virtual machines\"}},\"GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesScaleSetsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Install Guest Attestation extension on supported Linux virtual machines scale sets to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment only applies to trusted launch enabled Linux virtual machine scale sets.\",\"displayName\":\"Guest Attestation extension should be installed on supported Linux virtual machines scale sets\"}},\"GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Install Guest Attestation extension on supported virtual machines to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment only applies to trusted launch enabled virtual machines.\",\"displayName\":\"Guest Attestation extension should be installed on supported Windows virtual machines\"}},\"GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesScaleSetsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Install Guest Attestation extension on supported virtual machines scale sets to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment only applies to trusted launch enabled virtual machine scale sets.\",\"displayName\":\"Guest Attestation extension should be installed on supported Windows virtual machines scale sets\"}},\"KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Disable automounting API credentials to prevent a potentially compromised Pod resource to run API commands against Kubernetes clusters. For more information, see https://aka.ms/kubepolicydoc.\",\"displayName\":\"Kubernetes clusters should disable automounting API credentials\"}},\"KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of automounting API credentials\"}},\"KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to restrict automounting API credentials. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from restricting automounting API credentials\"}},\"KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"To reduce the attack surface of your containers, restrict CAP_SYS_ADMIN Linux capabilities. For more information, see https://aka.ms/kubepolicydoc.\",\"displayName\":\"Kubernetes clusters should not grant CAPSYSADMIN security capabilities\"}},\"KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of CAP_SYS_ADMIN Linux capabilities\"}},\"KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to restrict CAP_SYS_ADMIN Linux capabilities. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from restricting CAP_SYS_ADMIN Linux capabilities\"}},\"KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Prevent usage of the default namespace in Kubernetes clusters to protect against unauthorized access for ConfigMap, Pod, Secret, Service, and ServiceAccount resource types. For more information, see https://aka.ms/kubepolicydoc.\",\"displayName\":\"Kubernetes clusters should not use the default namespace\"}},\"KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of block default namespace\"}},\"LinuxVirtualMachineShouldUseSignedAndTrustedBootComponentEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"All OS boot components (boot loader, kernel, kernel drivers) must be signed by trusted publishers. Defender for Cloud has identified untrusted OS boot components on one or more of your Linux machines. To protect your machines from potentially malicious components, add them to your allow list or remove the identified components.\",\"displayName\":\"Linux virtual machines should use only signed and trusted boot components\"}},\"MicrosoftDefenderCSPMShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Defender Cloud Security Posture Management (CSPM) provides enhanced posture capabilities and a new intelligent cloud security graph to help identify, prioritize, and reduce risk. Defender CSPM is available in addition to the free foundational security posture capabilities turned on by default in Defender for Cloud.\",\"displayName\":\"Microsoft Defender CSPM should be enabled\"}},\"MustRunAsNonRootLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of containers running as root user\"}},\"MustRunAsNonRootNamespaceEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of containers running as root user in Kubernetes nodes\",\"displayName\":\"Kubernetes containers should not be run as root user\"}},\"MustRunAsNonRootNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to monitoring of containers running as root users. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of containers running as root user\"}},\"NoPrivilegeEscalationInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of privileged escalation containers in Kubernetes clusters\",\"displayName\":\"Container with privileged escalation should be avoided\"}},\"NoPrivilegeEscalationInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of privileged escalation containers\"}},\"NoPrivilegeEscalationInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation of privileged escalation containers in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of privileged escalation containers\"}},\"NoSharingSensitiveHostNamespacesInKubernetesEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of shared sensitive host namespaces in Kubernetes clusters\",\"displayName\":\"Containers sharing sensitive host namespaces should be avoided\"}},\"NoSharingSensitiveHostNamespacesInKubernetesLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of sharing sensitive host namespaces in Kubernetes clusters\"}},\"NoSharingSensitiveHostNamespacesInKubernetesNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation of  sharing sensitive host namespaces in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of sharing sensitive host namespaces in Kubernetes clusters\"}},\"ReadOnlyRootFileSystemInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of containers running with a read only root file system in Kubernetes clusters\",\"displayName\":\"Immutable (read-only) root filesystem should be enforced for containers\"}},\"ReadOnlyRootFileSystemInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of containers running with a read only root file system\"}},\"ReadOnlyRootFileSystemInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation to monitoring of containers running with a read only root file system in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of containers running with a read only root file system\"}},\"SecureBootShouldBeEnabledOnSupportedWindowsVirtualMachinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable Secure Boot on supported Windows virtual machines to mitigate against malicious and unauthorized changes to the boot chain. Once enabled, only trusted bootloaders, kernel and kernel drivers will be allowed to run. This assessment only applies to trusted launch enabled Windows virtual machines.\",\"displayName\":\"Secure Boot should be enabled on supported Windows virtual machines\"}},\"SqlServerAuditingRetentionDaysMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of SQL servers with auditing retention period less than 90\",\"displayName\":\"[Deprecated]: SQL servers should be configured with auditing retention days greater than 90 days\"}},\"VtpmShouldBeEnabledOnSupportedVirtualMachinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable virtual TPM device on supported virtual machines to facilitate Measured Boot and other OS security features that require a TPM. Once enabled, vTPM can be used to attest boot integrity. This assessment only applies to trusted launch enabled virtual machines.\",\"displayName\":\"vTPM should be enabled on supported virtual machines\"}},\"aPIManagementServicesShouldUseAVirtualNetworkEvaluatedSkuNames\":{\"type\":\"Array\",\"allowedValues\":[\"Developer\",\"Basic\",\"Standard\",\"Premium\",\"Consumption\"],\"defaultValue\":[\"Developer\",\"Premium\"],\"metadata\":{\"description\":\"List of API Management SKUs against which this policy will be evaluated.\",\"displayName\":\"API Management SKU Names\"}},\"aPIManagementServicesShouldUseAVirtualNetworkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Virtual Network deployment provides enhanced security, isolation and allows you to place your API Management service in a non-internet routable network that you control access to. These networks can then be connected to your on-premises networks using various VPN technologies, which enables access to your backend services within the network and/or on-premises. The developer portal and API gateway, can be configured to be accessible either from the Internet or only within the virtual network.\",\"displayName\":\"API Management services should use a virtual network\"}},\"aadAuthenticationInServiceFabricMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of Azure Active Directory for client authentication in Service Fabric\",\"displayName\":\"Service Fabric clusters should only use Azure Active Directory for client authentication\"}},\"aadAuthenticationInSqlServerMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of an Azure AD admininistrator for SQL server\",\"displayName\":\"An Azure Active Directory administrator should be provisioned for SQL servers\"}},\"accessRulesInEventHubMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of access rules in Event Hubs\",\"displayName\":\"[Deprecated]: Authorization rules on the Event Hub instance should be defined\"}},\"accessRulesInEventHubNamespaceMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of access rules in Event Hub namespaces\",\"displayName\":\"[Deprecated]: All authorization rules except RootManageSharedAccessKey should be removed from Event Hub namespace\"}},\"adaptiveApplicationControlsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable application controls to define the list of known-safe applications running on your machines, and alert you when other applications run\",\"displayName\":\"[Deprecated]: Adaptive application controls for defining safe applications should be enabled on your machines\"}},\"adaptiveApplicationControlsUpdateMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring for changes in behavior on groups of machines configured for auditing by Microsoft Defender for Cloud's adaptive application controls\",\"displayName\":\"[Deprecated]: Allowlist rules in your adaptive application control policy should be updated\"}},\"adaptiveNetworkHardeningsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Internet-facing virtual machines for Network Security Group traffic hardening recommendations\",\"displayName\":\"[Deprecated]: Adaptive network hardening recommendations should be applied on internet facing virtual machines\"}},\"allowedContainerImagesInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of allowed container images in Kubernetes clusters\",\"displayName\":\"Container images should be deployed from trusted registries only\"}},\"allowedContainerImagesInKubernetesClusterRegex\":{\"type\":\"String\",\"defaultValue\":\"^(.+){0}$\",\"metadata\":{\"description\":\"The RegEx rule used to match allowed container image field in a Kubernetes cluster. For example, to allow any Azure Container Registry image by matching partial path: ^[^\\\\/]+\\\\.azurecr\\\\.io\\\\/.+$ and for multiple registries: ^([^\\\\/]+\\\\.azurecr\\\\.io|registry\\\\.io)\\\\/.+$\",\"displayName\":\"Allowed registry or registries regex\"}},\"allowedContainerImagesLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of allowed container images\"}},\"allowedContainerImagesNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation of allowed container images in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of allowed container images\"}},\"allowedContainerPortsInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable monitoring of allowed container ports in Kubernetes clusters\",\"displayName\":\"[Deprecated]: Containers should listen on allowed ports only\"}},\"allowedContainerPortsInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"deprecated\":true,\"description\":\"List of Kubernetes namespaces to exclude from evaluation of allowed container ports in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"[Deprecated]: Kubernetes namespaces to exclude from monitoring of allowed container port\"}},\"allowedContainerPortsInKubernetesClusterPorts\":{\"type\":\"Array\",\"defaultValue\":[\"-1\"],\"metadata\":{\"deprecated\":true,\"description\":\"List of container ports allowed in Kubernetes cluster. Use ; to separate values\",\"displayName\":\"[Deprecated]: Allowed container ports list in Kubernetes cluster\"}},\"allowedServicePortsInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of allowed service ports in Kubernetes clusters\",\"displayName\":\"Services should listen on allowed ports only\"}},\"allowedServicePortsInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of allowed service ports\"}},\"allowedServicePortsInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation of allowed service ports in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of allowed service ports\"}},\"allowedservicePortsInKubernetesClusterPorts\":{\"type\":\"Array\",\"defaultValue\":[\"-1\"],\"metadata\":{\"description\":\"The list of service ports allowed in a Kubernetes cluster. Array only accepts strings. Example: [\\\"443\\\", \\\"80\\\"]\",\"displayName\":\"Allowed service ports list in Kubernetes cluster\"}},\"apiAppAuditFtpsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable FTPS enforcement for enhanced security\",\"displayName\":\"[Deprecated]: FTPS should be required in your API App\"}},\"apiAppConfigureIPRestrictionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of IP restrictions for API App\",\"displayName\":\"[Deprecated]: Monitor Configure IP restrictions for API App\"}},\"apiAppDisableRemoteDebuggingMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of remote debugging for API App\",\"displayName\":\"[Deprecated]: Remote debugging should be turned off for API App\"}},\"apiAppDisableWebSocketsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of web sockets for API App\",\"displayName\":\"[Deprecated]: Monitor disable web sockets for API App\"}},\"apiAppEnforceHttpsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of the use of HTTPS in API App\",\"displayName\":\"[Deprecated]: API App should only be accessible over HTTPS\"}},\"apiAppEnforceHttpsMonitoringEffectV2\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of the use of HTTPS in API App V2\",\"displayName\":\"[Deprecated]: API App should only be accessible over HTTPS V2\"}},\"apiAppRequireLatestTlsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Upgrade to the latest TLS version\",\"displayName\":\"[Deprecated]: Latest TLS version should be used in your API App\"}},\"apiAppRestrictCORSAccessMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of CORS restrictions for API App\",\"displayName\":\"[Deprecated]: CORS should not allow every resource to access your API App\"}},\"apiAppUseManagedIdentityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Use a managed identity for enhanced authentication security\",\"displayName\":\"[Deprecated]: A managed identity should be used in your API App\"}},\"apiAppUsedCustomDomainsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of custom domain use in API App\",\"displayName\":\"[Deprecated]: Monitor the custom domain use in API App\"}},\"apiAppUsedLatestDotNetMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of .NET version in API App\",\"displayName\":\"[Deprecated]: Monitor use latest .NET in API App\"}},\"apiAppUsedLatestJavaMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Java version in API App\",\"displayName\":\"[Deprecated]: Monitor use latest Java in API App\"}},\"apiAppUsedLatestPHPMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of PHP version in API App\",\"displayName\":\"[Deprecated]: Monitor use latest PHP in API App\"}},\"apiAppUsedLatestPythonMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Python version in API App\",\"displayName\":\"[Deprecated]: Monitor use latest Python in API App\"}},\"appConfigurationShouldUsePrivateLinkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your app configuration instances instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/appconfig/private-endpoint.\",\"displayName\":\"App Configuration should use private link\"}},\"appServicesAdvancedThreatProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Azure Defender for App Service\",\"displayName\":\"Azure Defender for App Services should be enabled\"}},\"arcEnabledKubernetesClustersShouldHaveAzureDefendersExtensionInstalled\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of Arc enabled Kubernetes clusters without Azure Defender's extension installed\",\"displayName\":\"Azure Arc enabled Kubernetes clusters should have Azure Defender's extension installed\"}},\"arcEnabledKubernetesClustersShouldHaveAzurePolicyExtensionInstalledEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable monitoring of Arc enabled Kubernetes clusters without Azure Policy's extension installed\",\"displayName\":\"Azure Arc enabled Kubernetes clusters should have Azure Policy's extension installed\"}},\"arcEnabledSqlServerDefenderStatusEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of the protection status for Arc-enabled SQL Servers\",\"displayName\":\"Microsoft Defender for SQL status should be protected for Arc-enabled SQL Servers\"}},\"authenticationToLinuxMachinesShouldRequireSSHKeysMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Although SSH itself provides an encrypted connection, using passwords with SSH still leaves the VM vulnerable to brute-force attacks. The most secure option for authenticating to an Azure Linux virtual machine over SSH is with a public-private key pair, also known as SSH keys. Learn more: https://docs.microsoft.com/azure/virtual-machines/linux/create-ssh-keys-detailed.\",\"displayName\":\"Authentication to Linux machines should require SSH keys\"}},\"autoProvisioningOfTheLogAnalyticsAgentShouldBeEnabledOnYourSubscriptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"To monitor for security vulnerabilities and threats, Microsoft Defender for Cloud collects data from your Azure virtual machines. Data is collected by the Log Analytics agent, formerly known as the Microsoft Monitoring Agent (MMA), which reads various security-related configurations and event logs from the machine and copies the data to your Log Analytics workspace for analysis. We recommend enabling auto provisioning to automatically deploy the agent to all supported Azure VMs and any new ones that are created.\",\"displayName\":\"[Deprecated]: Auto provisioning of the Log Analytics agent should be enabled on your subscription\"}},\"azureBackupShouldBeEnabledForVirtualMachinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Ensure protection of your Azure Virtual Machines by enabling Azure Backup. Azure Backup is a secure and cost effective data protection solution for Azure.\",\"displayName\":\"Azure Backup should be enabled for Virtual Machines\"}},\"azureCacheForRedisShouldResideWithinAVirtualNetworkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Azure Virtual Network deployment provides enhanced security and isolation for your Azure Cache for Redis, as well as subnets, access control policies, and other features to further restrict access.When an Azure Cache for Redis instance is configured with a virtual network, it is not publicly addressable and can only be accessed from virtual machines and applications within the virtual network.\",\"displayName\":\"[Deprecated]: Azure Cache for Redis should reside within a virtual network\"}},\"azureCacheForRedisShouldUsePrivateEndpointMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Private endpoints lets you connect your virtual network to Azure services without a public IP address at the source or destination. By mapping private endpoints to your Azure Cache for Redis instances, data leakage risks are reduced. Learn more at: https://docs.microsoft.com/azure/azure-cache-for-redis/cache-private-link.\",\"displayName\":\"Azure Cache for Redis should use private link\"}},\"azureContainerRegistryVulnerabilityAssessmentEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable monitoring of Azure container registries by Microsoft Defender for Cloud vulnerability assessment (powered by Microsoft Defender Vulnerability Management)\",\"displayName\":\"Vulnerabilities in Azure Container Registry images should be remediated\"}},\"azureCosmosDBAccountsShouldHaveFirewallRulesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Firewall rules should be defined on your Azure Cosmos DB accounts to prevent traffic from unauthorized sources. Accounts that have at least one IP rule defined with the virtual network filter enabled are deemed compliant. Accounts disabling public access are also deemed compliant.\",\"displayName\":\"Azure Cosmos DB accounts should have firewall rules\"}},\"azureCosmosDbAccountsShouldHaveLocalAuthenticationMethodsDisabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Disabling local authentication methods improves security by ensuring that Cosmos DB database accounts exclusively require Azure Active Directory identities for authentication. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-setup-rbac#disable-local-auth.\",\"displayName\":\"Cosmos DB database accounts should have local authentication methods disabled\"}},\"azureCosmosDbAccountsShouldUseCustomerManagedKeysToEncryptDataAtRestMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"disabled\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about customer-managed key encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\"}},\"azureEventGridDomainsShouldUsePrivateLinkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network.By mapping private endpoints to your Event Grid domains instead of the entire service, you'll also be protected against data leakage risks.Learn more at: https://aka.ms/privateendpoints.\",\"displayName\":\"Azure Event Grid domains should use private link\"}},\"azureEventGridTopicsShouldUsePrivateLinkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your topics instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/privateendpoints.\",\"displayName\":\"Azure Event Grid topics should use private link\"}},\"azureKubernetesServiceClustersShouldHaveSecurityProfileEnabled\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of Azure Kubernetes Service clusters without Azure Defender's profile enabled\",\"displayName\":\"Azure Kubernetes Service clusters should have Azure Defender profile enabled\"}},\"azureMachineLearningWorkspacesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about customer-managed key encryption at https://aka.ms/azureml-workspaces-cmk.\",\"displayName\":\"Azure Machine Learning workspaces should be encrypted with a customer-managed key\"}},\"azureMachineLearningWorkspacesShouldUsePrivateLinkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your Azure Machine Learning workspaces instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/azureml-workspaces-privatelink.\",\"displayName\":\"Azure Machine Learning workspaces should use private link\"}},\"azurePolicyAddonStatusEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable reporting of the Azure Policy Add-on is enabled on Azure Kubernetes managed cluster\",\"displayName\":\"Azure Policy Add-on for Kubernetes should be installed and enabled on Azure Kubernetes Service (AKS) clusters\"}},\"azurePolicyforWindowsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable virtual machines reporting that the Guest Configuration extension should be installed\",\"displayName\":\"Guest Configuration extension should be installed on virtual machines\"}},\"azureSignalRServiceShouldUsePrivateLinkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your  SignalR resources instead of the entire service, you'll also be protected against data leakage risks .Learn more at: https://aka.ms/asrs/privatelink.\",\"displayName\":\"Azure SignalR Service should use private link\"}},\"azureSpringCloudShouldUseNetworkInjectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Spring Cloud instances should use virtual network injection for the following purposes: 1. Isolate Azure Spring Cloud from Internet. 2. Enable Azure Spring Cloud to interact with systems in either on premises data centers or Azure service in other virtual networks. 3. Empower customers to control inbound and outbound network communications for Azure Spring Cloud.\",\"displayName\":\"Azure Spring Cloud should use network injection\"}},\"bringYourOwnKeyDataProtectionShouldBeEnabledForMySqlServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"MySQL servers should use customer-managed keys to encrypt data at rest\"}},\"bringYourOwnKeyDataProtectionShouldBeEnabledForPostgreSqlServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"PostgreSQL servers should use customer-managed keys to encrypt data at rest\"}},\"certificatesValidityPeriodInMonths\":{\"type\":\"Integer\",\"defaultValue\":12,\"metadata\":{\"description\":\"The limit to how long a certificate may be valid for. Certificates with lengthy validity periods aren't best practice.\",\"displayName\":\"The maximum validity period in months of managed certificate\"}},\"certificatesValidityPeriodMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"disabled\",\"metadata\":{\"description\":\"Enable or disable manage certificate validity period.\",\"displayName\":\"Manage certificate validity period\"}},\"classicComputeVMsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of classic compute VMs\",\"displayName\":\"Virtual machines should be migrated to new Azure Resource Manager resources\"}},\"classicStorageAccountsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of classic storage accounts\",\"displayName\":\"Storage accounts should be migrated to new Azure Resource Manager resources\"}},\"clusterProtectionLevelInServiceFabricMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of cluster protection level in Service Fabric\",\"displayName\":\"Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign\"}},\"cognitiveServicesAccountsShouldEnableDataEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"This policy audits any Cognitive Services account not using data encryption. For each Cognitive Services account with storage, should enable data encryption with either customer managed or Microsoft managed key.\",\"displayName\":\"[Deprecated]: Cognitive Services accounts should enable data encryption\"}},\"cognitiveServicesAccountsShouldEnableDataEncryptionWithACustomerManagedKeyMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about customer-managed key encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Cognitive Services accounts should enable data encryption with a customer-managed key\"}},\"cognitiveServicesAccountsShouldRestrictNetworkAccessMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Network access to Cognitive Services accounts should be restricted. Configure network rules so only applications from allowed networks can access the Cognitive Services account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges.\",\"displayName\":\"Cognitive Services accounts should restrict network access\"}},\"cognitiveServicesAccountsShouldUseCustomerOwnedStorageOrEnableDataEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"This policy audits any Cognitive Services account not using customer owned storage nor data encryption. For each Cognitive Services account with storage, use either customer owned storage or enable data encryption.\",\"displayName\":\"[Deprecated]: Cognitive Services accounts should use customer owned storage or enable data encryption\"}},\"containerBenchmarkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable container benchmark monitoring\",\"displayName\":\"[Deprecated]: Vulnerabilities in container security configurations should be remediated\"}},\"containerRegistriesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about customer-managed key encryption at https://aka.ms/acr/CMK.\",\"displayName\":\"Container registries should be encrypted with a customer-managed key\"}},\"containerRegistriesShouldNotAllowUnrestrictedNetworkAccessMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure container registries by default accept connections over the internet from hosts on any network. To protect your registries from potential threats, allow access from only specific public IP addresses or address ranges. If your registry doesn't have an IP/firewall rule or a configured virtual network, it will appear in the unhealthy resources. Learn more about Container Registry network rules here: https://aka.ms/acr/portal/public-network and here https://aka.ms/acr/vnet.\",\"displayName\":\"Container registries should not allow unrestricted network access\"}},\"containerRegistriesShouldUsePrivateLinkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network.By mapping private endpoints to your container registries instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/acr/private-link.\",\"displayName\":\"Container registries should use private link\"}},\"containerRegistryAdvancedThreatProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable Azure Defender for container registries\",\"displayName\":\"[Deprecated]: Azure Defender for container registries should be enabled\"}},\"containerRegistryVulnerabilityAssessmentEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable monitoring of Azure container registries by Microsoft Defender for Cloud vulnerability assessment (powered by Qualys)\",\"displayName\":\"[Deprecated]: Vulnerabilities in Azure Container Registry images should be remediated\"}},\"containersAdvancedThreatProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Microsoft Defender for Containers\",\"displayName\":\"Microsoft Defender for Containers should be enabled\"}},\"diagnosticLogsInAppServicesShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Audit enabling of resource logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised\",\"displayName\":\"Resource logs in App Services should be enabled\"}},\"diagnosticsLogsInAppServiceMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of resource logs in Azure App Services\",\"displayName\":\"[Deprecated]: Monitor resource logs in Azure App Services\"}},\"diagnosticsLogsInBatchAccountMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Batch accounts\",\"displayName\":\"Resource logs in Batch accounts should be enabled\"}},\"diagnosticsLogsInBatchAccountRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) for logs in Batch accounts\"}},\"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Data Lake Analytics accounts\",\"displayName\":\"Resource logs in Data Lake Analytics should be enabled\"}},\"diagnosticsLogsInDataLakeAnalyticsRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Data Lake Analytics accounts\"}},\"diagnosticsLogsInDataLakeStoreMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Data Lake Store accounts\",\"displayName\":\"Resource logs in Azure Data Lake Store should be enabled\"}},\"diagnosticsLogsInDataLakeStoreRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Data Lake Store accounts\"}},\"diagnosticsLogsInEventHubMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Event Hub accounts\",\"displayName\":\"Resource logs in Event Hub should be enabled\"}},\"diagnosticsLogsInEventHubRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Event Hub accounts\"}},\"diagnosticsLogsInIoTHubMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in IoT Hubs\",\"displayName\":\"Resource logs in IoT Hub should be enabled\"}},\"diagnosticsLogsInIoTHubRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in IoT Hub accounts\"}},\"diagnosticsLogsInKeyVaultMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Key Vault vaults\",\"displayName\":\"Resource logs in Key Vault should be enabled\"}},\"diagnosticsLogsInKeyVaultRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Key Vault vaults\"}},\"diagnosticsLogsInKubernetesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Kubernetes managed clusters. Enabling Azure Kubernetes Service's resource logs can help recreate activity trails when investigating future security incidents\",\"displayName\":\"Resource logs in Azure Kubernetes Service should be enabled\"}},\"diagnosticsLogsInKubernetesRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Kubernetes managed clusters\"}},\"diagnosticsLogsInLogicAppsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Logic Apps workflows\",\"displayName\":\"Resource logs in Logic Apps should be enabled\"}},\"diagnosticsLogsInLogicAppsRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Logic Apps workflows\"}},\"diagnosticsLogsInRedisCacheMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Azure Redis Cache\",\"displayName\":\"Only secure connections to your Redis Cache should be enabled\"}},\"diagnosticsLogsInSearchServiceMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Azure Search service\",\"displayName\":\"Resource logs in Search services should be enabled\"}},\"diagnosticsLogsInSearchServiceRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Azure Search service\"}},\"diagnosticsLogsInSelectiveAppServicesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of resource logs in Azure App Services\",\"displayName\":\"[Deprecated]: Resource logs in App Services should be enabled\"}},\"diagnosticsLogsInServiceBusMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Service Bus\",\"displayName\":\"Resource logs in Service Bus should be enabled\"}},\"diagnosticsLogsInServiceBusRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Service Bus\"}},\"diagnosticsLogsInServiceFabricMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of resource logs in Service Fabric\",\"displayName\":\"[Deprecated]: Resource logs in Virtual Machine Scale Sets should be enabled\"}},\"diagnosticsLogsInStreamAnalyticsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of resource logs in Stream Analytics\",\"displayName\":\"Resource logs in Azure Stream Analytics should be enabled\"}},\"diagnosticsLogsInStreamAnalyticsRetentionDays\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"The required resource logs retention period in days\",\"displayName\":\"Required retention (in days) of logs in Stream Analytics\"}},\"disableIPForwardingMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of IP forwarding on virtual machines\",\"displayName\":\"IP Forwarding on your virtual machine should be disabled\"}},\"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable the monitoring of network access to storage account\",\"displayName\":\"Audit unrestricted network access to storage accounts\"}},\"disallowPublicBlobAccessEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Enable or disable reporting of Storage Accounts that allow public access\",\"displayName\":\"Storage account public access should be disallowed\"}},\"diskEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring for VM disk encryption\",\"displayName\":\"[Deprecated]: Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources\"}},\"emailNotificationForHighSeverityAlertsShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"To ensure the relevant people in your organization are notified when there is a potential security breach in one of your subscriptions, enable email notifications for high severity alerts in Security Center.\",\"displayName\":\"Email notification for high severity alerts should be enabled\"}},\"emailNotificationToSubscriptionOwnerForHighSeverityAlertsShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"To ensure your subscription owners are notified when there is a potential security breach in their subscription, set email notifications to subscription owners for high severity alerts in Security Center.\",\"displayName\":\"Email notification to subscription owner for high severity alerts should be enabled\"}},\"encryptionOfAutomationAccountMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of automation account encryption\",\"displayName\":\"Automation account variables should be encrypted\"}},\"endpointProtectionHealthIssuesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Resolve endpoint protection health issues on your virtual machines to protect them from latest threats and vulnerabilities. Microsoft Defender for Cloud supported endpoint protection solutions are documented here - https://docs.microsoft.com/azure/security-center/security-center-services?tabs=features-windows#supported-endpoint-protection-solutions. Endpoint protection assessment is documented here - https://docs.microsoft.com/azure/security-center/security-center-endpoint-protection.\",\"displayName\":\"[Deprecated]: Endpoint protection health issues should be resolved on your machines\"}},\"endpointProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable endpoint protection monitoring\",\"displayName\":\"[Deprecated]: Monitor missing Endpoint Protection in Microsoft Defender for Cloud\"}},\"enforceSSLConnectionShouldBeEnabledForMysqlDatabaseServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Enforce SSL connection should be enabled for MySQL database servers\"}},\"enforceSSLConnectionShouldBeEnabledForPostgresqlDatabaseServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Enforce SSL connection should be enabled for PostgreSQL database servers\"}},\"ensureAPIAppHasClientCertificatesIncomingClientCertificatesSetToOnMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\",\"displayName\":\"[Deprecated]: Ensure API app has Client Certificates Incoming client certificates set to On\"}},\"ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\"displayName\":\"[Deprecated]: SQL Managed Instance TDE protector should be encrypted with your own key\"}},\"ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyWithDenyMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\"displayName\":\"SQL Managed Instance TDE protector should be encrypted with your own key\"}},\"ensureServerTDEIsEncryptedWithYourOwnKeyMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\"displayName\":\"[Deprecated]: SQL server TDE protector should be encrypted with your own key\"}},\"ensureServerTDEIsEncryptedWithYourOwnKeyWithDenyMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\"displayName\":\"SQL server TDE protector should be encrypted with your own key\"}},\"ensureThatJavaVersionIsTheLatestIfUsedAsAPartOfTheApiAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for Java either due to security flaws or to include additional functionality. Using the latest Python version for API apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that Java version is the latest if used as a part of the API app\"}},\"ensureThatJavaVersionIsTheLatestIfUsedAsAPartOfTheFunctionAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for Function apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that Java version is the latest if used as a part of the Function app\"}},\"ensureThatJavaVersionIsTheLatestIfUsedAsAPartOfTheWebAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that Java version is the latest if used as a part of the Web app\"}},\"ensureThatPHPVersionIsTheLatestIfUsedAsAPartOfTheApiAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for API apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that PHP version is the latest if used as a part of the API app\"}},\"ensureThatPHPVersionIsTheLatestIfUsedAsAPartOfTheWEBAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that PHP version is the latest if used as a part of the WEB app\"}},\"ensureThatPythonVersionIsTheLatestIfUsedAsAPartOfTheApiAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest Python version for API apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that Python version is the latest if used as a part of the API app\"}},\"ensureThatPythonVersionIsTheLatestIfUsedAsAPartOfTheFunctionAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest Python version for Function apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that Python version is the latest if used as a part of the Function app\"}},\"ensureThatPythonVersionIsTheLatestIfUsedAsAPartOfTheWebAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\"displayName\":\"[Deprecated]: Ensure that Python version is the latest if used as a part of the Web app\"}},\"ensureWEBAppHasClientCertificatesIncomingClientCertificatesSetToOnMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\",\"displayName\":\"[Deprecated]: Ensure WEB app has Client Certificates Incoming client certificates set to On\"}},\"excludedImagesInKubernetesCluster\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of InitContainers and Containers to exclude from Kubernetes container related policy evaluation. It will apply to all container related policies except 'Container images should be deployed from trusted registries only' and 'Kubernetes clusters should gate deployment of vulnerable images'. The identifier is the image of container. Prefix-matching can be signified with `*`. For example: `myregistry.azurecr.io/istio:*`. It is recommended that users use the fully-qualified Docker image name (e.g. start with a domain name) in order to avoid unexpectedly exempting images from an untrusted repository.\",\"displayName\":\"Kubernetes image to exclude from monitoring of all container related polices\"}},\"fTPSOnlyShouldBeRequiredInYourAPIAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable FTPS enforcement for enhanced security\",\"displayName\":\"[Deprecated]: FTPS only should be required in your API App\"}},\"fTPSOnlyShouldBeRequiredInYourFunctionAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable FTPS enforcement for enhanced security\",\"displayName\":\"FTPS only should be required in your Function App\"}},\"fTPSShouldBeRequiredInYourWebAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable FTPS enforcement for enhanced security\",\"displayName\":\"FTPS should be required in your Web App\"}},\"firewallShouldBeEnabledOnKeyVaultMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Key vault's firewall prevents unauthorized traffic from reaching your key vault and provides an additional layer of protection for your secrets. Enable the firewall to make sure that only traffic from allowed networks can access your key vault.\",\"displayName\":\"Firewall should be enabled on Key Vault\"}},\"functionAppAuditFtpsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable FTPS enforcement for enhanced security\",\"displayName\":\"[Deprecated]: FTPS should be required in your Function App\"}},\"functionAppConfigureIPRestrictionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of IP restrictions for Function App\",\"displayName\":\"[Deprecated]: Monitor Configure IP restrictions for Function App\"}},\"functionAppDisableRemoteDebuggingMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of remote debugging for Function App\",\"displayName\":\"Remote debugging should be turned off for Function App\"}},\"functionAppDisableWebSocketsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of web sockets for Function App\",\"displayName\":\"[Deprecated]: Monitor disable web sockets for Function App\"}},\"functionAppEnforceHttpsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of the use of HTTPS in function App\",\"displayName\":\"[Deprecated]: Function App should only be accessible over HTTPS\"}},\"functionAppEnforceHttpsMonitoringEffectV2\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of the use of HTTPS in function App V2\",\"displayName\":\"Function App should only be accessible over HTTPS V2\"}},\"functionAppRequireLatestTlsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Upgrade to the latest TLS version\",\"displayName\":\"[Deprecated]: Latest TLS version should be used in your Function App\"}},\"functionAppRestrictCORSAccessMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of CORS restrictions for API Function\",\"displayName\":\"CORS should not allow every resource to access your Function App\"}},\"functionAppUseManagedIdentityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Use a managed identity for enhanced authentication security\",\"displayName\":\"[Deprecated]: A managed identity should be used in your Function App\"}},\"functionAppUsedCustomDomainsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of custom domain use in Function App\",\"displayName\":\"[Deprecated]: Monitor the custom domain use in Function App\"}},\"functionAppsShouldHaveClientCertificatesEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Client certificates allow for the app to request a certificate for incoming requests. Only clients with valid certificates will be able to reach the app.\",\"displayName\":\"[Deprecated]: Function apps should have 'Client Certificates (Incoming client certificates)' enabled\"}},\"gcExtOnVMWithNoSAMIMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Virtual machines' Guest Configuration extension should be deployed with system-assigned managed identity\",\"displayName\":\"Virtual machines' Guest Configuration extension should be deployed with system-assigned managed identity\"}},\"gcLinuxDiskEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the guest configuration monitoring for disk encryption on Linux machines\",\"displayName\":\"Linux virtual machines should enable Azure Disk Encryption or EncryptionAtHost\"}},\"gcWindowsDiskEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the guest configuration monitoring for disk encryption on Windows machines\",\"displayName\":\"Windows virtual machines should enable Azure Disk Encryption or EncryptionAtHost\"}},\"georedundantBackupShouldBeEnabledForAzureDatabaseForMariadbMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MariaDB allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.\",\"displayName\":\"Georedundant backup should be enabled for Azure Database for MariaDB\"}},\"georedundantBackupShouldBeEnabledForAzureDatabaseForMysqlMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.\",\"displayName\":\"Georedundant backup should be enabled for Azure Database for MySQL\"}},\"georedundantBackupShouldBeEnabledForAzureDatabaseForPostgresqlMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.\",\"displayName\":\"Georedundant backup should be enabled for Azure Database for PostgreSQL\"}},\"identityDesignateLessThanOwnersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of maximum owners in subscription\",\"displayName\":\"A maximum of 3 owners should be designated for your subscription\"}},\"identityDesignateMoreThanOneOwnerMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of minimum owners in subscription\",\"displayName\":\"There should be more than one owner assigned to your subscription\"}},\"identityEnableMFAForAccountsWithOwnerPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of MFA for accounts with owner permissions in subscription\",\"displayName\":\"[Deprecated]: Accounts with owner permissions on Azure resources should be MFA enabled\"}},\"identityEnableMFAForAccountsWithReadPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of MFA for accounts with read permissions in subscription\",\"displayName\":\"[Deprecated]: Accounts with read permissions on Azure resources should be MFA enabled\"}},\"identityEnableMFAForAccountsWithWritePermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of MFA for accounts with write permissions in subscription\",\"displayName\":\"[Deprecated]: Accounts with write permissions on Azure resources should be MFA enabled\"}},\"identityEnableMFAForOwnerPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of MFA for accounts with owner permissions in subscription\",\"displayName\":\"[Deprecated]: MFA should be enabled on accounts with owner permissions on your subscription\"}},\"identityEnableMFAForReadPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of MFA for accounts with read permissions in subscription\",\"displayName\":\"[Deprecated]: MFA should be enabled on accounts with read permissions on your subscription\"}},\"identityEnableMFAForWritePermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of MFA for accounts with write permissions in subscription\",\"displayName\":\"[Deprecated]: MFA should be enabled accounts with write permissions on your subscription\"}},\"identityRemoveBlockedAccountsWithOwnerPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of deprecated acounts with owner permissions in subscription\",\"displayName\":\"[Deprecated]: Blocked accounts with owner permissions on Azure resources should be removed\"}},\"identityRemoveBlockedAccountsWithReadWritePermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of deprecated acounts in subscription\",\"displayName\":\"[Deprecated]: Blocked accounts with read and write permissions on Azure resources should be removed\"}},\"identityRemoveDeprecatedAccountMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of deprecated acounts in subscription\",\"displayName\":\"Deprecated accounts should be removed from your subscription\"}},\"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of deprecated acounts with owner permissions in subscription\",\"displayName\":\"Deprecated accounts with owner permissions should be removed from your subscription\"}},\"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of external acounts with owner permissions in subscription\",\"displayName\":\"External accounts with owner permissions should be removed from your subscription\"}},\"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of external acounts with read permissions in subscription\",\"displayName\":\"External accounts with read permissions should be removed from your subscription\"}},\"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of external acounts with write permissions in subscription\",\"displayName\":\"External accounts with write permissions should be removed from your subscription\"}},\"identityRemoveGuestAccountsWithOwnerPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of external acounts with owner permissions in subscription\",\"displayName\":\"[Deprecated]: Guest accounts with owner permissions on Azure resources should be removed\"}},\"identityRemoveGuestAccountsWithReadPermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of external acounts with read permissions in subscription\",\"displayName\":\"[Deprecated]: Guest accounts with read permissions on Azure resources should be removed\"}},\"identityRemoveGuestAccountsWithWritePermissionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of external acounts with write permissions in subscription\",\"displayName\":\"[Deprecated]: Guest accounts with write permissions on Azure resources should be removed\"}},\"installEndpointProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"To protect your machines from threats and vulnerabilities, install a supported endpoint protection solution.\",\"displayName\":\"[Deprecated]: Endpoint protection should be installed on your machines\"}},\"installLogAnalyticsAgentOnVmMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"This policy audits any Windows/Linux virtual machines (VMs) if the Log Analytics agent is not installed which Security Center uses to monitor for security vulnerabilities and threats\",\"displayName\":\"[Deprecated]: Log Analytics agent should be installed on your virtual machine for Microsoft Defender for Cloud monitoring\"}},\"installLogAnalyticsAgentOnVmssMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Security Center collects data from your Azure virtual machines (VMs) to monitor for security vulnerabilities and threats.\",\"displayName\":\"[Deprecated]: Log Analytics agent should be installed on your virtual machine scale sets for Microsoft Defender for Cloud monitoring\"}},\"jitNetworkAccessMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of network just-in-time access\",\"displayName\":\"Management ports of virtual machines should be protected with just-in-time network access control\"}},\"keyVaultsAdvancedDataSecurityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Azure Defender for Key Vault\",\"displayName\":\"Azure Defender for Key Vault should be enabled\"}},\"keyVaultsShouldHavePurgeProtectionEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Malicious deletion of a key vault can lead to permanent data loss. A malicious insider in your organization can potentially delete and purge key vaults. Purge protection protects you from insider attacks by enforcing a mandatory retention period for soft deleted key vaults. No one inside your organization or Microsoft will be able to purge your key vaults during the soft delete retention period.\",\"displayName\":\"Key vaults should have purge protection enabled\"}},\"keyVaultsShouldHaveSoftDeleteEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the key vault. Accidental deletion of a key vault can lead to permanent data loss. Soft delete allows you to recover an accidentally deleted key vault for a configurable retention period.\",\"displayName\":\"Key vaults should have soft delete enabled\"}},\"keysExpirationSetEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable key vault keys should have expiration dates set.\",\"displayName\":\"Key Vault keys should have expiration dates set\"}},\"kubernetesClustersShouldBeAccessibleOnlyOverHTTPSExcludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation of HTTPS only access. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from evaluation of HTTPS only access\"}},\"kubernetesClustersShouldBeAccessibleOnlyOverHTTPSLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select evaluation of HTTPS only access\"}},\"kubernetesClustersShouldBeAccessibleOnlyOverHTTPSMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc\",\"displayName\":\"Kubernetes clusters should be accessible only over HTTPS\"}},\"kubernetesClustersShouldBeAccessibleOnlyOverHTTPSNamespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"deprecated\":true,\"description\":\"This parameter is deprecated. The policy is applied to all Kubernetes resources in all Kubernetes namespaces.\",\"displayName\":\"[Deprecated]: Namespace inclusions\"}},\"kubernetesRunningImagesVulnerabilityAssessmentEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable monitoring of Kubernetes Service clusters by Defender for Containers running images vulnerability assessment\",\"displayName\":\"[Deprecated]: Vulnerabilities in running images should be remediated\"}},\"kubernetesRunningImagesVulnerabilityMDVMAssessmentEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable monitoring of Kubernetes Service clusters by Defender for Containers running images vulnerability assessment\",\"displayName\":\"Vulnerabilities in running images should be remediated\"}},\"kubernetesServiceAdvancedThreatProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable Azure Defender for Kubernetes\",\"displayName\":\"[Deprecated]: Azure Defender for Kubernetes should be enabled\"}},\"kubernetesServiceAuthorizedIPRangesEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of Kubernetes Services without Authorized IP Ranges enabled\",\"displayName\":\"Authorized IP ranges should be defined on Kubernetes Services\"}},\"kubernetesServicePspEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Kubernetes Services without Pod Security Policy enabled\",\"displayName\":\"[Deprecated]: Pod Security Policies should be defined on Kubernetes Services\"}},\"kubernetesServiceRbacEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of Kubernetes Services without RBAC enabled\",\"displayName\":\"Role-Based Access Control (RBAC) should be used on Kubernetes Services\"}},\"kubernetesServiceVersionUpToDateMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of the Kubernetes Services with versions that contain known vulnerabilities\",\"displayName\":\"[Deprecated]: Kubernetes Services should be upgraded to a non vulnerable Kubernetes version\"}},\"latestTLSVersionShouldBeUsedInYourAPIAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Upgrade to the latest TLS version\",\"displayName\":\"[Deprecated]: Latest TLS version should be used in your API App\"}},\"latestTLSVersionShouldBeUsedInYourFunctionAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Upgrade to the latest TLS version\",\"displayName\":\"Latest TLS version should be used in your Function App\"}},\"latestTLSVersionShouldBeUsedInYourWebAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Upgrade to the latest TLS version\",\"displayName\":\"Latest TLS version should be used in your Web App\"}},\"linuxGuestConfigBaselinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable virtual machines reporting Linux Baselines in Guest Config\",\"displayName\":\"Vulnerabilities in security configuration on your Linux machines should be remediated (powered by Guest Config)\"}},\"managedIdentityShouldBeUsedInYourAPIAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Use a managed identity for enhanced authentication security\",\"displayName\":\"[Deprecated]: Managed identity should be used in your API App\"}},\"managedIdentityShouldBeUsedInYourFunctionAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use a managed identity for enhanced authentication security\",\"displayName\":\"Managed identity should be used in your Function App\"}},\"managedIdentityShouldBeUsedInYourWebAppMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use a managed identity for enhanced authentication security\",\"displayName\":\"Managed identity should be used in your Web App\"}},\"memoryAndCPULimitsInKubernetesClusterEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of containers' CPU and memory limits in Kubernetes clusters\",\"displayName\":\"Containers' CPU and memory limits should be enforced\"}},\"memoryAndCPULimitsInKubernetesClusterLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of memory and CPU limits\"}},\"memoryAndCPULimitsInKubernetesClusterNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation of memory and CPU limits in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of memory and CPU limits\"}},\"memoryInKubernetesClusterLimit\":{\"type\":\"String\",\"defaultValue\":\"64Gi\",\"metadata\":{\"description\":\"The maximum memory bytes allowed for a container. E.g. 1Gi. For more information, please refer https://aka.ms/k8s-policy-pod-limits\",\"displayName\":\"Max allowed memory bytes in Kubernetes cluster\"}},\"metricAlertsInBatchAccountMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of metric alerts in Batch accounts\",\"displayName\":\"[Deprecated]: Metric alert rules should be configured on Batch accounts\"}},\"namespaceAuthorizationRulesInServiceBusMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Service Bus namespace authorization rules\",\"displayName\":\"[Deprecated]: All authorization rules except RootManageSharedAccessKey should be removed from Service Bus namespace\"}},\"networkSecurityGroupsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable monitoring of network security groups with permissive rules\",\"displayName\":\"[Deprecated]: Monitor network security groups\"}},\"networkSecurityGroupsOnInternalVirtualMachinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable monitoring of NSGs on VMs\",\"displayName\":\"Non-internet-facing virtual machines should be protected with network security groups\"}},\"networkSecurityGroupsOnSubnetsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable monitoring of NSGs on subnets\",\"displayName\":\"Network Security Groups on the subnet level should be enabled\"}},\"networkSecurityGroupsOnVirtualMachinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable monitoring of NSGs on VMs\",\"displayName\":\"Internet-facing virtual machines should be protected with network security groups\"}},\"networkWatcherShouldBeEnabledListOfLocations\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"deprecated\":true,\"description\":\"To see a complete list of regions, run the PowerShell command Get-AzLocation\",\"displayName\":\"[Deprecated]: List of regions where Network Watcher should be enabled\",\"strongType\":\"location\"}},\"networkWatcherShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Network Watcher is a regional service that enables you to monitor and diagnose conditions at a network scenario level in, to, and from Azure. Scenario level monitoring enables you to diagnose problems at an end to end network level view. Network diagnostic and visualization tools available with Network Watcher help you understand, diagnose, and gain insights to your network in Azure.\",\"displayName\":\"Network Watcher should be enabled\"}},\"networkWatcherShouldBeEnabledResourceGroupName\":{\"type\":\"String\",\"defaultValue\":\"NetworkWatcherRG\",\"metadata\":{\"description\":\"Name of the resource group where Network Watchers are located\",\"displayName\":\"Name of the resource group for Network Watcher\"}},\"nextGenerationFirewallMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable overly permissive inbound NSG rules monitoring.\",\"displayName\":\"All network ports should be restricted on network security groups associated to your virtual machine\"}},\"privateEndpointConnectionsOnAzureSQLDatabaseShouldBeEnabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Private endpoint connections enforce secure communication by enabling private connectivity to Azure SQL Database.\",\"displayName\":\"Private endpoint connections on Azure SQL Database should be enabled\"}},\"privateEndpointShouldBeConfiguredForKeyVaultMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Private link provides a way to connect Key Vault to your Azure resources without sending traffic over the public internet. Private link provides defense in depth protection against data exfiltration.\",\"displayName\":\"Private endpoint should be configured for Key Vault\"}},\"privateEndpointShouldBeEnabledForMariadbServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for MariaDB. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\"displayName\":\"Private endpoint should be enabled for MariaDB servers\"}},\"privateEndpointShouldBeEnabledForMysqlServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for MySQL. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\"displayName\":\"Private endpoint should be enabled for MySQL servers\"}},\"privateEndpointShouldBeEnabledForPostgresqlServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for PostgreSQL. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\"displayName\":\"Private endpoint should be enabled for PostgreSQL servers\"}},\"privilegedContainerLabelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector to select monitoring of privileged containers\"}},\"privilegedContainerNamespaceExclusion\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azuredefender\",\"mdc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from evaluation of privileged containers in Kubernetes clusters. To list multiple namespaces, use semicolons (;) to separate them. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Kubernetes namespaces to exclude from monitoring of privileged containers\"}},\"privilegedContainersShouldBeAvoidedEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of privileged containers in Kubernetes clusters\",\"displayName\":\"Privileged containers should be avoided\"}},\"publicNetworkAccessOnAzureSQLDatabaseShouldBeDisabledMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.\",\"displayName\":\"Public network access on Azure SQL Database should be disabled\"}},\"publicNetworkAccessShouldBeDisabledForCognitiveServicesAccountsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"This policy audits any Cognitive Services account in your environment with public network access enabled. Public network access should be disabled so that only connections from private endpoints are allowed.\",\"displayName\":\"[Deprecated]: Public network access should be disabled for Cognitive Services accounts\"}},\"publicNetworkAccessShouldBeDisabledForMariaDbServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Disable the public network access property to improve security and ensure your Azure Database for MariaDB can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range, and denies all logins that match IP or virtual network-based firewall rules.\",\"displayName\":\"Public network access should be disabled for MariaDB servers\"}},\"publicNetworkAccessShouldBeDisabledForMySqlServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Disable the public network access property to improve security and ensure your Azure Database for MySQL can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range, and denies all logins that match IP or virtual network-based firewall rules.\",\"displayName\":\"Public network access should be disabled for MySQL servers\"}},\"publicNetworkAccessShouldBeDisabledForPostgreSqlServersMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Disable the public network access property to improve security and ensure your Azure Database for PostgreSQL can only be accessed from a private endpoint. This configuration disables access from any public address space outside of Azure IP range, and denies all logins that match IP or virtual network-based firewall rules.\",\"displayName\":\"Public network access should be disabled for PostgreSQL servers\"}},\"resolveLogAnalyticsHealthIssuesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Security Center uses the Log Analytics agent, formerly known as the Microsoft Monitoring Agent (MMA). To make sure your virtual machines are successfully monitored, you need to make sure the agent is installed on the virtual machines and properly collects security events to the configured workspace.\",\"displayName\":\"[Deprecated]: Log Analytics agent health issues should be resolved on your machines\"}},\"restrictAccessToAppServicesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of permissive network access to app-services\",\"displayName\":\"[Deprecated]: Access to App Services should be restricted\"}},\"restrictAccessToManagementPortsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of open management ports on Virtual Machines\",\"displayName\":\"Management ports should be closed on your virtual machines\"}},\"sQLServersShouldBeConfiguredWithAuditingRetentionDaysGreaterThan90DaysMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Audit SQL servers configured with an auditing retention period of less than 90 days.\",\"displayName\":\"SQL servers should be configured with auditing retention days greater than 90 days\"}},\"secretsExpirationSetEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable key vault secrets should have expiration dates set.\",\"displayName\":\"Key Vault secrets should have expiration dates set\"}},\"secureTransferToStorageAccountMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of secure transfer to storage account\",\"displayName\":\"Secure transfer to storage accounts should be enabled\"}},\"serverSqlDbVulnerabilityAssesmentMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"SQL Vulnerability assessment scans your database for security vulnerabilities, and exposes any deviations from best practices such as misconfigurations, excessive permissions, and unprotected sensitive data. Resolving the vulnerabilities found can greatly improve your database security posture.\",\"displayName\":\"SQL servers on machines should have vulnerability findings resolved\"}},\"serverVulnerabilityAssessmentEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the detection of virtual machine vulnerabilities by Microsoft Defender for Cloud vulnerability assessment\",\"displayName\":\"A vulnerability assessment solution should be enabled on your virtual machines\"}},\"severity\":{\"type\":\"Object\",\"defaultValue\":{\"High\":0,\"Low\":0,\"Medium\":0},\"metadata\":{\"deprecated\":true,\"description\":\"The number of allowed findings per severity for an image. e.g. \\\"{\\\"High\\\":0,\\\"Medium\\\":3,\\\"Low\\\":10}\\\"\",\"displayName\":\"[Deprecated]: Severity threshold for excluding gating of image vulnerabilities in Kubernetes cluster\"}},\"sqlAuditingMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of unaudited SQL databases\",\"displayName\":\"[Deprecated]: Monitor unaudited SQL servers in Microsoft Defender for Cloud\"}},\"sqlDbDataClassificationMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of sensitive data classification in databases.\",\"displayName\":\"[Deprecated]: Sensitive data in your SQL databases should be classified\"}},\"sqlDbEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of unencrypted SQL databases\",\"displayName\":\"Transparent Data Encryption on SQL databases should be enabled\"}},\"sqlDbVulnerabilityAssesmentMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of vulnerability assessment scan results and recommendations for how to remediate database vulnerabilities.\",\"displayName\":\"SQL databases should have vulnerability findings resolved\"}},\"sqlEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of unencrypted SQL databases\",\"displayName\":\"[Deprecated]: Monitor unencrypted SQL databases in Microsoft Defender for Cloud\"}},\"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable auditing that 'email notification to admins and subscription owners' is enabled in SQL Managed Instance advanced threat protection settings. This setting ensures that any detections of anomalous activities on SQL Managed Instance are reported as soon as possible to the admins.\",\"displayName\":\"[Deprecated]: Email notifications to admins and subscription owners should be enabled in SQL Managed Instance advanced data security settings\"}},\"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring that advanced data security settings for SQL Managed Instance contain at least one email address to receive security alerts.\",\"displayName\":\"[Deprecated]: Advanced data security settings for SQL Managed Instance should contain an email address to receive security alerts\"}},\"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of each SQL Managed Instance without advanced data security.\",\"displayName\":\"Azure Defender for SQL should be enabled for unprotected SQL Managed Instances\"}},\"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable auditing that 'email notification to admins and subscription owners' is enabled in the SQL Server advanced threat protection settings. This ensures that any detections of anomalous activities on SQL server are reported as soon as possible to the admins.\",\"displayName\":\"[Deprecated]: Email notifications to admins and subscription owners should be enabled in SQL server advanced data security settings\"}},\"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring that advanced data security settings for SQL server contain at least one email address to receive security alerts\",\"displayName\":\"[Deprecated]: Advanced data security settings for SQL server should contain an email address to receive security alerts\"}},\"sqlServerAdvancedDataSecurityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of SQL servers without Advanced Data Security\",\"displayName\":\"Azure Defender for SQL should be enabled for unprotected Azure SQL servers\"}},\"sqlServerAuditingActionsAndGroupsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of auditing policy Action-Groups and Actions setting\",\"displayName\":\"[Deprecated]: SQL Auditing settings should have Action-Groups configured to capture critical activities\"}},\"sqlServerAuditingMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of unaudited SQL Servers\",\"displayName\":\"Auditing should be enabled on advanced data security settings on SQL Server\"}},\"sqlServersAdvancedDataSecurityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Azure Defender for Azure SQL Database servers\",\"displayName\":\"Azure Defender for Azure SQL Database servers should be enabled\"}},\"sqlServersVirtualMachinesAdvancedDataSecurityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Azure Defender for SQL servers on Machines\",\"displayName\":\"Azure Defender for SQL servers on machines should be enabled\"}},\"storageAccountShouldUseAPrivateLinkConnectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Private links enforce secure communication, by providing private connectivity to the storage account\",\"displayName\":\"Storage account should use a private link connection\"}},\"storageAccountsAdvancedDataSecurityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable Azure Defender for storage\",\"displayName\":\"[Deprecated]: Azure Defender for Storage should be enabled\"}},\"storageAccountsShouldRestrictNetworkAccessUsingVirtualNetworkRulesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Protect your storage accounts from potential threats using virtual network rules as a preferred method instead of IP-based filtering. Disabling IP-based filtering prevents public IPs from accessing your storage accounts.\",\"displayName\":\"Storage accounts should restrict network access using virtual network rules\"}},\"storageAccountsShouldUseCustomerManagedKeyForEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Secure your storage account with greater flexibility using customer-managed keys. When you specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. Using customer-managed keys provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.\",\"displayName\":\"Storage accounts should use customer-managed key for encryption\"}},\"storageEncryptionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of blob encryption for storage accounts\",\"displayName\":\"[Deprecated]: Audit missing blob encryption for storage accounts\"}},\"subscriptionsShouldHaveAContactEmailAddressForSecurityIssuesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"To ensure the relevant people in your organization are notified when there is a potential security breach in one of your subscriptions, set a security contact to receive email notifications from Security Center.\",\"displayName\":\"Subscriptions should have a contact email address for security issues\"}},\"systemConfigurationsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable OS vulnerabilities monitoring (based on a configured baseline)\",\"displayName\":\"[Deprecated]: Vulnerabilities in security configuration on your machines should be remediated\"}},\"systemUpdatesAutoAssessmentModeEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable monitoring of assessment mode\",\"displayName\":\"Machines should be configured to periodically check for missing system updates\"}},\"systemUpdatesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable reporting of system updates\",\"displayName\":\"[Deprecated]: System updates should be installed on your machines\"}},\"systemUpdatesV2MonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable reporting of system updates (powered by Update Center)\",\"displayName\":\"System updates should be installed on your machines (powered by Update Center)\"}},\"threatDetectionTypesOnManagedInstanceMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"It's recommended to enable all Advanced Threat Protection types on your SQL Managed Instance. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\",\"displayName\":\"[Deprecated]: Advanced Threat Protection types should be set to 'All' in SQL Managed Instance advanced data security settings\"}},\"threatDetectionTypesOnServerMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\",\"displayName\":\"[Deprecated]: Advanced Threat Protection types should be set to 'All' in SQL server Advanced Data Security settings\"}},\"updateOsVersionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Keeping the operating system (OS) on the most recent supported version for your cloud service roles enhances the systems security posture.\",\"displayName\":\"[Deprecated]: Operating system version should be the most current version for your cloud service roles\"}},\"useRbacRulesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of using built-in RBAC rules\",\"displayName\":\"Audit usage of custom RBAC rules\"}},\"useServicePrincipalToProtectSubscriptionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"[Deprecated: With Cloud Services (classic) retiring (see https://azure.microsoft.com/updates/cloud-services-retirement-announcement), there will no longer be a need for this assessment as management certificates will be obsolete.] Management certificates allow anyone who authenticates with them to manage the subscription(s) they are associated with. To manage subscriptions more securely, use of service principals with Resource Manager is recommended to limit the impact of a certificate compromise.\",\"displayName\":\"[Deprecated]: Service principals should be used to protect your subscriptions instead of management certificates\"}},\"virtualMachinesAdvancedThreatProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable Azure Defender for servers\",\"displayName\":\"Azure Defender for servers should be enabled\"}},\"vmImageBuilderTemplatesShouldUsePrivateLinkMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Audit VM Image Builder templates that do not have a virtual network configured. When a virtual network is not configured, a public IP is created and used instead which may directly expose resources to the internet and increase the potential attack surface.\",\"displayName\":\"VM Image Builder templates should use private link\"}},\"vmssEndpointProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable virtual machine scale sets endpoint protection monitoring\",\"displayName\":\"[Deprecated]: Endpoint protection solution should be installed on virtual machine scale sets\"}},\"vmssOsVulnerabilitiesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable virtual machine scale sets OS vulnerabilities monitoring\",\"displayName\":\"[Deprecated]: Vulnerabilities in security configuration on your virtual machine scale sets should be remediated\"}},\"vmssSystemUpdatesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable virtual machine scale sets reporting of system updates\",\"displayName\":\"[Deprecated]: System updates on virtual machine scale sets should be installed\"}},\"vnetEnableDDoSProtectionMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of DDoS protection for virtual network\",\"displayName\":\"Azure DDoS Protection should be enabled\"}},\"vulnerabilityAssesmentMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the detection of VM vulnerabilities by a vulnerability assessment solution\",\"displayName\":\"[Deprecated]: Vulnerabilities should be remediated by a Vulnerability Assessment solution\"}},\"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Audit each SQL Managed Instance which doesn't have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\"displayName\":\"Vulnerability assessment should be enabled on SQL Managed Instance\"}},\"vulnerabilityAssessmentOnServerMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Audit Azure SQL servers which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\"displayName\":\"Vulnerability assessment should be enabled on your SQL servers\"}},\"webAppAuditFtpsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable FTPS enforcement for enhanced security\",\"displayName\":\"[Deprecated]: FTPS should be required in your Web App\"}},\"webAppConfigureIPRestrictionsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of IP restrictions for Web App\",\"displayName\":\"[Deprecated]: Monitor Configure IP restrictions for Web App\"}},\"webAppDisableRemoteDebuggingMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of remote debugging for Web App\",\"displayName\":\"Remote debugging should be turned off for Web Application\"}},\"webAppDisableWebSocketsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of web sockets for Web App\",\"displayName\":\"[Deprecated]: Monitor disable web sockets for Web App\"}},\"webAppEnforceHttpsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of the use of HTTPS in Web App\",\"displayName\":\"[Deprecated]: Web Application should only be accessible over HTTPS\"}},\"webAppEnforceHttpsMonitoringEffectV2\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the monitoring of the use of HTTPS in Web App V2\",\"displayName\":\"Web Application should only be accessible over HTTPS V2\"}},\"webAppRequireLatestTlsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Upgrade to the latest TLS version\",\"displayName\":\"[Deprecated]: Latest TLS version should be used in your Web App\"}},\"webAppRestrictCORSAccessMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the monitoring of CORS restrictions for API Web\",\"displayName\":\"CORS should not allow every resource to access your Web Application\"}},\"webAppUseManagedIdentityMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Use a managed identity for enhanced authentication security\",\"displayName\":\"[Deprecated]: A managed identity should be used in your Web App\"}},\"webAppUsedCustomDomainsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of custom domain use in Web App\",\"displayName\":\"[Deprecated]: Monitor the custom domain use in Web App\"}},\"webAppUsedLatestDotNetMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of .NET version in Web App\",\"displayName\":\"[Deprecated]: Monitor use latest .NET in Web App\"}},\"webAppUsedLatestJavaMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Java version in Web App\",\"displayName\":\"[Deprecated]: Monitor use latest Java in Web App\"}},\"webAppUsedLatestNodeJsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Node.js version in Web App\",\"displayName\":\"[Deprecated]: Monitor use latest Node.js in Web App\"}},\"webAppUsedLatestPHPMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of PHP version in Web App\",\"displayName\":\"[Deprecated]: Monitor use latest PHP in Web App\"}},\"webAppUsedLatestPythonMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of Python version in Web App\",\"displayName\":\"[Deprecated]: Monitor use latest Python in Web App\"}},\"webApplicationFirewallMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"deprecated\":true,\"description\":\"Enable or disable the monitoring of unprotected web applications\",\"displayName\":\"[Deprecated]: Web ports should be restricted on Network Security Groups associated to your VM\"}},\"webApplicationFirewallShouldBeEnabledForApplicationGatewayMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.\",\"displayName\":\"Web Application Firewall (WAF) should be enabled for Application Gateway\"}},\"webApplicationFirewallShouldBeEnabledForAzureFrontDoorServiceServiceMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.\",\"displayName\":\"Azure Web Application Firewall should be enabled for Azure Front Door entry-points\"}},\"windowsDefenderExploitGuardMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable virtual machines reporting that Windows Defender Exploit Guard is enabled\",\"displayName\":\"Windows Defender Exploit Guard should be enabled on your Windows virtual machines\"}},\"windowsGuestConfigBaselinesMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable virtual machines reporting Windows Baselines in Guest Config\",\"displayName\":\"Vulnerabilities in security configuration on your Windows machines should be remediated (powered by Guest Config)\"}},\"windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"true\",\"metadata\":{\"description\":\"By selecting this option, you choose to include Arc connected servers in the scope of this policy.\",\"displayName\":\"Include Arc connected servers\"}},\"windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMinimumTLSVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.1\",\"1.2\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"The minimum TLS protocol version that should be enabled. Windows web servers with lower TLS versions will be marked as non-compliant.\",\"displayName\":\"Minimum TLS version\"}},\"windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMonitoringEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"To protect the privacy of information communicated over the Internet, your web servers should use the latest version of the industry-standard cryptographic protocol, Transport Layer Security (TLS). TLS secures communications over a network by using security certificates to encrypt a connection between machines.\",\"displayName\":\"Windows web servers should be configured to use secure communication protocols\"}}}",
            "policy_definition_group": [
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-8",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-8"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-9",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-9"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_NS-10",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_NS-10"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DP-8",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DP-8"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-8",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-8"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IM-9",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IM-9"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PA-8",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PA-8"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PV-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PV-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PV-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PV-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PV-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PV-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PV-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PV-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PV-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PV-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PV-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PV-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_PV-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_PV-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_LT-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_LT-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_LT-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_LT-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_LT-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_LT-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_LT-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_LT-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_LT-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_LT-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_LT-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_LT-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_LT-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_LT-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_AM-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_AM-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_AM-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_AM-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_AM-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_AM-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_AM-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_AM-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_AM-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_AM-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_ES-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_ES-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_ES-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_ES-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_ES-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_ES-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_BR-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_BR-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_BR-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_BR-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_BR-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_BR-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_BR-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_BR-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IR-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IR-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IR-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IR-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IR-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IR-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IR-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IR-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IR-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IR-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IR-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IR-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_IR-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_IR-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DS-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DS-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DS-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DS-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DS-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DS-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DS-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DS-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DS-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DS-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DS-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DS-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_DS-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_DS-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-1",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-1"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-2",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-2"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-3",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-3"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-4",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-4"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-5",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-5"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-6",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-6"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-7",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-7"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-8",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-8"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-9",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-9"
              },
              {
                "additional_metadata_resource_id": "/providers/Microsoft.PolicyInsights/policyMetadata/Azure_Security_Benchmark_v3.0_GS-10",
                "category": "",
                "description": "",
                "display_name": "",
                "name": "Azure_Security_Benchmark_v3.0_GS-10"
              }
            ],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('certificatesValidityPeriodMonitoringEffect')]\"},\"maximumValidityInMonths\":{\"value\":\"[parameters('certificatesValidityPeriodInMonths')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-7"
                ],
                "reference_id": "certificatesValidityPeriodMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('secretsExpirationSetEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-6"
                ],
                "reference_id": "secretsExpirationSet"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('keysExpirationSetEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-6"
                ],
                "reference_id": "keysExpirationSet"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azurePolicyforWindowsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ae89ebca-1c92-4898-ac2c-9f63decb045c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "gcExtOnVMMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('gcExtOnVMWithNoSAMIMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d26f7642-7545-4e18-9b75-8c9bbdee3a9a",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-3",
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "gcExtOnVMWithNoSAMIMonitoring"
              },
              {
                "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"NotAvailableMachineState\":{\"value\":\"Compliant\"},\"effect\":{\"value\":\"[parameters('windowsDefenderExploitGuardMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bed48b13-6647-468e-aa2f-1af1d3f4dd40",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_ES-2"
                ],
                "reference_id": "windowsDefenderExploitGuardMonitoring"
              },
              {
                "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('windowsGuestConfigBaselinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "windowsGuestConfigBaselinesMonitoring"
              },
              {
                "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('linuxGuestConfigBaselinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "linuxGuestConfigBaselinesMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInIoTHubMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInIoTHubRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInIoTHubMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('disableUnrestrictedNetworkToStorageAccountMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "disableUnrestrictedNetworkToStorageAccountMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('useRbacRulesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-7"
                ],
                "reference_id": "useRbacRulesMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInStreamAnalyticsMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInStreamAnalyticsRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInStreamAnalyticsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('secureTransferToStorageAccountMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "secureTransferToStorageAccountMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('aadAuthenticationInSqlServerMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "aadAuthenticationInSqlServerMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInServiceBusMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInServiceBusRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInServiceBusMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('clusterProtectionLevelInServiceFabricMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "clusterProtectionLevelInServiceFabricMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('aadAuthenticationInServiceFabricMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "aadAuthenticationInServiceFabricMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInSearchServiceMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInSearchServiceRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInSearchServiceMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInRedisCacheMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "diagnosticsLogsInRedisCacheMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInLogicAppsMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInLogicAppsRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInLogicAppsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInKeyVaultMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInKeyVaultRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-8",
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInKeyVaultMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInEventHubMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInEventHubRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInEventHubMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeStoreMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeStoreRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInDataLakeStoreMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeAnalyticsMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeAnalyticsRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInDataLakeAnalyticsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('classicStorageAccountsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_AM-2"
                ],
                "reference_id": "classicStorageAccountsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('classicComputeVMsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_AM-2"
                ],
                "reference_id": "classicComputeVMsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInBatchAccountMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInBatchAccountRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInBatchAccountMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('encryptionOfAutomationAccountMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "encryptionOfAutomationAccountMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlDbEncryptionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "sqlDbEncryptionMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlServerAuditingMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "sqlServerAuditingMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('systemUpdatesV2MonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f85bf3e0-d513-442e-89c3-1784ad63382b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-6"
                ],
                "reference_id": "systemUpdatesV2Monitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('systemUpdatesAutoAssessmentModeEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bd876905-5b84-4f73-ab2d-2e7a7c4568d9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-6"
                ],
                "reference_id": "systemUpdatesAutoAssessmentMode"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('jitNetworkAccessMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-3",
                  "Azure_Security_Benchmark_v3.0_PA-2"
                ],
                "reference_id": "jitNetworkAccessMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('networkSecurityGroupsOnSubnetsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-1"
                ],
                "reference_id": "networkSecurityGroupsOnSubnetsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('networkSecurityGroupsOnVirtualMachinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-1"
                ],
                "reference_id": "networkSecurityGroupsOnVirtualMachinesMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('networkSecurityGroupsOnInternalVirtualMachinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-1"
                ],
                "reference_id": "networkSecurityGroupsOnInternalVirtualMachinesMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('serverVulnerabilityAssessmentEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-5"
                ],
                "reference_id": "serverVulnerabilityAssessment"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('nextGenerationFirewallMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-1"
                ],
                "reference_id": "nextGenerationFirewallMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlDbVulnerabilityAssesmentMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-6"
                ],
                "reference_id": "sqlDbVulnerabilityAssesmentMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('serverSqlDbVulnerabilityAssesmentMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6ba6d016-e7c3-4842-b8f2-4992ebc0d72d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-6"
                ],
                "reference_id": "serverSqlDbVulnerabilityAssesmentMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('identityDesignateLessThanOwnersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-1"
                ],
                "reference_id": "identityDesignateLessThanOwnersMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('identityDesignateMoreThanOneOwnerMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-1"
                ],
                "reference_id": "identityDesignateMoreThanOneOwnerMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0cfea604-3201-4e14-88fc-fae4c427a6c5",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-1",
                  "Azure_Security_Benchmark_v3.0_PA-4"
                ],
                "reference_id": "identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringNew"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('identityRemoveDeprecatedAccountMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8d7e1fde-fe26-4b5f-8108-f8e432cbc2be",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-4"
                ],
                "reference_id": "identityRemoveDeprecatedAccountMonitoringNew"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/339353f6-2387-4a45-abe4-7f529d121046",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-1",
                  "Azure_Security_Benchmark_v3.0_PA-4"
                ],
                "reference_id": "identityRemoveExternalAccountWithOwnerPermissionsMonitoringNew"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('identityRemoveExternalAccountWithWritePermissionsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94e1c2ac-cbbe-4cac-a2b5-389c812dee87",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-4"
                ],
                "reference_id": "identityRemoveExternalAccountWithWritePermissionsMonitoringNew"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('identityRemoveExternalAccountWithReadPermissionsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e9ac8f8e-ce22-4355-8f04-99b911d6be52",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-4"
                ],
                "reference_id": "identityRemoveExternalAccountWithReadPermissionsMonitoringNew"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppDisableRemoteDebuggingMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "functionAppDisableRemoteDebuggingMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('webAppDisableRemoteDebuggingMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "webAppDisableRemoteDebuggingMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppEnforceHttpsMonitoringEffectV2')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "functionAppEnforceHttpsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('webAppEnforceHttpsMonitoringEffectV2')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "webAppEnforceHttpsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppRestrictCORSAccessMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "functionAppRestrictCORSAccessMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('webAppRestrictCORSAccessMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "webAppRestrictCORSAccessMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('vnetEnableDDoSProtectionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-5"
                ],
                "reference_id": "vnetEnableDDoSProtectionMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlServerAdvancedDataSecurityMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "sqlServerAdvancedDataSecurityMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d31e5c31-63b2-4f12-887b-e49456834fa1",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "synapseWorkspaceAdvancedDataSecurityMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d38668f5-d155-42c7-ab3d-9b57b50f8fbf",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "postgreSqlFlexibleServersAdvancedDataSecurityMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3bc8a0d5-38e0-4a3d-a657-2cb64468fc34",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "mySqlFlexibleServersAdvancedDataSecurityMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('arcEnabledSqlServerDefenderStatusEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/938c4981-c2c9-4168-9cd6-972b8675f906",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "arcEnabledSqlServerDefenderStatus"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c6283572-73bb-4deb-bf2c-7a2b8f7462cb",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "SQLServerTargetedAutoprovisioningShouldBeEnabledForSQLServersOnMachinesPlan"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7926a6d1-b268-4586-8197-e8ae90c877d7",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-1",
                  "Azure_Security_Benchmark_v3.0_DP-2",
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "enableDefenderForApis"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlManagedInstanceAdvancedDataSecurityMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-2",
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "sqlManagedInstanceAdvancedDataSecurityMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('kubernetesServiceRbacEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-7"
                ],
                "reference_id": "kubernetesServiceRbacEnabledMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('kubernetesServiceAuthorizedIPRangesEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "kubernetesServiceAuthorizedIPRangesEnabledMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('vulnerabilityAssessmentOnServerMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-5"
                ],
                "reference_id": "vulnerabilityAssessmentOnServerMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('vulnerabilityAssessmentOnManagedInstanceMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-5"
                ],
                "reference_id": "vulnerabilityAssessmentOnManagedInstanceMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('restrictAccessToManagementPortsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-3"
                ],
                "reference_id": "restrictAccessToManagementPortsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('disableIPForwardingMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-3"
                ],
                "reference_id": "disableIPForwardingMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ensureServerTDEIsEncryptedWithYourOwnKeyWithDenyMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "ensureServerTDEIsEncryptedWithYourOwnKeyMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyWithDenyMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ASCDependencyAgentAuditWindowsEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-4"
                ],
                "reference_id": "ASCDependencyAgentAuditWindowsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ASCDependencyAgentAuditLinuxEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-4"
                ],
                "reference_id": "ASCDependencyAgentAuditLinuxEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureFirewallEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-3"
                ],
                "reference_id": "AzureFirewallEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ArcWindowsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d69b1763-b96d-40b8-a2d9-ca31e9fd0d3e",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-5"
                ],
                "reference_id": "ArcWindowsMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ArcLinuxMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/842c54e8-c2f9-4d79-ae8d-38d8b8019373",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-5"
                ],
                "reference_id": "ArcLinuxMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultsAdvancedDataSecurityMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-8",
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "keyVaultsAdvancedDataSecurityMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlServersAdvancedDataSecurityMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-2",
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "sqlServersAdvancedDataSecurityMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlServersVirtualMachinesAdvancedDataSecurityMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-2",
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "sqlServersVirtualMachinesAdvancedDataSecurityMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServicesAdvancedThreatProtectionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "appServicesAdvancedThreatProtectionMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('containersAdvancedThreatProtectionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "containersAdvancedThreatProtectionMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('virtualMachinesAdvancedThreatProtectionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_ES-1",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "virtualMachinesAdvancedThreatProtectionMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azurePolicyAddonStatusEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a15ec92-a229-4763-bb14-0ea34a568f8d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "azurePolicyAddonStatus"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('arcEnabledKubernetesClustersShouldHaveAzurePolicyExtensionInstalledEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6b2122c1-8120-4ff5-801b-17625a355590",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "arcEnabledKubernetesClustersShouldHaveAzurePolicyExtensionInstalled"
              },
              {
                "parameter_values": "{\"allowedContainerImagesRegex\":{\"value\":\"[parameters('allowedContainerImagesInKubernetesClusterRegex')]\"},\"effect\":{\"value\":\"[parameters('allowedContainerImagesInKubernetesClusterEffect')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('allowedContainerImagesNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('allowedContainerImagesLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/febd0533-8e55-448f-b837-bd0e06f16469",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "ensureAllowedContainerImagesInKubernetesCluster"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('privilegedContainersShouldBeAvoidedEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('privilegedContainerNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('privilegedContainerLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "privilegedContainersShouldBeAvoided"
              },
              {
                "parameter_values": "{\"allowedServicePortsList\":{\"value\":\"[parameters('allowedservicePortsInKubernetesClusterPorts')]\"},\"effect\":{\"value\":\"[parameters('allowedServicePortsInKubernetesClusterEffect')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('allowedServicePortsInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('allowedServicePortsInKubernetesClusterLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/233a2a17-77ca-4fb1-9b6b-69223d272a44",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "allowedServicePortsInKubernetesCluster"
              },
              {
                "parameter_values": "{\"cpuLimit\":{\"value\":\"[parameters('CPUInKubernetesClusterLimit')]\"},\"effect\":{\"value\":\"[parameters('memoryAndCPULimitsInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('memoryAndCPULimitsInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('memoryAndCPULimitsInKubernetesClusterLabelSelector')]\"},\"memoryLimit\":{\"value\":\"[parameters('memoryInKubernetesClusterLimit')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e345eecc-fa47-480f-9e88-67dcc122b164",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "memoryAndCPULimitsInKubernetesCluster"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MustRunAsNonRootNamespaceEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('MustRunAsNonRootNamespaceExclusion')]\"},\"fsGroupRanges\":{\"value\":{\"ranges\":[{\"max\":-1,\"min\":1}]}},\"fsGroupRule\":{\"value\":\"MayRunAs\"},\"labelSelector\":{\"value\":\"[parameters('MustRunAsNonRootLabelSelector')]\"},\"runAsGroupRanges\":{\"value\":{\"ranges\":[{\"max\":-1,\"min\":1}]}},\"runAsGroupRule\":{\"value\":\"MustRunAs\"},\"runAsUserRanges\":{\"value\":{\"ranges\":[]}},\"runAsUserRule\":{\"value\":\"MustRunAsNonRoot\"},\"supplementalGroupsRanges\":{\"value\":{\"ranges\":[{\"max\":-1,\"min\":1}]}},\"supplementalGroupsRule\":{\"value\":\"MayRunAs\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f06ddb64-5fa3-4b77-b166-acb36f7f6042",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "MustRunAsNonRoot"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('arcEnabledKubernetesClustersShouldHaveAzureDefendersExtensionInstalled')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8dfab9c4-fe7b-49ad-85e4-1e9be085358f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2"
                ],
                "reference_id": "arcEnabledKubernetesClustersShouldHaveAzureDefendersExtensionInstalled"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureKubernetesServiceClustersShouldHaveSecurityProfileEnabled')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a1840de2-8088-4ea8-b153-b4c723e9cb01",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2"
                ],
                "reference_id": "azureKubernetesServiceClustersShouldHaveSecurityProfileEnabled"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureContainerRegistryVulnerabilityAssessmentEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/090c7b07-b4ed-4561-ad20-e9075f3ccaff",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-6",
                  "Azure_Security_Benchmark_v3.0_DS-6"
                ],
                "reference_id": "azureContainerRegistryVulnerabilityAssessment"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('kubernetesRunningImagesVulnerabilityMDVMAssessmentEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/17f4b1cc-c55c-4d94-b1f9-2978f6ac2957",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-6",
                  "Azure_Security_Benchmark_v3.0_DS-6"
                ],
                "reference_id": "kubernetesRunningImagesVulnerabilityMDVMAssessment"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NoPrivilegeEscalationInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('NoPrivilegeEscalationInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('NoPrivilegeEscalationInKubernetesClusterLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "NoPrivilegeEscalationInKubernetesCluster"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NoSharingSensitiveHostNamespacesInKubernetesEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('NoSharingSensitiveHostNamespacesInKubernetesNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('NoSharingSensitiveHostNamespacesInKubernetesLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "NoSharingSensitiveHostNamespacesInKubernetes"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ReadOnlyRootFileSystemInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('ReadOnlyRootFileSystemInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('ReadOnlyRootFileSystemInKubernetesClusterLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/df49d893-a74c-421d-bc95-c663042e5b80",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "ReadOnlyRootFileSystemInKubernetesCluster"
              },
              {
                "parameter_values": "{\"allowedCapabilities\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterList')]\"},\"effect\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterLabelSelector')]\"},\"requiredDropCapabilities\":{\"value\":\"[parameters('DropCapabilitiesInKubernetesClusterList')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "AllowedCapabilitiesInKubernetesCluster"
              },
              {
                "parameter_values": "{\"allowedProfiles\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterList')]\"},\"effect\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/511f5417-5d12-434d-ab2e-816901e72a5e",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "AllowedAppArmorProfilesInKubernetesCluster"
              },
              {
                "parameter_values": "{\"allowHostNetwork\":{\"value\":\"[parameters('AllowHostNetworkingInKubernetesCluster')]\"},\"effect\":{\"value\":\"[parameters('AllowedHostNetworkingAndPortsInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedHostNetworkingAndPortsInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedHostNetworkingAndPortsInKubernetesClusterLabelSelector')]\"},\"maxPort\":{\"value\":\"[parameters('AllowedHostMaxPortInKubernetesCluster')]\"},\"minPort\":{\"value\":\"[parameters('AllowedHostMinPortInKubernetesCluster')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/82985f06-dc18-4a48-bc1c-b9f4f0098cfe",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "AllowedHostNetworkingAndPortsInKubernetesCluster"
              },
              {
                "parameter_values": "{\"allowedHostPaths\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterList')]\"},\"effect\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/098fc59e-46c7-4d99-9b16-64990e543d75",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "AllowedHostPathVolumesInKubernetesCluster"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('disallowPublicBlobAccessEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "StorageDisallowPublicAccess"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureBackupShouldBeEnabledForVirtualMachinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_BR-1",
                  "Azure_Security_Benchmark_v3.0_BR-2"
                ],
                "reference_id": "azureBackupShouldBeEnabledForVirtualMachinesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('managedIdentityShouldBeUsedInYourFunctionAppMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-3"
                ],
                "reference_id": "managedIdentityShouldBeUsedInYourFunctionAppMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('georedundantBackupShouldBeEnabledForAzureDatabaseForMariadbMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_BR-1",
                  "Azure_Security_Benchmark_v3.0_BR-2"
                ],
                "reference_id": "georedundantBackupShouldBeEnabledForAzureDatabaseForMariadbMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('managedIdentityShouldBeUsedInYourWebAppMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-3"
                ],
                "reference_id": "managedIdentityShouldBeUsedInYourWebAppMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('georedundantBackupShouldBeEnabledForAzureDatabaseForPostgresqlMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/48af4db5-9b8b-401c-8e74-076be876a430",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_BR-1",
                  "Azure_Security_Benchmark_v3.0_BR-2"
                ],
                "reference_id": "georedundantBackupShouldBeEnabledForAzureDatabaseForPostgresqlMonitoringEffect"
              },
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/19dd1db6-f442-49cf-a838-b0786b4401ef",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "ensureWebAppHasIncomingClientCertificatesSetToOnMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('georedundantBackupShouldBeEnabledForAzureDatabaseForMysqlMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/82339799-d096-41ae-8538-b108becf0970",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_BR-1",
                  "Azure_Security_Benchmark_v3.0_BR-2"
                ],
                "reference_id": "georedundantBackupShouldBeEnabledForAzureDatabaseForMysqlMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticLogsInAppServicesShouldBeEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticLogsInAppServicesShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enforceSSLConnectionShouldBeEnabledForPostgresqlDatabaseServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d158790f-bfb0-486c-8631-2dc6b4e8e6af",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "enforceSSLConnectionShouldBeEnabledForPostgresqlDatabaseServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enforceSSLConnectionShouldBeEnabledForMysqlDatabaseServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e802a67a-daf5-4436-9ea6-f6d821dd0c5d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "enforceSSLConnectionShouldBeEnabledForMysqlDatabaseServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('latestTLSVersionShouldBeUsedInYourWebAppMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-8",
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "latestTLSVersionShouldBeUsedInYourWebAppMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('latestTLSVersionShouldBeUsedInYourFunctionAppMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-8",
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "latestTLSVersionShouldBeUsedInYourFunctionAppMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('privateEndpointShouldBeEnabledForPostgresqlServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "privateEndpointShouldBeEnabledForPostgresqlServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('privateEndpointShouldBeEnabledForMariadbServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "privateEndpointShouldBeEnabledForMariadbServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('privateEndpointShouldBeEnabledForMysqlServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7595c971-233d-4bcf-bd18-596129188c49",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "privateEndpointShouldBeEnabledForMysqlServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('sQLServersShouldBeConfiguredWithAuditingRetentionDaysGreaterThan90DaysMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-6"
                ],
                "reference_id": "sQLServersShouldBeConfiguredWithAuditingRetentionDaysGreaterThan90DaysMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('fTPSOnlyShouldBeRequiredInYourFunctionAppMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "fTPSOnlyShouldBeRequiredInYourFunctionAppMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('fTPSShouldBeRequiredInYourWebAppMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "fTPSShouldBeRequiredInYourWebAppMonitoringEffect"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ab6a902f-9493-453b-928d-62c30b11b5a6",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "functionAppsShouldHaveClientCertificatesEnabledMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesAccountsShouldEnableDataEncryptionWithACustomerManagedKeyMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "cognitiveServicesAccountsShouldEnableDataEncryptionWithACustomerManagedKeyMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureCosmosDbAccountsShouldUseCustomerManagedKeysToEncryptDataAtRestMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "azureCosmosDbAccountsShouldUseCustomerManagedKeysToEncryptDataAtRestMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureCosmosDbAccountsShouldHaveLocalAuthenticationMethodsDisabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "azureCosmosDbAccountsShouldHaveLocalAuthenticationMethodsDisabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultsShouldHavePurgeProtectionEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-8"
                ],
                "reference_id": "keyVaultsShouldHavePurgeProtectionEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultsShouldHaveSoftDeleteEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-8"
                ],
                "reference_id": "keyVaultsShouldHaveSoftDeleteEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureCacheForRedisShouldUsePrivateEndpointMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7803067c-7d34-46e3-8c79-0ca68fc4036d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureCacheForRedisShouldUsePrivateEndpointMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsShouldUseCustomerManagedKeyForEncryptionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "storageAccountsShouldUseCustomerManagedKeyForEncryptionMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsShouldRestrictNetworkAccessUsingVirtualNetworkRulesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "storageAccountsShouldRestrictNetworkAccessUsingVirtualNetworkRulesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistriesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "containerRegistriesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistriesShouldNotAllowUnrestrictedNetworkAccessMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "containerRegistriesShouldNotAllowUnrestrictedNetworkAccessMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistriesShouldUsePrivateLinkMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e8eef0a8-67cf-4eb4-9386-14b0e78733d4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "containerRegistriesShouldUsePrivateLinkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('appConfigurationShouldUsePrivateLinkMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ca610c1d-041c-4332-9d88-7ed3094967c7",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "appConfigurationShouldUsePrivateLinkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureEventGridDomainsShouldUsePrivateLinkMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9830b652-8523-49cc-b1b3-e17dce1127ca",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureEventGridDomainsShouldUsePrivateLinkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureEventGridTopicsShouldUsePrivateLinkMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4b90e17e-8448-49db-875e-bd83fb6f804f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureEventGridTopicsShouldUsePrivateLinkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureSignalRServiceShouldUsePrivateLinkMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2393d2cf-a342-44cd-a2e2-fe0188fd1234",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureSignalRServiceShouldUsePrivateLinkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureMachineLearningWorkspacesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "azureMachineLearningWorkspacesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureMachineLearningWorkspacesShouldUsePrivateLinkMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/45e05259-1eb5-4f70-9574-baf73e9d219b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureMachineLearningWorkspacesShouldUsePrivateLinkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('webApplicationFirewallShouldBeEnabledForAzureFrontDoorServiceServiceMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-6"
                ],
                "reference_id": "webApplicationFirewallShouldBeEnabledForAzureFrontDoorServiceServiceMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('webApplicationFirewallShouldBeEnabledForApplicationGatewayMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-6"
                ],
                "reference_id": "webApplicationFirewallShouldBeEnabledForApplicationGatewayMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('publicNetworkAccessShouldBeDisabledForMariaDbServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "publicNetworkAccessShouldBeDisabledForMariaDbServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('publicNetworkAccessShouldBeDisabledForMySqlServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "publicNetworkAccessShouldBeDisabledForMySqlServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('bringYourOwnKeyDataProtectionShouldBeEnabledForMySqlServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "bringYourOwnKeyDataProtectionShouldBeEnabledForMySqlServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('publicNetworkAccessShouldBeDisabledForPostgreSqlServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "publicNetworkAccessShouldBeDisabledForPostgreSqlServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('bringYourOwnKeyDataProtectionShouldBeEnabledForPostgreSqlServersMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "bringYourOwnKeyDataProtectionShouldBeEnabledForPostgreSqlServersMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('vmImageBuilderTemplatesShouldUsePrivateLinkMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2154edb9-244f-4741-9970-660785bccdaa",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "vmImageBuilderTemplatesShouldUsePrivateLinkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('firewallShouldBeEnabledOnKeyVaultMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2",
                  "Azure_Security_Benchmark_v3.0_DP-8"
                ],
                "reference_id": "firewallShouldBeEnabledOnKeyVaultMonitoringEffect"
              },
              {
                "parameter_values": "{\"audit_effect\":{\"value\":\"[parameters('privateEndpointShouldBeConfiguredForKeyVaultMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2",
                  "Azure_Security_Benchmark_v3.0_DP-8"
                ],
                "reference_id": "privateEndpointShouldBeConfiguredForKeyVaultMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureSpringCloudShouldUseNetworkInjectionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/af35e2a4-ef96-44e7-a9ae-853dd97032c4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureSpringCloudShouldUseNetworkInjectionMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('subscriptionsShouldHaveAContactEmailAddressForSecurityIssuesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IR-2"
                ],
                "reference_id": "subscriptionsShouldHaveAContactEmailAddressForSecurityIssuesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('emailNotificationForHighSeverityAlertsShouldBeEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IR-2"
                ],
                "reference_id": "emailNotificationForHighSeverityAlertsShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('emailNotificationToSubscriptionOwnerForHighSeverityAlertsShouldBeEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IR-2"
                ],
                "reference_id": "emailNotificationToSubscriptionOwnerForHighSeverityAlertsShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountShouldUseAPrivateLinkConnectionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "storageAccountShouldUseAPrivateLinkConnectionMonitoringEffect"
              },
              {
                "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('authenticationToLinuxMachinesShouldRequireSSHKeysMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/630c64f9-8b6b-4c64-b511-6544ceff6fd6",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-6"
                ],
                "reference_id": "authenticationToLinuxMachinesShouldRequireSSHKeysMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('privateEndpointConnectionsOnAzureSQLDatabaseShouldBeEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7698e800-9299-47a6-b3b6-5a0fee576eed",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "privateEndpointConnectionsOnAzureSQLDatabaseShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('publicNetworkAccessOnAzureSQLDatabaseShouldBeDisabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "publicNetworkAccessOnAzureSQLDatabaseShouldBeDisabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('kubernetesClustersShouldBeAccessibleOnlyOverHTTPSMonitoringEffect')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('kubernetesClustersShouldBeAccessibleOnlyOverHTTPSExcludedNamespaces')]\"},\"labelSelector\":{\"value\":\"[parameters('kubernetesClustersShouldBeAccessibleOnlyOverHTTPSLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "kubernetesClustersShouldBeAccessibleOnlyOverHTTPSMonitoringEffect"
              },
              {
                "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"MinimumTLSVersion\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMinimumTLSVersion')]\"},\"effect\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5752e6d6-1206-46d8-8ab1-ecc2f71a8112",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesAccountsShouldRestrictNetworkAccessMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "cognitiveServicesAccountsShouldRestrictNetworkAccessMonitoringEffect"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b4d1c4e-934c-4703-944c-27c82c06bebb",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticLogsInAzureAIServicesResourcesShouldBeEnabledMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d6759c02-b87f-42b7-892e-71b3f471d782",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureAIServicesResourcesShouldUseAzurePrivateLinkMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('aPIManagementServicesShouldUseAVirtualNetworkMonitoringEffect')]\"},\"evaluatedSkuNames\":{\"value\":\"[parameters('aPIManagementServicesShouldUseAVirtualNetworkEvaluatedSkuNames')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "aPIManagementServicesShouldUseAVirtualNetworkMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('azureCosmosDBAccountsShouldHaveFirewallRulesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureCosmosDBAccountsShouldHaveFirewallRulesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('networkWatcherShouldBeEnabledMonitoringEffect')]\"},\"resourceGroupName\":{\"value\":\"[parameters('networkWatcherShouldBeEnabledResourceGroupName')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IR-4"
                ],
                "reference_id": "networkWatcherShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/afe0c3be-ba3b-4544-ba52-0c99672a8ad6",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "resourceLogsInAzureMachineLearningWorkspacesShouldBeEnabled"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureMachineLearningWorkspacesShouldDisablePublicNetworkAccess"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7804b5c7-01dc-4723-969b-ae300cc07ff1",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureMachineLearningComputesShouldBeInAVirtualNetwork"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "azureMachineLearningComputesShouldHaveLocalAuthenticationMethodsDisabled"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "azureMachineLearningComputeInstancesshouldUseTheLatestOsImage"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/138ff14d-b687-4faa-a81c-898c91a87fa2",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "resourceLogsInAzureDatabricksWorkspacesShouldBeEnabled"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureDatabricksWorkspacesShouldDisablePublicNetworkAccess"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/51c1490f-3319-459c-bbbc-7f391bbed753",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureDatabricksClustersShouldDisablePublicIp"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9c25c9e4-ee12-4882-afd2-11fb9d87893f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureDatabricksWorkspacesShouldBeInAVirtualNetwork"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/258823f2-4595-4b52-b333-cc96192710d8",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureDatabricksWorkspacesShouldUsePrivateLink"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureDefenderForResourceManagerShouldBeEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c3d20c29-b36d-48fe-808b-99a87530ad99",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "AzureDefenderForResourceManagerShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringEffect')]\"},\"labelSelector\":{\"value\":\"[parameters('KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/423dd1ba-798e-40e4-9c4d-b6902674b423",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringLabelSelector')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d2e7ea85-6b44-4317-a0be-1b951587f626",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VtpmShouldBeEnabledOnSupportedVirtualMachinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c30f9cd-b84c-49cc-aa2c-9288447cc3b3",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "VtpmShouldBeEnabledOnSupportedVirtualMachinesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SecureBootShouldBeEnabledOnSupportedWindowsVirtualMachinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/97566dd7-78ae-4997-8b36-1c7bfe0d8121",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "previewSecureBootShouldBeEnabledOnSupportedWindowsVirtualMachinesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/672fe5a1-2fcd-42d7-b85d-902b6e28c6ff",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesScaleSetsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a21f8c92-9e22-4f09-b759-50500d1d2dda",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesScaleSetsMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1cb4d9c2-f88f-4069-bee0-dba239a57b09",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesScaleSetsMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f655e522-adff-494d-95c2-52d4f6d56a42",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesScaleSetsMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LinuxVirtualMachineShouldUseSignedAndTrustedBootComponentEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/13a6c84f-49a5-410a-b5df-5b880c3fe009",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "LinuxVirtualMachineShouldUseSignedAndTrustedBootComponentEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInKubernetesMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInKubernetesRetentionDays')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/245fc9df-fa96-4414-9a0b-3738c2f7341c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-3"
                ],
                "reference_id": "diagnosticsLogsInKubernetesMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureDefenderForOpenSourceRelationalDatabasesShouldBeEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a9fbe0d-c5c4-4da8-87d8-f4fd77338835",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-2",
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "AzureDefenderForOpenSourceRelationalDatabasesShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MicrosoftDefenderCSPMShouldBeEnabledMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f90fc71-a595-4066-8974-d4d0802e8ef0",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "MicrosoftDefenderCSPMShouldBeEnabledMonitoringEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('gcLinuxDiskEncryptionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ca88aadc-6e2b-416c-9de2-5a0f01d1693f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "gcLinuxDiskEncryptionMonitoring"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('gcWindowsDiskEncryptionMonitoringEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3dc5edcd-002d-444c-b216-e123bbfa37c0",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "gcWindowsDiskEncryptionMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "sqlServerADOnlyEnabledMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b3a22bc9-66de-45fb-98fa-00f5df42f41a",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "sqlServerDisableADOnlyAuthMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/146412e9-005c-472b-9e48-c87b72ac229e",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "mySqlServerADAdminisMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4dec045-250a-48c2-b5cc-e0c4eec8b5b4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "postgreSqlServerADAdminisMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "sqlManagedInstanceADOnlyEnabledMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0c28c3fb-c244-42d5-a9bf-f35f2999577b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "sqlManagedInstanceDisablingADOnlyAuthMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "synapseWorkspaceADOnlyEnabledMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6ea81a52-5ca7-4575-9669-eaa910b7edf8",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "synapseWorkspaceDisablingADOnlyAuthMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PA-7"
                ],
                "reference_id": "aPIManagementServiceShouldNotHaveAllApisScopedSubscriptions"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-4"
                ],
                "reference_id": "aPIManagementServiceShouldNotBypassCertificateValidation"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "aPIManagementServiceShouldUseEncryptedProtocols"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-8",
                  "Azure_Security_Benchmark_v3.0_DP-6"
                ],
                "reference_id": "aPIManagementServiceShouldUseKeyVaultForSecretNamedValues"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "aPIManagementServiceShouldHaveDirectManagementEndpointDisabled"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "aPIManagementServiceShouldDisableServiceConfigurationEndpoints"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-8",
                  "Azure_Security_Benchmark_v3.0_PV-2"
                ],
                "reference_id": "aPIManagementServiceShouldHaveMinimumAPIVersionSet"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-4"
                ],
                "reference_id": "aPIManagementServiceShouldHaveBackendCallsAuthenticated"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/40e85574-ef33-47e8-a854-7a65c7500560",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "mySqlServerADOnlyEnabledMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3ac7c827-eea2-4bde-acc7-9568cd320efa",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-5",
                  "Azure_Security_Benchmark_v3.0_IM-8"
                ],
                "reference_id": "serverSecretFindingsMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c8acafaf-3d23-44d1-9624-978ef0f8652c",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_AM-3"
                ],
                "reference_id": "unusedApisShouldbeDisabledAndRemovedFromApim"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8ac833bd-f505-48d5-887e-c993a1d3eea0",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-4"
                ],
                "reference_id": "apimApiEndpointsShouldbeAuthenticated"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/640d2586-54d2-465f-877f-9ffc1d2109f4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-2",
                  "Azure_Security_Benchmark_v3.0_LT-1",
                  "Azure_Security_Benchmark_v3.0_LT-2",
                  "Azure_Security_Benchmark_v3.0_IR-3",
                  "Azure_Security_Benchmark_v3.0_IR-5"
                ],
                "reference_id": "defenderForStorageShouldBeEnabledMonitoring"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "cognitiveServicesAccountsShouldHaveLocalAuthenticationMethodsDisabled"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cddd188c-4b82-4c48-a19d-ddf74ee66a01",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "cognitiveServicesShouldUsePrivateLink"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-4"
                ],
                "reference_id": "virtualMachinesAndVirtualMachineScaleSetsShouldHaveEncryptionAtHostEnabled"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureCosmosDBShouldDisablePublicNetworkAccess"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/58440f8a-10c5-4151-bdce-dfbaad4a20b7",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "cosmosDBAaccountsShouldUsePrivateLink"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "vPNGatewaysShouldUseOnlyAzureActiveDirectoryAzureADAuthenticationForPointtositeUsers"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3",
                  "Azure_Security_Benchmark_v3.0_IM-4"
                ],
                "reference_id": "azureSQLDatabaseShouldBeRunningTLSVersion12OrNewer"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_NS-2"
                ],
                "reference_id": "azureSQLManagedInstancesShouldDisablePublicNetworkAccess"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "storageAccountsShouldPreventSharedKeyAccess"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1dc2fc00-2245-4143-99f4-874c937f13ef",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-2",
                  "Azure_Security_Benchmark_v3.0_AM-2"
                ],
                "reference_id": "aPIManagementServicePlatformVersionShouldBeStv2"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e6bf724-0154-49bc-985f-27b2e07e636b",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "hciSecuredCoreComplianceMonitoringAtCluster"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/dad3a6b9-4451-492f-a95c-69efc6f3fada",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_PV-4"
                ],
                "reference_id": "hciWdacComplianceMonitoringAtCluster"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee8ca833-1583-4d24-837e-96c2af9488a4",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-5"
                ],
                "reference_id": "hciDataAtRestEncryptedComplianceMonitoringAtCluster"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36f0d6bc-a253-4df8-b25b-c3a5023ff443",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_DP-3"
                ],
                "reference_id": "hciDataInTransitComplianceMonitoringAtCluster"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fa498b91-8a7e-4710-9578-da944c68d1fe",
                "policy_group_names": [
                  "Azure_Security_Benchmark_v3.0_IM-1"
                ],
                "reference_id": "postgreSqlFlexibleServersEnableEntraOnlyAuthenticationMonitoring"
              }
            ],
            "policy_definitions": "[{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-7\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('certificatesValidityPeriodMonitoringEffect')]\"},\"maximumValidityInMonths\":{\"value\":\"[parameters('certificatesValidityPeriodInMonths')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560\",\"policyDefinitionReferenceId\":\"certificatesValidityPeriodMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('secretsExpirationSetEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37\",\"policyDefinitionReferenceId\":\"secretsExpirationSet\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('keysExpirationSetEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0\",\"policyDefinitionReferenceId\":\"keysExpirationSet\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azurePolicyforWindowsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ae89ebca-1c92-4898-ac2c-9f63decb045c\",\"policyDefinitionReferenceId\":\"gcExtOnVMMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-3\",\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('gcExtOnVMWithNoSAMIMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d26f7642-7545-4e18-9b75-8c9bbdee3a9a\",\"policyDefinitionReferenceId\":\"gcExtOnVMWithNoSAMIMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_ES-2\"],\"parameters\":{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"NotAvailableMachineState\":{\"value\":\"Compliant\"},\"effect\":{\"value\":\"[parameters('windowsDefenderExploitGuardMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/bed48b13-6647-468e-aa2f-1af1d3f4dd40\",\"policyDefinitionReferenceId\":\"windowsDefenderExploitGuardMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('windowsGuestConfigBaselinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc\",\"policyDefinitionReferenceId\":\"windowsGuestConfigBaselinesMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('linuxGuestConfigBaselinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd\",\"policyDefinitionReferenceId\":\"linuxGuestConfigBaselinesMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInIoTHubMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInIoTHubRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInIoTHubMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('disableUnrestrictedNetworkToStorageAccountMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\"policyDefinitionReferenceId\":\"disableUnrestrictedNetworkToStorageAccountMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-7\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('useRbacRulesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\"policyDefinitionReferenceId\":\"useRbacRulesMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInStreamAnalyticsMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInStreamAnalyticsRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInStreamAnalyticsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('secureTransferToStorageAccountMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\"policyDefinitionReferenceId\":\"secureTransferToStorageAccountMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('aadAuthenticationInSqlServerMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\"policyDefinitionReferenceId\":\"aadAuthenticationInSqlServerMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInServiceBusMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInServiceBusRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInServiceBusMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('clusterProtectionLevelInServiceFabricMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\"policyDefinitionReferenceId\":\"clusterProtectionLevelInServiceFabricMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('aadAuthenticationInServiceFabricMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\"policyDefinitionReferenceId\":\"aadAuthenticationInServiceFabricMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInSearchServiceMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInSearchServiceRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInSearchServiceMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInRedisCacheMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInRedisCacheMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInLogicAppsMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInLogicAppsRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInLogicAppsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-8\",\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInKeyVaultMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInKeyVaultRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInKeyVaultMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInEventHubMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInEventHubRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInEventHubMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeStoreMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeStoreRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInDataLakeStoreMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeAnalyticsMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInDataLakeAnalyticsRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInDataLakeAnalyticsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_AM-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('classicStorageAccountsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\"policyDefinitionReferenceId\":\"classicStorageAccountsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_AM-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('classicComputeVMsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\"policyDefinitionReferenceId\":\"classicComputeVMsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInBatchAccountMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInBatchAccountRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInBatchAccountMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('encryptionOfAutomationAccountMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\"policyDefinitionReferenceId\":\"encryptionOfAutomationAccountMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sqlDbEncryptionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\"policyDefinitionReferenceId\":\"sqlDbEncryptionMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sqlServerAuditingMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\"policyDefinitionReferenceId\":\"sqlServerAuditingMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('systemUpdatesV2MonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f85bf3e0-d513-442e-89c3-1784ad63382b\",\"policyDefinitionReferenceId\":\"systemUpdatesV2Monitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('systemUpdatesAutoAssessmentModeEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/bd876905-5b84-4f73-ab2d-2e7a7c4568d9\",\"policyDefinitionReferenceId\":\"systemUpdatesAutoAssessmentMode\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-3\",\"Azure_Security_Benchmark_v3.0_PA-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('jitNetworkAccessMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\"policyDefinitionReferenceId\":\"jitNetworkAccessMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('networkSecurityGroupsOnSubnetsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517\",\"policyDefinitionReferenceId\":\"networkSecurityGroupsOnSubnetsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('networkSecurityGroupsOnVirtualMachinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\",\"policyDefinitionReferenceId\":\"networkSecurityGroupsOnVirtualMachinesMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('networkSecurityGroupsOnInternalVirtualMachinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6\",\"policyDefinitionReferenceId\":\"networkSecurityGroupsOnInternalVirtualMachinesMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('serverVulnerabilityAssessmentEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9\",\"policyDefinitionReferenceId\":\"serverVulnerabilityAssessment\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('nextGenerationFirewallMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\"policyDefinitionReferenceId\":\"nextGenerationFirewallMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sqlDbVulnerabilityAssesmentMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\"policyDefinitionReferenceId\":\"sqlDbVulnerabilityAssesmentMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('serverSqlDbVulnerabilityAssesmentMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6ba6d016-e7c3-4842-b8f2-4992ebc0d72d\",\"policyDefinitionReferenceId\":\"serverSqlDbVulnerabilityAssesmentMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('identityDesignateLessThanOwnersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\"policyDefinitionReferenceId\":\"identityDesignateLessThanOwnersMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('identityDesignateMoreThanOneOwnerMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\"policyDefinitionReferenceId\":\"identityDesignateMoreThanOneOwnerMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-1\",\"Azure_Security_Benchmark_v3.0_PA-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0cfea604-3201-4e14-88fc-fae4c427a6c5\",\"policyDefinitionReferenceId\":\"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringNew\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('identityRemoveDeprecatedAccountMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/8d7e1fde-fe26-4b5f-8108-f8e432cbc2be\",\"policyDefinitionReferenceId\":\"identityRemoveDeprecatedAccountMonitoringNew\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-1\",\"Azure_Security_Benchmark_v3.0_PA-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/339353f6-2387-4a45-abe4-7f529d121046\",\"policyDefinitionReferenceId\":\"identityRemoveExternalAccountWithOwnerPermissionsMonitoringNew\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('identityRemoveExternalAccountWithWritePermissionsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/94e1c2ac-cbbe-4cac-a2b5-389c812dee87\",\"policyDefinitionReferenceId\":\"identityRemoveExternalAccountWithWritePermissionsMonitoringNew\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('identityRemoveExternalAccountWithReadPermissionsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e9ac8f8e-ce22-4355-8f04-99b911d6be52\",\"policyDefinitionReferenceId\":\"identityRemoveExternalAccountWithReadPermissionsMonitoringNew\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('functionAppDisableRemoteDebuggingMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\"policyDefinitionReferenceId\":\"functionAppDisableRemoteDebuggingMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('webAppDisableRemoteDebuggingMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\",\"policyDefinitionReferenceId\":\"webAppDisableRemoteDebuggingMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('functionAppEnforceHttpsMonitoringEffectV2')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\",\"policyDefinitionReferenceId\":\"functionAppEnforceHttpsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('webAppEnforceHttpsMonitoringEffectV2')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d\",\"policyDefinitionReferenceId\":\"webAppEnforceHttpsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('functionAppRestrictCORSAccessMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\",\"policyDefinitionReferenceId\":\"functionAppRestrictCORSAccessMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('webAppRestrictCORSAccessMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\"policyDefinitionReferenceId\":\"webAppRestrictCORSAccessMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('vnetEnableDDoSProtectionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\",\"policyDefinitionReferenceId\":\"vnetEnableDDoSProtectionMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sqlServerAdvancedDataSecurityMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\",\"policyDefinitionReferenceId\":\"sqlServerAdvancedDataSecurityMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d31e5c31-63b2-4f12-887b-e49456834fa1\",\"policyDefinitionReferenceId\":\"synapseWorkspaceAdvancedDataSecurityMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d38668f5-d155-42c7-ab3d-9b57b50f8fbf\",\"policyDefinitionReferenceId\":\"postgreSqlFlexibleServersAdvancedDataSecurityMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3bc8a0d5-38e0-4a3d-a657-2cb64468fc34\",\"policyDefinitionReferenceId\":\"mySqlFlexibleServersAdvancedDataSecurityMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('arcEnabledSqlServerDefenderStatusEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/938c4981-c2c9-4168-9cd6-972b8675f906\",\"policyDefinitionReferenceId\":\"arcEnabledSqlServerDefenderStatus\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/c6283572-73bb-4deb-bf2c-7a2b8f7462cb\",\"policyDefinitionReferenceId\":\"SQLServerTargetedAutoprovisioningShouldBeEnabledForSQLServersOnMachinesPlan\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-1\",\"Azure_Security_Benchmark_v3.0_DP-2\",\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/7926a6d1-b268-4586-8197-e8ae90c877d7\",\"policyDefinitionReferenceId\":\"enableDefenderForApis\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-2\",\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sqlManagedInstanceAdvancedDataSecurityMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\",\"policyDefinitionReferenceId\":\"sqlManagedInstanceAdvancedDataSecurityMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-7\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('kubernetesServiceRbacEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\",\"policyDefinitionReferenceId\":\"kubernetesServiceRbacEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('kubernetesServiceAuthorizedIPRangesEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\",\"policyDefinitionReferenceId\":\"kubernetesServiceAuthorizedIPRangesEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('vulnerabilityAssessmentOnServerMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\",\"policyDefinitionReferenceId\":\"vulnerabilityAssessmentOnServerMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('vulnerabilityAssessmentOnManagedInstanceMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\",\"policyDefinitionReferenceId\":\"vulnerabilityAssessmentOnManagedInstanceMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('restrictAccessToManagementPortsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\",\"policyDefinitionReferenceId\":\"restrictAccessToManagementPortsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('disableIPForwardingMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744\",\"policyDefinitionReferenceId\":\"disableIPForwardingMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('ensureServerTDEIsEncryptedWithYourOwnKeyWithDenyMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8\",\"policyDefinitionReferenceId\":\"ensureServerTDEIsEncryptedWithYourOwnKeyMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyWithDenyMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2\",\"policyDefinitionReferenceId\":\"ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('ASCDependencyAgentAuditWindowsEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d\",\"policyDefinitionReferenceId\":\"ASCDependencyAgentAuditWindowsEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('ASCDependencyAgentAuditLinuxEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602\",\"policyDefinitionReferenceId\":\"ASCDependencyAgentAuditLinuxEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('AzureFirewallEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c\",\"policyDefinitionReferenceId\":\"AzureFirewallEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('ArcWindowsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d69b1763-b96d-40b8-a2d9-ca31e9fd0d3e\",\"policyDefinitionReferenceId\":\"ArcWindowsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('ArcLinuxMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/842c54e8-c2f9-4d79-ae8d-38d8b8019373\",\"policyDefinitionReferenceId\":\"ArcLinuxMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-8\",\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('keyVaultsAdvancedDataSecurityMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047\",\"policyDefinitionReferenceId\":\"keyVaultsAdvancedDataSecurityMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-2\",\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sqlServersAdvancedDataSecurityMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\",\"policyDefinitionReferenceId\":\"sqlServersAdvancedDataSecurityMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-2\",\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sqlServersVirtualMachinesAdvancedDataSecurityMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b\",\"policyDefinitionReferenceId\":\"sqlServersVirtualMachinesAdvancedDataSecurityMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('appServicesAdvancedThreatProtectionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb\",\"policyDefinitionReferenceId\":\"appServicesAdvancedThreatProtectionMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('containersAdvancedThreatProtectionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1c988dd6-ade4-430f-a608-2a3e5b0a6d38\",\"policyDefinitionReferenceId\":\"containersAdvancedThreatProtectionMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_ES-1\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('virtualMachinesAdvancedThreatProtectionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d\",\"policyDefinitionReferenceId\":\"virtualMachinesAdvancedThreatProtectionMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azurePolicyAddonStatusEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0a15ec92-a229-4763-bb14-0ea34a568f8d\",\"policyDefinitionReferenceId\":\"azurePolicyAddonStatus\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('arcEnabledKubernetesClustersShouldHaveAzurePolicyExtensionInstalledEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6b2122c1-8120-4ff5-801b-17625a355590\",\"policyDefinitionReferenceId\":\"arcEnabledKubernetesClustersShouldHaveAzurePolicyExtensionInstalled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"allowedContainerImagesRegex\":{\"value\":\"[parameters('allowedContainerImagesInKubernetesClusterRegex')]\"},\"effect\":{\"value\":\"[parameters('allowedContainerImagesInKubernetesClusterEffect')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('allowedContainerImagesNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('allowedContainerImagesLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/febd0533-8e55-448f-b837-bd0e06f16469\",\"policyDefinitionReferenceId\":\"ensureAllowedContainerImagesInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('privilegedContainersShouldBeAvoidedEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('privilegedContainerNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('privilegedContainerLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4\",\"policyDefinitionReferenceId\":\"privilegedContainersShouldBeAvoided\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"allowedServicePortsList\":{\"value\":\"[parameters('allowedservicePortsInKubernetesClusterPorts')]\"},\"effect\":{\"value\":\"[parameters('allowedServicePortsInKubernetesClusterEffect')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('allowedServicePortsInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('allowedServicePortsInKubernetesClusterLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/233a2a17-77ca-4fb1-9b6b-69223d272a44\",\"policyDefinitionReferenceId\":\"allowedServicePortsInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"cpuLimit\":{\"value\":\"[parameters('CPUInKubernetesClusterLimit')]\"},\"effect\":{\"value\":\"[parameters('memoryAndCPULimitsInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('memoryAndCPULimitsInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('memoryAndCPULimitsInKubernetesClusterLabelSelector')]\"},\"memoryLimit\":{\"value\":\"[parameters('memoryInKubernetesClusterLimit')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e345eecc-fa47-480f-9e88-67dcc122b164\",\"policyDefinitionReferenceId\":\"memoryAndCPULimitsInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('MustRunAsNonRootNamespaceEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('MustRunAsNonRootNamespaceExclusion')]\"},\"fsGroupRanges\":{\"value\":{\"ranges\":[{\"max\":-1,\"min\":1}]}},\"fsGroupRule\":{\"value\":\"MayRunAs\"},\"labelSelector\":{\"value\":\"[parameters('MustRunAsNonRootLabelSelector')]\"},\"runAsGroupRanges\":{\"value\":{\"ranges\":[{\"max\":-1,\"min\":1}]}},\"runAsGroupRule\":{\"value\":\"MustRunAs\"},\"runAsUserRanges\":{\"value\":{\"ranges\":[]}},\"runAsUserRule\":{\"value\":\"MustRunAsNonRoot\"},\"supplementalGroupsRanges\":{\"value\":{\"ranges\":[{\"max\":-1,\"min\":1}]}},\"supplementalGroupsRule\":{\"value\":\"MayRunAs\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f06ddb64-5fa3-4b77-b166-acb36f7f6042\",\"policyDefinitionReferenceId\":\"MustRunAsNonRoot\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('arcEnabledKubernetesClustersShouldHaveAzureDefendersExtensionInstalled')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/8dfab9c4-fe7b-49ad-85e4-1e9be085358f\",\"policyDefinitionReferenceId\":\"arcEnabledKubernetesClustersShouldHaveAzureDefendersExtensionInstalled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureKubernetesServiceClustersShouldHaveSecurityProfileEnabled')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a1840de2-8088-4ea8-b153-b4c723e9cb01\",\"policyDefinitionReferenceId\":\"azureKubernetesServiceClustersShouldHaveSecurityProfileEnabled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-6\",\"Azure_Security_Benchmark_v3.0_DS-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureContainerRegistryVulnerabilityAssessmentEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/090c7b07-b4ed-4561-ad20-e9075f3ccaff\",\"policyDefinitionReferenceId\":\"azureContainerRegistryVulnerabilityAssessment\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-6\",\"Azure_Security_Benchmark_v3.0_DS-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('kubernetesRunningImagesVulnerabilityMDVMAssessmentEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/17f4b1cc-c55c-4d94-b1f9-2978f6ac2957\",\"policyDefinitionReferenceId\":\"kubernetesRunningImagesVulnerabilityMDVMAssessment\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('NoPrivilegeEscalationInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('NoPrivilegeEscalationInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('NoPrivilegeEscalationInKubernetesClusterLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\",\"policyDefinitionReferenceId\":\"NoPrivilegeEscalationInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('NoSharingSensitiveHostNamespacesInKubernetesEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('NoSharingSensitiveHostNamespacesInKubernetesNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('NoSharingSensitiveHostNamespacesInKubernetesLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\",\"policyDefinitionReferenceId\":\"NoSharingSensitiveHostNamespacesInKubernetes\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('ReadOnlyRootFileSystemInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('ReadOnlyRootFileSystemInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('ReadOnlyRootFileSystemInKubernetesClusterLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/df49d893-a74c-421d-bc95-c663042e5b80\",\"policyDefinitionReferenceId\":\"ReadOnlyRootFileSystemInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"allowedCapabilities\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterList')]\"},\"effect\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedCapabilitiesInKubernetesClusterLabelSelector')]\"},\"requiredDropCapabilities\":{\"value\":\"[parameters('DropCapabilitiesInKubernetesClusterList')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c\",\"policyDefinitionReferenceId\":\"AllowedCapabilitiesInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"allowedProfiles\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterList')]\"},\"effect\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedAppArmorProfilesInKubernetesClusterLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/511f5417-5d12-434d-ab2e-816901e72a5e\",\"policyDefinitionReferenceId\":\"AllowedAppArmorProfilesInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"allowHostNetwork\":{\"value\":\"[parameters('AllowHostNetworkingInKubernetesCluster')]\"},\"effect\":{\"value\":\"[parameters('AllowedHostNetworkingAndPortsInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedHostNetworkingAndPortsInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedHostNetworkingAndPortsInKubernetesClusterLabelSelector')]\"},\"maxPort\":{\"value\":\"[parameters('AllowedHostMaxPortInKubernetesCluster')]\"},\"minPort\":{\"value\":\"[parameters('AllowedHostMinPortInKubernetesCluster')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/82985f06-dc18-4a48-bc1c-b9f4f0098cfe\",\"policyDefinitionReferenceId\":\"AllowedHostNetworkingAndPortsInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"allowedHostPaths\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterList')]\"},\"effect\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('AllowedHostPathVolumesInKubernetesClusterLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/098fc59e-46c7-4d99-9b16-64990e543d75\",\"policyDefinitionReferenceId\":\"AllowedHostPathVolumesInKubernetesCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('disallowPublicBlobAccessEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751\",\"policyDefinitionReferenceId\":\"StorageDisallowPublicAccess\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_BR-1\",\"Azure_Security_Benchmark_v3.0_BR-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureBackupShouldBeEnabledForVirtualMachinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d\",\"policyDefinitionReferenceId\":\"azureBackupShouldBeEnabledForVirtualMachinesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('managedIdentityShouldBeUsedInYourFunctionAppMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f\",\"policyDefinitionReferenceId\":\"managedIdentityShouldBeUsedInYourFunctionAppMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_BR-1\",\"Azure_Security_Benchmark_v3.0_BR-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('georedundantBackupShouldBeEnabledForAzureDatabaseForMariadbMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0\",\"policyDefinitionReferenceId\":\"georedundantBackupShouldBeEnabledForAzureDatabaseForMariadbMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('managedIdentityShouldBeUsedInYourWebAppMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332\",\"policyDefinitionReferenceId\":\"managedIdentityShouldBeUsedInYourWebAppMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_BR-1\",\"Azure_Security_Benchmark_v3.0_BR-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('georedundantBackupShouldBeEnabledForAzureDatabaseForPostgresqlMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/48af4db5-9b8b-401c-8e74-076be876a430\",\"policyDefinitionReferenceId\":\"georedundantBackupShouldBeEnabledForAzureDatabaseForPostgresqlMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/19dd1db6-f442-49cf-a838-b0786b4401ef\",\"policyDefinitionReferenceId\":\"ensureWebAppHasIncomingClientCertificatesSetToOnMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_BR-1\",\"Azure_Security_Benchmark_v3.0_BR-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('georedundantBackupShouldBeEnabledForAzureDatabaseForMysqlMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/82339799-d096-41ae-8538-b108becf0970\",\"policyDefinitionReferenceId\":\"georedundantBackupShouldBeEnabledForAzureDatabaseForMysqlMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticLogsInAppServicesShouldBeEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510\",\"policyDefinitionReferenceId\":\"diagnosticLogsInAppServicesShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('enforceSSLConnectionShouldBeEnabledForPostgresqlDatabaseServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d158790f-bfb0-486c-8631-2dc6b4e8e6af\",\"policyDefinitionReferenceId\":\"enforceSSLConnectionShouldBeEnabledForPostgresqlDatabaseServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('enforceSSLConnectionShouldBeEnabledForMysqlDatabaseServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e802a67a-daf5-4436-9ea6-f6d821dd0c5d\",\"policyDefinitionReferenceId\":\"enforceSSLConnectionShouldBeEnabledForMysqlDatabaseServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-8\",\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('latestTLSVersionShouldBeUsedInYourWebAppMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\",\"policyDefinitionReferenceId\":\"latestTLSVersionShouldBeUsedInYourWebAppMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-8\",\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('latestTLSVersionShouldBeUsedInYourFunctionAppMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193\",\"policyDefinitionReferenceId\":\"latestTLSVersionShouldBeUsedInYourFunctionAppMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('privateEndpointShouldBeEnabledForPostgresqlServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b\",\"policyDefinitionReferenceId\":\"privateEndpointShouldBeEnabledForPostgresqlServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('privateEndpointShouldBeEnabledForMariadbServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990\",\"policyDefinitionReferenceId\":\"privateEndpointShouldBeEnabledForMariadbServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('privateEndpointShouldBeEnabledForMysqlServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/7595c971-233d-4bcf-bd18-596129188c49\",\"policyDefinitionReferenceId\":\"privateEndpointShouldBeEnabledForMysqlServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('sQLServersShouldBeConfiguredWithAuditingRetentionDaysGreaterThan90DaysMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743\",\"policyDefinitionReferenceId\":\"sQLServersShouldBeConfiguredWithAuditingRetentionDaysGreaterThan90DaysMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('fTPSOnlyShouldBeRequiredInYourFunctionAppMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15\",\"policyDefinitionReferenceId\":\"fTPSOnlyShouldBeRequiredInYourFunctionAppMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('fTPSShouldBeRequiredInYourWebAppMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b\",\"policyDefinitionReferenceId\":\"fTPSShouldBeRequiredInYourWebAppMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ab6a902f-9493-453b-928d-62c30b11b5a6\",\"policyDefinitionReferenceId\":\"functionAppsShouldHaveClientCertificatesEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('cognitiveServicesAccountsShouldEnableDataEncryptionWithACustomerManagedKeyMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d\",\"policyDefinitionReferenceId\":\"cognitiveServicesAccountsShouldEnableDataEncryptionWithACustomerManagedKeyMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureCosmosDbAccountsShouldUseCustomerManagedKeysToEncryptDataAtRestMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f\",\"policyDefinitionReferenceId\":\"azureCosmosDbAccountsShouldUseCustomerManagedKeysToEncryptDataAtRestMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureCosmosDbAccountsShouldHaveLocalAuthenticationMethodsDisabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2\",\"policyDefinitionReferenceId\":\"azureCosmosDbAccountsShouldHaveLocalAuthenticationMethodsDisabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-8\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('keyVaultsShouldHavePurgeProtectionEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\",\"policyDefinitionReferenceId\":\"keyVaultsShouldHavePurgeProtectionEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-8\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('keyVaultsShouldHaveSoftDeleteEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\",\"policyDefinitionReferenceId\":\"keyVaultsShouldHaveSoftDeleteEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureCacheForRedisShouldUsePrivateEndpointMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/7803067c-7d34-46e3-8c79-0ca68fc4036d\",\"policyDefinitionReferenceId\":\"azureCacheForRedisShouldUsePrivateEndpointMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('storageAccountsShouldUseCustomerManagedKeyForEncryptionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25\",\"policyDefinitionReferenceId\":\"storageAccountsShouldUseCustomerManagedKeyForEncryptionMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('storageAccountsShouldRestrictNetworkAccessUsingVirtualNetworkRulesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\",\"policyDefinitionReferenceId\":\"storageAccountsShouldRestrictNetworkAccessUsingVirtualNetworkRulesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('containerRegistriesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\",\"policyDefinitionReferenceId\":\"containerRegistriesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('containerRegistriesShouldNotAllowUnrestrictedNetworkAccessMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71\",\"policyDefinitionReferenceId\":\"containerRegistriesShouldNotAllowUnrestrictedNetworkAccessMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('containerRegistriesShouldUsePrivateLinkMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e8eef0a8-67cf-4eb4-9386-14b0e78733d4\",\"policyDefinitionReferenceId\":\"containerRegistriesShouldUsePrivateLinkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('appConfigurationShouldUsePrivateLinkMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ca610c1d-041c-4332-9d88-7ed3094967c7\",\"policyDefinitionReferenceId\":\"appConfigurationShouldUsePrivateLinkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureEventGridDomainsShouldUsePrivateLinkMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9830b652-8523-49cc-b1b3-e17dce1127ca\",\"policyDefinitionReferenceId\":\"azureEventGridDomainsShouldUsePrivateLinkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureEventGridTopicsShouldUsePrivateLinkMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4b90e17e-8448-49db-875e-bd83fb6f804f\",\"policyDefinitionReferenceId\":\"azureEventGridTopicsShouldUsePrivateLinkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureSignalRServiceShouldUsePrivateLinkMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2393d2cf-a342-44cd-a2e2-fe0188fd1234\",\"policyDefinitionReferenceId\":\"azureSignalRServiceShouldUsePrivateLinkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureMachineLearningWorkspacesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8\",\"policyDefinitionReferenceId\":\"azureMachineLearningWorkspacesShouldBeEncryptedWithACustomerManagedKeyMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureMachineLearningWorkspacesShouldUsePrivateLinkMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/45e05259-1eb5-4f70-9574-baf73e9d219b\",\"policyDefinitionReferenceId\":\"azureMachineLearningWorkspacesShouldUsePrivateLinkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('webApplicationFirewallShouldBeEnabledForAzureFrontDoorServiceServiceMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c\",\"policyDefinitionReferenceId\":\"webApplicationFirewallShouldBeEnabledForAzureFrontDoorServiceServiceMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-6\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('webApplicationFirewallShouldBeEnabledForApplicationGatewayMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\",\"policyDefinitionReferenceId\":\"webApplicationFirewallShouldBeEnabledForApplicationGatewayMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('publicNetworkAccessShouldBeDisabledForMariaDbServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077\",\"policyDefinitionReferenceId\":\"publicNetworkAccessShouldBeDisabledForMariaDbServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('publicNetworkAccessShouldBeDisabledForMySqlServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095\",\"policyDefinitionReferenceId\":\"publicNetworkAccessShouldBeDisabledForMySqlServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('bringYourOwnKeyDataProtectionShouldBeEnabledForMySqlServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833\",\"policyDefinitionReferenceId\":\"bringYourOwnKeyDataProtectionShouldBeEnabledForMySqlServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('publicNetworkAccessShouldBeDisabledForPostgreSqlServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c\",\"policyDefinitionReferenceId\":\"publicNetworkAccessShouldBeDisabledForPostgreSqlServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('bringYourOwnKeyDataProtectionShouldBeEnabledForPostgreSqlServersMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274\",\"policyDefinitionReferenceId\":\"bringYourOwnKeyDataProtectionShouldBeEnabledForPostgreSqlServersMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('vmImageBuilderTemplatesShouldUsePrivateLinkMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2154edb9-244f-4741-9970-660785bccdaa\",\"policyDefinitionReferenceId\":\"vmImageBuilderTemplatesShouldUsePrivateLinkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\",\"Azure_Security_Benchmark_v3.0_DP-8\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('firewallShouldBeEnabledOnKeyVaultMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490\",\"policyDefinitionReferenceId\":\"firewallShouldBeEnabledOnKeyVaultMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\",\"Azure_Security_Benchmark_v3.0_DP-8\"],\"parameters\":{\"audit_effect\":{\"value\":\"[parameters('privateEndpointShouldBeConfiguredForKeyVaultMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9\",\"policyDefinitionReferenceId\":\"privateEndpointShouldBeConfiguredForKeyVaultMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureSpringCloudShouldUseNetworkInjectionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/af35e2a4-ef96-44e7-a9ae-853dd97032c4\",\"policyDefinitionReferenceId\":\"azureSpringCloudShouldUseNetworkInjectionMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IR-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('subscriptionsShouldHaveAContactEmailAddressForSecurityIssuesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\",\"policyDefinitionReferenceId\":\"subscriptionsShouldHaveAContactEmailAddressForSecurityIssuesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IR-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('emailNotificationForHighSeverityAlertsShouldBeEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899\",\"policyDefinitionReferenceId\":\"emailNotificationForHighSeverityAlertsShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IR-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('emailNotificationToSubscriptionOwnerForHighSeverityAlertsShouldBeEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d\",\"policyDefinitionReferenceId\":\"emailNotificationToSubscriptionOwnerForHighSeverityAlertsShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('storageAccountShouldUseAPrivateLinkConnectionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9\",\"policyDefinitionReferenceId\":\"storageAccountShouldUseAPrivateLinkConnectionMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-6\"],\"parameters\":{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('authenticationToLinuxMachinesShouldRequireSSHKeysMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/630c64f9-8b6b-4c64-b511-6544ceff6fd6\",\"policyDefinitionReferenceId\":\"authenticationToLinuxMachinesShouldRequireSSHKeysMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('privateEndpointConnectionsOnAzureSQLDatabaseShouldBeEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/7698e800-9299-47a6-b3b6-5a0fee576eed\",\"policyDefinitionReferenceId\":\"privateEndpointConnectionsOnAzureSQLDatabaseShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('publicNetworkAccessOnAzureSQLDatabaseShouldBeDisabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780\",\"policyDefinitionReferenceId\":\"publicNetworkAccessOnAzureSQLDatabaseShouldBeDisabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('kubernetesClustersShouldBeAccessibleOnlyOverHTTPSMonitoringEffect')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('kubernetesClustersShouldBeAccessibleOnlyOverHTTPSExcludedNamespaces')]\"},\"labelSelector\":{\"value\":\"[parameters('kubernetesClustersShouldBeAccessibleOnlyOverHTTPSLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\",\"policyDefinitionReferenceId\":\"kubernetesClustersShouldBeAccessibleOnlyOverHTTPSMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"parameters\":{\"IncludeArcMachines\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsIncludeArcMachines')]\"},\"MinimumTLSVersion\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMinimumTLSVersion')]\"},\"effect\":{\"value\":\"[parameters('windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5752e6d6-1206-46d8-8ab1-ecc2f71a8112\",\"policyDefinitionReferenceId\":\"windowsWebServersShouldBeConfiguredToUseSecureCommunicationProtocolsMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('cognitiveServicesAccountsShouldRestrictNetworkAccessMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3\",\"policyDefinitionReferenceId\":\"cognitiveServicesAccountsShouldRestrictNetworkAccessMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1b4d1c4e-934c-4703-944c-27c82c06bebb\",\"policyDefinitionReferenceId\":\"diagnosticLogsInAzureAIServicesResourcesShouldBeEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d6759c02-b87f-42b7-892e-71b3f471d782\",\"policyDefinitionReferenceId\":\"azureAIServicesResourcesShouldUseAzurePrivateLinkMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('aPIManagementServicesShouldUseAVirtualNetworkMonitoringEffect')]\"},\"evaluatedSkuNames\":{\"value\":\"[parameters('aPIManagementServicesShouldUseAVirtualNetworkEvaluatedSkuNames')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b\",\"policyDefinitionReferenceId\":\"aPIManagementServicesShouldUseAVirtualNetworkMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('azureCosmosDBAccountsShouldHaveFirewallRulesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\",\"policyDefinitionReferenceId\":\"azureCosmosDBAccountsShouldHaveFirewallRulesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IR-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('networkWatcherShouldBeEnabledMonitoringEffect')]\"},\"resourceGroupName\":{\"value\":\"[parameters('networkWatcherShouldBeEnabledResourceGroupName')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\",\"policyDefinitionReferenceId\":\"networkWatcherShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/afe0c3be-ba3b-4544-ba52-0c99672a8ad6\",\"policyDefinitionReferenceId\":\"resourceLogsInAzureMachineLearningWorkspacesShouldBeEnabled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce\",\"policyDefinitionReferenceId\":\"azureMachineLearningWorkspacesShouldDisablePublicNetworkAccess\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/7804b5c7-01dc-4723-969b-ae300cc07ff1\",\"policyDefinitionReferenceId\":\"azureMachineLearningComputesShouldBeInAVirtualNetwork\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f\",\"policyDefinitionReferenceId\":\"azureMachineLearningComputesShouldHaveLocalAuthenticationMethodsDisabled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2\",\"policyDefinitionReferenceId\":\"azureMachineLearningComputeInstancesshouldUseTheLatestOsImage\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/138ff14d-b687-4faa-a81c-898c91a87fa2\",\"policyDefinitionReferenceId\":\"resourceLogsInAzureDatabricksWorkspacesShouldBeEnabled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2\",\"policyDefinitionReferenceId\":\"azureDatabricksWorkspacesShouldDisablePublicNetworkAccess\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/51c1490f-3319-459c-bbbc-7f391bbed753\",\"policyDefinitionReferenceId\":\"azureDatabricksClustersShouldDisablePublicIp\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9c25c9e4-ee12-4882-afd2-11fb9d87893f\",\"policyDefinitionReferenceId\":\"azureDatabricksWorkspacesShouldBeInAVirtualNetwork\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/258823f2-4595-4b52-b333-cc96192710d8\",\"policyDefinitionReferenceId\":\"azureDatabricksWorkspacesShouldUsePrivateLink\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('AzureDefenderForResourceManagerShouldBeEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/c3d20c29-b36d-48fe-808b-99a87530ad99\",\"policyDefinitionReferenceId\":\"AzureDefenderForResourceManagerShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringEffect')]\"},\"labelSelector\":{\"value\":\"[parameters('KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373\",\"policyDefinitionReferenceId\":\"KubernetesClustersShouldNotUseTheDefaultNamespaceMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/423dd1ba-798e-40e4-9c4d-b6902674b423\",\"policyDefinitionReferenceId\":\"KubernetesClustersShouldDisableAutomountingAPICredentialsMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringEffect')]\"},\"excludedImages\":{\"value\":\"[parameters('excludedImagesInKubernetesCluster')]\"},\"excludedNamespaces\":{\"value\":\"[parameters('KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringNamespaceExclusion')]\"},\"labelSelector\":{\"value\":\"[parameters('KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringLabelSelector')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d2e7ea85-6b44-4317-a0be-1b951587f626\",\"policyDefinitionReferenceId\":\"KubernetesClustersShouldNotGrantCAPSYSADMINSecurityCapabilitiesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('VtpmShouldBeEnabledOnSupportedVirtualMachinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1c30f9cd-b84c-49cc-aa2c-9288447cc3b3\",\"policyDefinitionReferenceId\":\"VtpmShouldBeEnabledOnSupportedVirtualMachinesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('SecureBootShouldBeEnabledOnSupportedWindowsVirtualMachinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/97566dd7-78ae-4997-8b36-1c7bfe0d8121\",\"policyDefinitionReferenceId\":\"previewSecureBootShouldBeEnabledOnSupportedWindowsVirtualMachinesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/672fe5a1-2fcd-42d7-b85d-902b6e28c6ff\",\"policyDefinitionReferenceId\":\"GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesScaleSetsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a21f8c92-9e22-4f09-b759-50500d1d2dda\",\"policyDefinitionReferenceId\":\"GuestAttestationExtensionShouldBeInstalledOnSupportedLinuxVirtualMachinesScaleSetsMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1cb4d9c2-f88f-4069-bee0-dba239a57b09\",\"policyDefinitionReferenceId\":\"GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesScaleSetsMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f655e522-adff-494d-95c2-52d4f6d56a42\",\"policyDefinitionReferenceId\":\"GuestAttestationExtensionShouldBeInstalledOnSupportedWindowsVirtualMachinesScaleSetsMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('LinuxVirtualMachineShouldUseSignedAndTrustedBootComponentEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/13a6c84f-49a5-410a-b5df-5b880c3fe009\",\"policyDefinitionReferenceId\":\"LinuxVirtualMachineShouldUseSignedAndTrustedBootComponentEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-3\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('diagnosticsLogsInKubernetesMonitoringEffect')]\"},\"requiredRetentionDays\":{\"value\":\"[parameters('diagnosticsLogsInKubernetesRetentionDays')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/245fc9df-fa96-4414-9a0b-3738c2f7341c\",\"policyDefinitionReferenceId\":\"diagnosticsLogsInKubernetesMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-2\",\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('AzureDefenderForOpenSourceRelationalDatabasesShouldBeEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0a9fbe0d-c5c4-4da8-87d8-f4fd77338835\",\"policyDefinitionReferenceId\":\"AzureDefenderForOpenSourceRelationalDatabasesShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('MicrosoftDefenderCSPMShouldBeEnabledMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1f90fc71-a595-4066-8974-d4d0802e8ef0\",\"policyDefinitionReferenceId\":\"MicrosoftDefenderCSPMShouldBeEnabledMonitoringEffect\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('gcLinuxDiskEncryptionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ca88aadc-6e2b-416c-9de2-5a0f01d1693f\",\"policyDefinitionReferenceId\":\"gcLinuxDiskEncryptionMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"parameters\":{\"effect\":{\"value\":\"[parameters('gcWindowsDiskEncryptionMonitoringEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3dc5edcd-002d-444c-b216-e123bbfa37c0\",\"policyDefinitionReferenceId\":\"gcWindowsDiskEncryptionMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027\",\"policyDefinitionReferenceId\":\"sqlServerADOnlyEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b3a22bc9-66de-45fb-98fa-00f5df42f41a\",\"policyDefinitionReferenceId\":\"sqlServerDisableADOnlyAuthMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/146412e9-005c-472b-9e48-c87b72ac229e\",\"policyDefinitionReferenceId\":\"mySqlServerADAdminisMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b4dec045-250a-48c2-b5cc-e0c4eec8b5b4\",\"policyDefinitionReferenceId\":\"postgreSqlServerADAdminisMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f\",\"policyDefinitionReferenceId\":\"sqlManagedInstanceADOnlyEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0c28c3fb-c244-42d5-a9bf-f35f2999577b\",\"policyDefinitionReferenceId\":\"sqlManagedInstanceDisablingADOnlyAuthMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8\",\"policyDefinitionReferenceId\":\"synapseWorkspaceADOnlyEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/6ea81a52-5ca7-4575-9669-eaa910b7edf8\",\"policyDefinitionReferenceId\":\"synapseWorkspaceDisablingADOnlyAuthMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PA-7\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldNotHaveAllApisScopedSubscriptions\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldNotBypassCertificateValidation\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldUseEncryptedProtocols\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-8\",\"Azure_Security_Benchmark_v3.0_DP-6\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldUseKeyVaultForSecretNamedValues\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldHaveDirectManagementEndpointDisabled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldDisableServiceConfigurationEndpoints\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-8\",\"Azure_Security_Benchmark_v3.0_PV-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldHaveMinimumAPIVersionSet\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54\",\"policyDefinitionReferenceId\":\"aPIManagementServiceShouldHaveBackendCallsAuthenticated\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/40e85574-ef33-47e8-a854-7a65c7500560\",\"policyDefinitionReferenceId\":\"mySqlServerADOnlyEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-5\",\"Azure_Security_Benchmark_v3.0_IM-8\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3ac7c827-eea2-4bde-acc7-9568cd320efa\",\"policyDefinitionReferenceId\":\"serverSecretFindingsMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_AM-3\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/c8acafaf-3d23-44d1-9624-978ef0f8652c\",\"policyDefinitionReferenceId\":\"unusedApisShouldbeDisabledAndRemovedFromApim\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/8ac833bd-f505-48d5-887e-c993a1d3eea0\",\"policyDefinitionReferenceId\":\"apimApiEndpointsShouldbeAuthenticated\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-2\",\"Azure_Security_Benchmark_v3.0_LT-1\",\"Azure_Security_Benchmark_v3.0_LT-2\",\"Azure_Security_Benchmark_v3.0_IR-3\",\"Azure_Security_Benchmark_v3.0_IR-5\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/640d2586-54d2-465f-877f-9ffc1d2109f4\",\"policyDefinitionReferenceId\":\"defenderForStorageShouldBeEnabledMonitoring\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc\",\"policyDefinitionReferenceId\":\"cognitiveServicesAccountsShouldHaveLocalAuthenticationMethodsDisabled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/cddd188c-4b82-4c48-a19d-ddf74ee66a01\",\"policyDefinitionReferenceId\":\"cognitiveServicesShouldUsePrivateLink\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87\",\"policyDefinitionReferenceId\":\"virtualMachinesAndVirtualMachineScaleSetsShouldHaveEncryptionAtHostEnabled\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a\",\"policyDefinitionReferenceId\":\"azureCosmosDBShouldDisablePublicNetworkAccess\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/58440f8a-10c5-4151-bdce-dfbaad4a20b7\",\"policyDefinitionReferenceId\":\"cosmosDBAaccountsShouldUsePrivateLink\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7\",\"policyDefinitionReferenceId\":\"vPNGatewaysShouldUseOnlyAzureActiveDirectoryAzureADAuthenticationForPointtositeUsers\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\",\"Azure_Security_Benchmark_v3.0_IM-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf\",\"policyDefinitionReferenceId\":\"azureSQLDatabaseShouldBeRunningTLSVersion12OrNewer\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_NS-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91\",\"policyDefinitionReferenceId\":\"azureSQLManagedInstancesShouldDisablePublicNetworkAccess\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54\",\"policyDefinitionReferenceId\":\"storageAccountsShouldPreventSharedKeyAccess\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-2\",\"Azure_Security_Benchmark_v3.0_AM-2\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1dc2fc00-2245-4143-99f4-874c937f13ef\",\"policyDefinitionReferenceId\":\"aPIManagementServicePlatformVersionShouldBeStv2\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5e6bf724-0154-49bc-985f-27b2e07e636b\",\"policyDefinitionReferenceId\":\"hciSecuredCoreComplianceMonitoringAtCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_PV-4\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/dad3a6b9-4451-492f-a95c-69efc6f3fada\",\"policyDefinitionReferenceId\":\"hciWdacComplianceMonitoringAtCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-5\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/ee8ca833-1583-4d24-837e-96c2af9488a4\",\"policyDefinitionReferenceId\":\"hciDataAtRestEncryptedComplianceMonitoringAtCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_DP-3\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/36f0d6bc-a253-4df8-b25b-c3a5023ff443\",\"policyDefinitionReferenceId\":\"hciDataInTransitComplianceMonitoringAtCluster\"},{\"groupNames\":[\"Azure_Security_Benchmark_v3.0_IM-1\"],\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/fa498b91-8a7e-4710-9578-da944c68d1fe\",\"policyDefinitionReferenceId\":\"postgreSqlFlexibleServersEnableEntraOnlyAuthenticationMonitoring\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMs with Azure Monitoring Agent(AMA)",
            "display_name": "Legacy - Enable Azure Monitor for VMs",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "name": "55f3eceb-5573-4f18-9695-226972c6d74a",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VM_Deploy\"},{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMSS with Azure Monitoring Agent(AMA). Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Legacy - Enable Azure Monitor for Virtual Machine Scale Sets",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.2\"}",
            "name": "75714362-cae7-409e-9b99-a8e5075b7fad",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_VMSS_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_VMSS_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_VMSS_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_VMSS_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Defender on your SQL Servers and SQL Managed Instances to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Azure Defender to be enabled on SQL Servers and SQL Managed Instances",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"3.0.0\"}",
            "name": "9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
            "parameters": "",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
                "policy_group_names": [],
                "reference_id": "deployThreatDetectionOnSqlServers"
              },
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd",
                "policy_group_names": [],
                "reference_id": "deployThreatDetectionOnSqlManagedInstances"
              },
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/951c1558-50a5-4ca3-abb6-a93e3e2367a6",
                "policy_group_names": [],
                "reference_id": "deployThreatDetectionOnSynapseWorkspaces"
              }
            ],
            "policy_definitions": "[{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5\",\"policyDefinitionReferenceId\":\"deployThreatDetectionOnSqlServers\"},{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd\",\"policyDefinitionReferenceId\":\"deployThreatDetectionOnSqlManagedInstances\"},{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/951c1558-50a5-4ca3-abb6-a93e3e2367a6\",\"policyDefinitionReferenceId\":\"deployThreatDetectionOnSynapseWorkspaces\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/e20d08c5-6d64-656d-6465-ce9e37fd0ebc",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Endpoint agent on applicable images.",
            "display_name": "[Preview]: Deploy Microsoft Defender for Endpoint agent",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/e20d08c5-6d64-656d-6465-ce9e37fd0ebc",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "name": "e20d08c5-6d64-656d-6465-ce9e37fd0ebc",
            "parameters": "{\"microsoftDefenderForEndpointLinuxArcAgentDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable deploy Microsoft Defender for Endpoint agent on hybrid Linux virtual machines.\",\"displayName\":\"Deploy Microsoft Defender for Endpoint agent on hybrid Linux virtual machines\"}},\"microsoftDefenderForEndpointLinuxVmAgentDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable deploy Microsoft Defender for Endpoint agent on Linux virtual machines.\",\"displayName\":\"Deploy Microsoft Defender for Endpoint agent on Linux virtual machines\"}},\"microsoftDefenderForEndpointWindowsArcAgentDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable deploy Microsoft Defender for Endpoint agent on hybrid Windows virtual machines.\",\"displayName\":\"Deploy Microsoft Defender for Endpoint agent on hybrid Windows virtual machines\"}},\"microsoftDefenderForEndpointWindowsVmAgentDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable deploy Microsoft Defender for Endpoint agent on Windows virtual machines.\",\"displayName\":\"Deploy Microsoft Defender for Endpoint agent on Windows virtual machines\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointWindowsVmAgentDeployEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1ec9c2c2-6d64-656d-6465-3ec3309b8579",
                "policy_group_names": [],
                "reference_id": "microsoftDefenderForEndpointWindowsAgentDeploy"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointLinuxVmAgentDeployEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d30025d0-6d64-656d-6465-67688881b632",
                "policy_group_names": [],
                "reference_id": "microsoftDefenderForEndpointLinuxAgentDeploy"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointWindowsArcAgentDeployEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/37c043a6-6d64-656d-6465-b362dfeb354a",
                "policy_group_names": [],
                "reference_id": "microsoftDefenderForEndpointWindowsArcAgentDeploy"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointLinuxArcAgentDeployEffect')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4eb909e7-6d64-656d-6465-2eeb297a1625",
                "policy_group_names": [],
                "reference_id": "microsoftDefenderForEndpointLinuxArcAgentDeploy"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointWindowsVmAgentDeployEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1ec9c2c2-6d64-656d-6465-3ec3309b8579\",\"policyDefinitionReferenceId\":\"microsoftDefenderForEndpointWindowsAgentDeploy\"},{\"parameters\":{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointLinuxVmAgentDeployEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/d30025d0-6d64-656d-6465-67688881b632\",\"policyDefinitionReferenceId\":\"microsoftDefenderForEndpointLinuxAgentDeploy\"},{\"parameters\":{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointWindowsArcAgentDeployEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/37c043a6-6d64-656d-6465-b362dfeb354a\",\"policyDefinitionReferenceId\":\"microsoftDefenderForEndpointWindowsArcAgentDeploy\"},{\"parameters\":{\"effect\":{\"value\":\"[parameters('microsoftDefenderForEndpointLinuxArcAgentDeployEffect')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4eb909e7-6d64-656d-6465-2eeb297a1625\",\"policyDefinitionReferenceId\":\"microsoftDefenderForEndpointLinuxArcAgentDeploy\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Advanced Threat Protection on your non-Basic tier open-source relational databases to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. See https://aka.ms/AzDforOpenSourceDBsDocu.",
            "display_name": "Configure Advanced Threat Protection to be enabled on open-source relational databases",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.2.0\"}",
            "name": "e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
            "parameters": "",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3",
                "policy_group_names": [],
                "reference_id": "deployAtpOnAzureDatabaseForPostgreSqlServer"
              },
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816",
                "policy_group_names": [],
                "reference_id": "deployAtpOnAzureDatabaseForMySqlServer"
              },
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a6cf7411-da9e-49e2-aec0-cba0250eaf8c",
                "policy_group_names": [],
                "reference_id": "deployAdvancedThreatProtectionOnAzureDatabaseForMariaDbServer"
              },
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2a6ae02f-7590-40d7-88ba-b18e205a32fd",
                "policy_group_names": [],
                "reference_id": "deployAtpOnAzureDatabaseForPostgreSqlFlexibleServer"
              },
              {
                "parameter_values": "{}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3d5ed4c2-5e50-4c76-932b-8982691b68ae",
                "policy_group_names": [],
                "reference_id": "deployAtpOnAzureDatabaseForMySqlFlexibleServer"
              }
            ],
            "policy_definitions": "[{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3\",\"policyDefinitionReferenceId\":\"deployAtpOnAzureDatabaseForPostgreSqlServer\"},{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816\",\"policyDefinitionReferenceId\":\"deployAtpOnAzureDatabaseForMySqlServer\"},{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/a6cf7411-da9e-49e2-aec0-cba0250eaf8c\",\"policyDefinitionReferenceId\":\"deployAdvancedThreatProtectionOnAzureDatabaseForMariaDbServer\"},{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/2a6ae02f-7590-40d7-88ba-b18e205a32fd\",\"policyDefinitionReferenceId\":\"deployAtpOnAzureDatabaseForPostgreSqlFlexibleServer\"},{\"parameters\":{},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3d5ed4c2-5e50-4c76-932b-8982691b68ae\",\"policyDefinitionReferenceId\":\"deployAtpOnAzureDatabaseForMySqlFlexibleServer\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_1",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso",
          "schema_version": 0,
          "attributes": {
            "display_name": "contoso corp",
            "id": "/providers/Microsoft.Management/managementGroups/contoso",
            "name": "contoso",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/3504cf29-cd56-4edc-a482-14dfa1203a29",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_2",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned",
          "schema_version": 0,
          "attributes": {
            "display_name": "Decommissioned",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned",
            "name": "contoso-decommissioned",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-decommissioned",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
          "schema_version": 0,
          "attributes": {
            "display_name": "Landing Zones",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "name": "contoso-landing-zones",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-platform",
          "schema_version": 0,
          "attributes": {
            "display_name": "Platform",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-platform",
            "name": "contoso-platform",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-platform",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-sandboxes",
          "schema_version": 0,
          "attributes": {
            "display_name": "Sandboxes",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-sandboxes",
            "name": "contoso-sandboxes",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-sandboxes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_3",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-connectivity",
          "schema_version": 0,
          "attributes": {
            "display_name": "Connectivity",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-connectivity",
            "name": "contoso-connectivity",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-platform",
            "subscription_ids": [
              "48b06c82-e856-4464-8744-9609a1aa37fc"
            ],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-connectivity",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1",
          "schema_version": 0,
          "attributes": {
            "display_name": "CONTOSO AI Workloads",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1",
            "name": "contoso-corp-ai-1",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "subscription_ids": [
              "0a8166be-f63b-41bb-af7d-3d6f0ee3f0e3"
            ],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-identity",
          "schema_version": 0,
          "attributes": {
            "display_name": "Identity",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-identity",
            "name": "contoso-identity",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-platform",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-identity",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-management",
          "schema_version": 0,
          "attributes": {
            "display_name": "Management",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-management",
            "name": "contoso-management",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-platform",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/3504cf29-cd56-4edc-a482-14dfa1203a29/providers/Microsoft.Management/managementGroups/contoso-management",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_4",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_5",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_6",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "enterprise_scale",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Network Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Network Protection",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "a82f4bb9-7dbb-4c54-ac59-0338fcacd47a",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-connectivity",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:49.2294064Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enable-DDoS-VNET",
            "non_compliance_message": [
              {
                "content": "This resource should be compliant with the assigned policy.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/contoso-ddos/providers/Microsoft.Network/ddosProtectionPlans/contoso-ddos-swedencentral\"},\"effect\":{\"value\":\"Modify\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
          "schema_version": 0,
          "attributes": {
            "description": "Specifies the allowed locations (regions) where Resource Groups can be deployed.",
            "display_name": "Limit allowed locations for Resource Groups",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:31.1583335Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-RSG-Locations",
            "non_compliance_message": [
              {
                "content": "Resource groups must only be deployed to the allowed locations.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"canadaeast\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations",
          "schema_version": 0,
          "attributes": {
            "description": "Specifies the allowed locations (regions) where Resources can be deployed.",
            "display_name": "Limit allowed locations for Resources",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:46.0985082Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Resource-Locations",
            "non_compliance_message": [
              {
                "content": "Resources must only be deployed to the allowed locations.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"canadaeast\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
            "display_name": "Subnets should have a Network Security Group",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:28.8674894Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Subnet-Without-Nsg",
            "non_compliance_message": [
              {
                "content": "Subnets must have a Network Security Group.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"Audit\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm",
          "schema_version": 0,
          "attributes": {
            "description": "This initiative will help enforce and govern subscriptions that are placed within the decommissioned Management Group as part of your Subscription decommissioning process. See https://aka.ms/alz/policies for more information.",
            "display_name": "Enforce ALZ Decommissioned Guardrails",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "f4b48159-7c2b-4427-a11c-7cd91c3c8040",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:49.3821667Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-ALZ-Decomm",
            "non_compliance_message": [
              {
                "content": "This resource must be compliant with the assigned policy.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"listOfResourceTypesAllowed\":{\"value\":[\"microsoft.consumption/tags\",\"microsoft.authorization/roleassignments\",\"microsoft.authorization/roledefinitions\",\"microsoft.authorization/policyassignments\",\"microsoft.authorization/locks\",\"microsoft.authorization/policydefinitions\",\"microsoft.authorization/policysetdefinitions\",\"microsoft.resources/tags\",\"microsoft.authorization/roleeligibilityschedules\",\"microsoft.authorization/roleeligibilityscheduleinstances\",\"microsoft.authorization/roleassignmentschedules\",\"microsoft.authorization/roleassignmentscheduleinstances\"]}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows management port access from the Internet",
            "display_name": "Management port access from the Internet should be blocked",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-identity",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:57.7426745Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-MgmtPorts-Internet",
            "non_compliance_message": [
              {
                "content": "Management port access from the Internet must be blocked.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies creation of Public IPs under the assigned scope.",
            "display_name": "Deny the creation of public IP",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-identity",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:16.3794449Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Public-IP",
            "non_compliance_message": [
              {
                "content": "Public IPs must not be created under this scope.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"},\"listOfResourceTypesNotAllowed\":{\"value\":[\"Microsoft.Network/publicIPAddresses\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
            "display_name": "Subnets should have a Network Security Group",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-identity",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:46.606215Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Subnet-Without-Nsg",
            "non_compliance_message": [
              {
                "content": "Subnets should have a Network Security Group.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "e1087f17-09e9-417e-9a86-2d174537d4a0",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-identity",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:30.4870183Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Backup",
            "non_compliance_message": [
              {
                "content": "Backup on virtual machines without a given tag must be configured to a new recovery services vault with a default policy.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"deployIfNotExists\"},\"exclusionTagName\":{\"value\":\"\"},\"exclusionTagValue\":{\"value\":[]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF",
          "schema_version": 0,
          "attributes": {
            "description": "Assign the WAF should be enabled for Application Gateway audit policy.",
            "display_name": "Web Application Firewall (WAF) should be enabled for Application Gateway",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:12.3790315Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Audit-AppGW-WAF",
            "non_compliance_message": [
              {
                "content": "Web Application Firewall (WAF) should be enabled for Application Gateway.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"Audit\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure's check of the source and destination for a network interface. This should be reviewed by the network security team.",
            "display_name": "Network interfaces should disable IP forwarding",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:31.1716827Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-IP-forwarding",
            "non_compliance_message": [
              {
                "content": "Network interfaces should disable IP forwarding.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows management port access from the Internet",
            "display_name": "Management port access from the Internet should be blocked",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:56.9236846Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-MgmtPorts-Internet",
            "non_compliance_message": [
              {
                "content": "Management port access from the Internet should be blocked.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow containers to run with privilege escalation to root in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should not allow container privilege escalation",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:57.8589442Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Priv-Esc-AKS",
            "non_compliance_message": [],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow privileged containers creation in a Kubernetes cluster. This recommendation is part of CIS 5.2.1 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster should not allow privileged containers",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:28.1473092Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Privileged-AKS",
            "non_compliance_message": [],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Secure transfer to storage accounts should be enabled",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:52.3790381Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Storage-http",
            "non_compliance_message": [
              {
                "content": "Secure transfer to storage accounts should be enabled.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
            "display_name": "Subnets should have a Network Security Group",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:10.4119497Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Subnet-Without-Nsg",
            "non_compliance_message": [
              {
                "content": "Subnets should have a Network Security Group.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
          "schema_version": 0,
          "attributes": {
            "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
            "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "347f7b31-509b-4965-88fd-b79db5d40f95",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:30.5811606Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-AKS-Policy",
            "non_compliance_message": [
              {
                "content": "This resource should be compliant with the assigned policy.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing",
          "schema_version": 0,
          "attributes": {
            "description": "To ensure the operations performed against your SQL assets are captured, SQL servers should have auditing enabled. If auditing is not enabled, this policy will configure auditing events to flow to the specified Log Analytics workspace.",
            "display_name": "Configure SQL servers to have auditing enabled to Log Analytics workspace",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "f8b53075-5263-4dfa-bc4f-9a959899169d",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:14.4222001Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-AzSqlDb-Auditing",
            "non_compliance_message": [
              {
                "content": "SQL servers should have auditing enabled to Log Analytics workspace.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"logAnalyticsWorkspaceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/contoso-mgmt/providers/microsoft.operationalinsights/workspaces/contoso-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
          "schema_version": 0,
          "attributes": {
            "description": "This policy ensures that Threat Detection is enabled on SQL Servers.",
            "display_name": "Deploy Threat Detection on SQL servers",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "cac9cae7-198a-4797-b43a-342dfebd1cd4",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:49.11749Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-SQL-Threat",
            "non_compliance_message": [
              {
                "content": "Threat Detection should be deployed on SQL servers.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "4710a309-61ef-4259-955b-62563ae71936",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:15.2522971Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Backup",
            "non_compliance_message": [
              {
                "content": "Backup on virtual machines without a given tag should be configured to a new recovery services vault with a default policy.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Network Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Network Protection",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "456d81df-13a0-4df3-ad38-c61eb1197675",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:14.3268505Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enable-DDoS-VNET",
            "non_compliance_message": [
              {
                "content": "This resource should be compliant with the assigned policy.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/48b06c82-e856-4464-8744-9609a1aa37fc/resourceGroups/contoso-ddos/providers/Microsoft.Network/ddosProtectionPlans/contoso-ddos-swedencentral\"},\"effect\":{\"value\":\"Modify\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
            "display_name": "Kubernetes clusters should be accessible only over HTTPS",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:14.6315765Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-AKS-HTTPS",
            "non_compliance_message": [],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault",
          "schema_version": 0,
          "attributes": {
            "description": "This initiative assignment enables recommended ALZ guardrails for Azure Key Vault.",
            "display_name": "Enforce recommended guardrails for Azure Key Vault",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:46.1716513Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-GR-KeyVault",
            "non_compliance_message": [
              {
                "content": "This resource should be compliant with the assigned policy.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL",
          "schema_version": 0,
          "attributes": {
            "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit.",
            "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "8bfa8434-756c-4bf8-ad43-a2aa1370edf6",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:33.9949357Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-TLS-SSL",
            "non_compliance_message": [
              {
                "content": "TLS and SSL should be enabled for on resources without encryption in transit.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy resource group containing Log Analytics workspace and linked automation account to centralize logs and monitoring. The automation account is aprerequisite for solutions like Updates and Change Tracking.",
            "display_name": "Configure Log Analytics workspace and automation account to centralize logs and monitoring",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "e73dd992-a23d-404f-b527-e587c41440d3",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-management",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:32.3402393Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-Log-Analytics",
            "non_compliance_message": [
              {
                "content": "Log Analytics workspace and automation account should be configured to centralize logs and monitoring.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"automationAccountName\":{\"value\":\"contoso-automation\"},\"automationRegion\":{\"value\":\"swedencentral\"},\"dataRetention\":{\"value\":\"30\"},\"rgName\":{\"value\":\"contoso-mgmt\"},\"sku\":{\"value\":\"pergb2018\"},\"workspaceName\":{\"value\":\"contoso-la\"},\"workspaceRegion\":{\"value\":\"swedencentral\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-sandboxes/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox",
          "schema_version": 0,
          "attributes": {
            "description": "This initiative will help enforce and govern subscriptions that are placed within the Sandbox Management Group. See https://aka.ms/alz/policies for more information.",
            "display_name": "Enforce ALZ Sandbox Guardrails",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso-sandboxes/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso-sandboxes",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:46.3110515Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-ALZ-Sandbox",
            "non_compliance_message": [
              {
                "content": "ALZ Sandbox Guardrails must be enforced.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"listOfResourceTypesNotAllowed\":{\"value\":[\"microsoft.network/expressroutecircuits\",\"microsoft.network/expressroutegateways\",\"microsoft.network/expressrouteports\",\"microsoft.network/virtualwans\",\"microsoft.network/virtualhubs\",\"microsoft.network/vpngateways\",\"microsoft.network/p2svpngateways\",\"microsoft.network/vpnsites\",\"microsoft.network/virtualnetworkgateways\"]}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources",
          "schema_version": 0,
          "attributes": {
            "description": "This Policy initiative is a group of Policy definitions that help optimize cost by detecting unused but chargeable resources. Leverage this Policy initiative as a cost control to reveal orphaned resources that are driving cost.",
            "display_name": "Unused resources driving cost should be avoided",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:46.297759Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Audit-UnusedResources",
            "non_compliance_message": [
              {
                "content": "Unused resources driving cost must be avoided.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"EffectDisks\":{\"value\":\"Audit\"},\"EffectPublicIpAddresses\":{\"value\":\"Audit\"},\"EffectServerFarms\":{\"value\":\"Audit\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources",
          "schema_version": 0,
          "attributes": {
            "description": "Denies deployment of classic resource types under the assigned scope.",
            "display_name": "Deny the deployment of classic resources",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:53.7821203Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Classic-Resources",
            "non_compliance_message": [
              {
                "content": "Classic resources must not be deployed.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"},\"listOfResourceTypesNotAllowed\":{\"value\":[\"Microsoft.ClassicCompute/capabilities\",\"Microsoft.ClassicCompute/checkDomainNameAvailability\",\"Microsoft.ClassicCompute/domainNames\",\"Microsoft.ClassicCompute/domainNames/capabilities\",\"Microsoft.ClassicCompute/domainNames/internalLoadBalancers\",\"Microsoft.ClassicCompute/domainNames/serviceCertificates\",\"Microsoft.ClassicCompute/domainNames/slots\",\"Microsoft.ClassicCompute/domainNames/slots/roles\",\"Microsoft.ClassicCompute/domainNames/slots/roles/metricDefinitions\",\"Microsoft.ClassicCompute/domainNames/slots/roles/metrics\",\"Microsoft.ClassicCompute/moveSubscriptionResources\",\"Microsoft.ClassicCompute/operatingSystemFamilies\",\"Microsoft.ClassicCompute/operatingSystems\",\"Microsoft.ClassicCompute/operations\",\"Microsoft.ClassicCompute/operationStatuses\",\"Microsoft.ClassicCompute/quotas\",\"Microsoft.ClassicCompute/resourceTypes\",\"Microsoft.ClassicCompute/validateSubscriptionMoveAvailability\",\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines/diagnosticSettings\",\"Microsoft.ClassicCompute/virtualMachines/metricDefinitions\",\"Microsoft.ClassicCompute/virtualMachines/metrics\",\"Microsoft.ClassicInfrastructureMigrate/classicInfrastructureResources\",\"Microsoft.ClassicNetwork/capabilities\",\"Microsoft.ClassicNetwork/expressRouteCrossConnections\",\"Microsoft.ClassicNetwork/expressRouteCrossConnections/peerings\",\"Microsoft.ClassicNetwork/gatewaySupportedDevices\",\"Microsoft.ClassicNetwork/networkSecurityGroups\",\"Microsoft.ClassicNetwork/operations\",\"Microsoft.ClassicNetwork/quotas\",\"Microsoft.ClassicNetwork/reservedIps\",\"Microsoft.ClassicNetwork/virtualNetworks\",\"Microsoft.ClassicNetwork/virtualNetworks/remoteVirtualNetworkPeeringProxies\",\"Microsoft.ClassicNetwork/virtualNetworks/virtualNetworkPeerings\",\"Microsoft.ClassicStorage/capabilities\",\"Microsoft.ClassicStorage/checkStorageAccountAvailability\",\"Microsoft.ClassicStorage/disks\",\"Microsoft.ClassicStorage/images\",\"Microsoft.ClassicStorage/operations\",\"Microsoft.ClassicStorage/osImages\",\"Microsoft.ClassicStorage/osPlatformImages\",\"Microsoft.ClassicStorage/publicImages\",\"Microsoft.ClassicStorage/quotas\",\"Microsoft.ClassicStorage/storageAccounts\",\"Microsoft.ClassicStorage/storageAccounts/blobServices\",\"Microsoft.ClassicStorage/storageAccounts/fileServices\",\"Microsoft.ClassicStorage/storageAccounts/metricDefinitions\",\"Microsoft.ClassicStorage/storageAccounts/metrics\",\"Microsoft.ClassicStorage/storageAccounts/queueServices\",\"Microsoft.ClassicStorage/storageAccounts/services\",\"Microsoft.ClassicStorage/storageAccounts/services/diagnosticSettings\",\"Microsoft.ClassicStorage/storageAccounts/services/metricDefinitions\",\"Microsoft.ClassicStorage/storageAccounts/services/metrics\",\"Microsoft.ClassicStorage/storageAccounts/tableServices\",\"Microsoft.ClassicStorage/storageAccounts/vmImages\",\"Microsoft.ClassicStorage/vmImages\",\"Microsoft.ClassicSubscription/operations\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk",
          "schema_version": 0,
          "attributes": {
            "description": "Deny virtual machines that do not use managed disk. It checks the managed disk property on virtual machine OS Disk fields.",
            "display_name": "Deny virtual machines and virtual machine scale sets that do not use managed disk",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk",
            "identity": [],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:46.3840344Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-UnmanagedDisk",
            "non_compliance_message": [
              {
                "content": "Virtual machines and virtual machine scales sets must use a managed disk.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [
              {
                "selectors": [],
                "value": "Deny"
              }
            ],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Cloud Security Benchmark policy initiative.",
            "display_name": "Microsoft Cloud Security Benchmark",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "e662b80d-51c2-43c9-90ba-d130ca0f17dc",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:15:01.7003243Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-ASC-Monitoring",
            "non_compliance_message": [
              {
                "content": "Microsoft Cloud Security Benchmark must be met.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events",
            "display_name": "Configure Azure Activity logs to stream to specified Log Analytics workspace",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "cc300bdc-75e5-4116-8fad-c59484184f2e",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:30.0948141Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-AzActivity-Log",
            "non_compliance_message": [
              {
                "content": "Azure Activity logs must be configured to stream to specified Log Analytics workspace.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/contoso-mgmt/providers/Microsoft.OperationalInsights/workspaces/contoso-la\"},\"logsEnabled\":{\"value\":\"True\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Endpoint agent on applicable images.",
            "display_name": "[Preview]: Deploy Microsoft Defender for Endpoint agent",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "22d760f8-5be8-4668-a708-d2939dc94de9",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:59.1853954Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-MDEndpoints",
            "non_compliance_message": [
              {
                "content": "Microsoft Defender for Endpoint agent must be deployed on applicable images.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"microsoftDefenderForEndpointLinuxArcAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"},\"microsoftDefenderForEndpointLinuxVmAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"},\"microsoftDefenderForEndpointWindowsArcAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"},\"microsoftDefenderForEndpointWindowsVmAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/e20d08c5-6d64-656d-6465-ce9e37fd0ebc",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud and Security Contacts",
            "display_name": "Deploy Microsoft Defender for Cloud configuration",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:09:49.3752014Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-MDFC-Config",
            "non_compliance_message": [
              {
                "content": "Microsoft Defender for Cloud and Security Contacts must be deployed.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"ascExportResourceGroupLocation\":{\"value\":\"swedencentral\"},\"ascExportResourceGroupName\":{\"value\":\"contoso-asc-export\"},\"emailSecurityContact\":{\"value\":\"marcelolima@outlook.com\"},\"enableAscForApis\":{\"value\":\"DeployIfNotExists\"},\"enableAscForAppServices\":{\"value\":\"DeployIfNotExists\"},\"enableAscForArm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForContainers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForCosmosDbs\":{\"value\":\"DeployIfNotExists\"},\"enableAscForCspm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForDns\":{\"value\":\"DeployIfNotExists\"},\"enableAscForKeyVault\":{\"value\":\"DeployIfNotExists\"},\"enableAscForOssDb\":{\"value\":\"DeployIfNotExists\"},\"enableAscForServers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForServersVulnerabilityAssessments\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSql\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSqlOnVm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForStorage\":{\"value\":\"DeployIfNotExists\"},\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/contoso-mgmt/providers/Microsoft.OperationalInsights/workspaces/contoso-la\"},\"vulnerabilityAssessmentProvider\":{\"value\":\"default\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Advanced Threat Protection on your non-Basic tier open-source relational databases to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. See https://aka.ms/AzDforOpenSourceDBsDocu.",
            "display_name": "Configure Advanced Threat Protection to be enabled on open-source relational databases",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "213e5028-7301-4f98-a7ea-54785d06dd1b",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:15.391265Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-MDFC-OssDb",
            "non_compliance_message": [
              {
                "content": "Advanced Threat Protection must be enabled on open-source relational databases.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Defender on your SQL Servers and SQL Managed Instances to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Azure Defender to be enabled on SQL Servers and SQL Managed Instances",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "d4396eca-421a-429f-a4f6-22be505bbdde",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:57.4056304Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-MDFC-SqlAtp",
            "non_compliance_message": [
              {
                "content": "Azure Defender must be enabled on SQL Servers and SQL Managed Instances.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag",
          "schema_version": 0,
          "attributes": {
            "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. See the list of policies of the services that are included",
            "display_name": "Deploy Diagnostic Settings to Azure Services",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "3635ec49-f780-4fda-92a2-7572102801df",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:14:59.7019906Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-Resource-Diag",
            "non_compliance_message": [
              {
                "content": "Diagnostic settings must be deployed to Azure services.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/contoso-mgmt/providers/Microsoft.OperationalInsights/workspaces/contoso-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
            "display_name": "Enable Azure Monitor for VMs",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "522e0a32-b1bd-4fae-8ed9-6a665d752f43",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:18.6978737Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Monitoring",
            "non_compliance_message": [
              {
                "content": "Azure Monitor must be enabled for Virtual Machines.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/contoso-mgmt/providers/Microsoft.OperationalInsights/workspaces/contoso-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Enable Azure Monitor for Virtual Machine Scale Sets",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "daa3f748-5ace-4b85-8f28-a54702916460",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:11:33.7971762Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VMSS-Monitoring",
            "non_compliance_message": [
              {
                "content": "Azure Monitor must be enabled for Virtual Machines Scales Sets.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/contoso-mgmt/providers/Microsoft.OperationalInsights/workspaces/contoso-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB",
          "schema_version": 0,
          "attributes": {
            "description": "This initiative assignment enables Azure Compute Security Baseline compliance auditing for Windows and Linux virtual machines.",
            "display_name": "Enforce Azure Compute Security Baseline compliance auditing",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "fd8872b7-4136-4473-a3dc-c74fb766e723",
                "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:13:18.1780088Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-ACSB",
            "non_compliance_message": [
              {
                "content": "Azure Compute Security Baseline compliance auditing must be enforced.",
                "policy_definition_reference_id": ""
              }
            ],
            "not_scopes": [],
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "enterprise_scale",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
          "schema_version": 0,
          "attributes": {
            "description": "Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
            "display_name": "AppService append enable https only setting to enforce https setting.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:31.6931635Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Append-AppService-httpsonly",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"notequals\":true}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"value\":true}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Append the AppService sites object to ensure that min Tls version is set to required minimum TLS version. Please note Append does not enforce compliance use then deny.",
            "display_name": "AppService append sites with minimum TLS version to enforce.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:02.6230033Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Append-AppService-latestTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"Select version minimum TLS Web App config\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"notEquals\":\"[parameters('minTlsVersion')]\"}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"value\":\"[parameters('minTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added.",
            "display_name": "KeyVault SoftDelete should be enabled",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Key Vault\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:04:06.6293272Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-KV-SoftDelete",
            "parameters": "",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"notEquals\":true}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"value\":true}],\"effect\":\"append\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:03:56.2029981Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "Append-Redis-disableNonSslPort",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\",\"value\":false}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Append a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Cache for Redis Append a specific min TLS version requirement and enforce TLS.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:55.9864286Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-Redis-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Cache for Redis to enforce\",\"displayName\":\"Select version for Redis server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"value\":\"[parameters('minimumTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
          "schema_version": 0,
          "attributes": {
            "description": "Optimize cost by enabling Azure Hybrid Benefit. Leverage this Policy definition as a cost control to reveal Virtual Machines not using AHUB.",
            "display_name": "Audit AHUB for eligible VMs",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:33.7870331Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Audit-AzureHybridBenefit",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.Compute/virtualMachineScaleSets\"]},{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2008-R2-SP1*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2012-*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2016-*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2019-*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2022-*\"}]},{\"field\":\"Microsoft.Compute/licenseType\",\"notEquals\":\"Windows_Server\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
          "schema_version": 0,
          "attributes": {
            "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Disks that are driving cost.",
            "display_name": "Unused Disks driving cost should be avoided",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:29.6924114Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Audit-Disks-UnusedResourcesCostOptimization",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/disks\",\"field\":\"type\"},{\"equals\":\"Unattached\",\"field\":\"Microsoft.Compute/disks/diskState\"},{\"allof\":[{\"field\":\"name\",\"notlike\":\"*-ASRReplica\"},{\"field\":\"name\",\"notlike\":\"ms-asr-*\"},{\"field\":\"name\",\"notlike\":\"asrseeddisk-*\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
          "schema_version": 0,
          "attributes": {
            "description": "Audit private endpoints that are created in other subscriptions and/or tenants for Azure Machine Learning.",
            "display_name": "Control private endpoint connections to Azure Machine Learning",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:33:00.8330434Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Audit-MachineLearning-PrivateEndpointId",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections\",\"field\":\"type\"},{\"equals\":\"Approved\",\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateLinkServiceConnectionState.status\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id\"},{\"notEquals\":\"[subscription().subscriptionId]\",\"value\":\"[split(concat(field('Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id'), '//'), '/')[2]]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy audits the creation of a Private Link Private DNS Zones in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
            "display_name": "Audit the creation of Private Link Private DNS Zones",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:34.7784618Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Audit-PrivateLinkDnsZones",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateLinkDnsZones\":{\"type\":\"Array\",\"defaultValue\":[\"privatelink.adf.azure.com\",\"privatelink.afs.azure.net\",\"privatelink.agentsvc.azure-automation.net\",\"privatelink.analysis.windows.net\",\"privatelink.api.azureml.ms\",\"privatelink.azconfig.io\",\"privatelink.azure-api.net\",\"privatelink.azure-automation.net\",\"privatelink.azurecr.io\",\"privatelink.azure-devices.net\",\"privatelink.azure-devices-provisioning.net\",\"privatelink.azurehdinsight.net\",\"privatelink.azurehealthcareapis.com\",\"privatelink.azurestaticapps.net\",\"privatelink.azuresynapse.net\",\"privatelink.azurewebsites.net\",\"privatelink.batch.azure.com\",\"privatelink.blob.core.windows.net\",\"privatelink.cassandra.cosmos.azure.com\",\"privatelink.cognitiveservices.azure.com\",\"privatelink.database.windows.net\",\"privatelink.datafactory.azure.net\",\"privatelink.dev.azuresynapse.net\",\"privatelink.dfs.core.windows.net\",\"privatelink.dicom.azurehealthcareapis.com\",\"privatelink.digitaltwins.azure.net\",\"privatelink.directline.botframework.com\",\"privatelink.documents.azure.com\",\"privatelink.eventgrid.azure.net\",\"privatelink.file.core.windows.net\",\"privatelink.gremlin.cosmos.azure.com\",\"privatelink.guestconfiguration.azure.com\",\"privatelink.his.arc.azure.com\",\"privatelink.kubernetesconfiguration.azure.com\",\"privatelink.managedhsm.azure.net\",\"privatelink.mariadb.database.azure.com\",\"privatelink.media.azure.net\",\"privatelink.mongo.cosmos.azure.com\",\"privatelink.monitor.azure.com\",\"privatelink.mysql.database.azure.com\",\"privatelink.notebooks.azure.net\",\"privatelink.ods.opinsights.azure.com\",\"privatelink.oms.opinsights.azure.com\",\"privatelink.pbidedicated.windows.net\",\"privatelink.postgres.database.azure.com\",\"privatelink.prod.migration.windowsazure.com\",\"privatelink.purview.azure.com\",\"privatelink.purviewstudio.azure.com\",\"privatelink.queue.core.windows.net\",\"privatelink.redis.cache.windows.net\",\"privatelink.redisenterprise.cache.azure.net\",\"privatelink.search.windows.net\",\"privatelink.service.signalr.net\",\"privatelink.servicebus.windows.net\",\"privatelink.siterecovery.windowsazure.com\",\"privatelink.sql.azuresynapse.net\",\"privatelink.table.core.windows.net\",\"privatelink.table.cosmos.azure.com\",\"privatelink.tip1.powerquery.microsoft.com\",\"privatelink.token.botframework.com\",\"privatelink.vaultcore.azure.net\",\"privatelink.web.core.windows.net\",\"privatelink.webpubsub.azure.com\"],\"metadata\":{\"description\":\"An array of Private Link Private DNS Zones to check for the existence of in the assigned scope.\",\"displayName\":\"Private Link Private DNS Zones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateDnsZones\",\"field\":\"type\"},{\"field\":\"name\",\"in\":\"[parameters('privateLinkDnsZones')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
          "schema_version": 0,
          "attributes": {
            "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Public IP addresses that are driving cost.",
            "display_name": "Unused Public IP addresses driving cost should be avoided",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:32:59.1941628Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"microsoft.network/publicIpAddresses\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/publicIPAddresses/sku.name\",\"notEquals\":\"Basic\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Network/publicIPAddresses/natGateway\"},{\"equals\":true,\"value\":\"[equals(length(field('Microsoft.Network/publicIPAddresses/natGateway')), 0)]\"}]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Network/publicIPAddresses/ipConfiguration\"},{\"equals\":true,\"value\":\"[equals(length(field('Microsoft.Network/publicIPAddresses/ipConfiguration')), 0)]\"}]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Network/publicIPAddresses/publicIPPrefix\"},{\"equals\":true,\"value\":\"[equals(length(field('Microsoft.Network/publicIPAddresses/publicIPPrefix')), 0)]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
          "schema_version": 0,
          "attributes": {
            "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned App Service plans that are driving cost.",
            "display_name": "Unused App Service plans driving cost should be avoided",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:42.3919437Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Audit-ServerFarms-UnusedResourcesCostOptimization",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/serverfarms\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/serverFarms/sku.tier\",\"notEquals\":\"Free\"},{\"equals\":0,\"field\":\"Microsoft.Web/serverFarms/numberOfSites\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of child resources on the Automation Account",
            "display_name": "No child resources in Automation Account",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureUSGovernment\"],\"category\":\"Automation\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:05.6186102Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AA-child-resources",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Automation/automationAccounts/runbooks\",\"Microsoft.Automation/automationAccounts/variables\",\"Microsoft.Automation/automationAccounts/modules\",\"Microsoft.Automation/automationAccounts/credentials\",\"Microsoft.Automation/automationAccounts/connections\",\"Microsoft.Automation/automationAccounts/certificates\"]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to restrict that Application Gateways is always deployed with WAF enabled",
            "display_name": "Application Gateway should be deployed with WAF enabled",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:35.4927914Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppGW-Without-WAF",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/applicationGateways/sku.name\",\"notequals\":\"WAF_v2\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "API App should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:09.228299Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceApiApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "Function App should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:31.9073805Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceFunctionApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"functionapp*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "Web Application should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:51:45.3547082Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceWebApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"app*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
          "schema_version": 0,
          "attributes": {
            "description": "Denies the deployment of workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.",
            "display_name": "Deny public IPs for Databricks cluster",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:33.4382224Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-NoPublicIp",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for AAD.",
            "display_name": "Deny non-premium Databricks sku",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:28.5340586Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-Sku",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/sku.name\",\"notEquals\":\"premium\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of vnet injection for Databricks workspaces.",
            "display_name": "Deny Databricks workspaces without Vnet injection",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:38.1668038Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-VirtualNetwork",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customVirtualNetworkId.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPublicSubnetName.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPrivateSubnetName.value\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureAuth",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the use of insecure authentication methods (NTLMv2) when using File Services on a storage account.",
            "display_name": "File Services with insecure authentication methods should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureAuth",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:43.5012102Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-FileServices-InsecureAuth",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"notAllowedAuthMethods\":{\"type\":\"String\",\"allowedValues\":[\"NTLMv2\",\"Kerberos\"],\"defaultValue\":\"NTLMv2\",\"metadata\":{\"description\":\"The list of channelEncryption not allowed.\",\"displayName\":\"Authentication methods supported by server. Valid values are NTLMv2, Kerberos.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"contains\":\"[parameters('notAllowedAuthMethods')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.authenticationMethods\"},{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureKerberos",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the use of insecure Kerberos ticket encryption (RC4-HMAC) when using File Services on a storage account.",
            "display_name": "File Services with insecure Kerberos ticket encryption should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureKerberos",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:48:56.2704423Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-FileServices-InsecureKerberos",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"notAllowedKerberosTicketEncryption\":{\"type\":\"String\",\"allowedValues\":[\"RC4-HMAC\",\"AES-256\"],\"defaultValue\":\"RC4-HMAC\",\"metadata\":{\"description\":\"The list of kerberosTicketEncryption not allowed.\",\"displayName\":\"Kerberos ticket encryption supported by server. Valid values are RC4-HMAC, AES-256.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},{\"contains\":\"[parameters('notAllowedKerberosTicketEncryption')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.kerberosTicketEncryption\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbChannel",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the use of insecure channel encryption (AES-128-CCM) when using File Services on a storage account.",
            "display_name": "File Services with insecure SMB channel encryption should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbChannel",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:01.8631476Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-FileServices-InsecureSmbChannel",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"notAllowedChannelEncryption\":{\"type\":\"String\",\"allowedValues\":[\"AES-128-CCM\",\"AES-128-GCM\",\"AES-256-GCM\"],\"defaultValue\":\"AES-128-CCM\",\"metadata\":{\"description\":\"The list of channelEncryption not allowed.\",\"displayName\":\"SMB channel encryption supported by server. Valid values are AES-128-CCM, AES-128-GCM, AES-256-GCM.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},{\"contains\":\"[parameters('notAllowedChannelEncryption')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.channelEncryption\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbVersions",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the use of insecure versions of SMB (2.1 \u0026 3.0) when using File Services on a storage account.",
            "display_name": "File Services with insecure SMB versions should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbVersions",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:34.1806773Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-FileServices-InsecureSmbVersions",
            "parameters": "{\"allowedSmbVersion\":{\"type\":\"String\",\"allowedValues\":[\"SMB2.1\",\"SMB3.0\",\"SMB3.1.1\"],\"defaultValue\":\"SMB3.1.1\",\"metadata\":{\"description\":\"The allowed SMB version for maximum security\",\"displayName\":\"Allowed SMB Version\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},{\"not\":{\"contains\":\"[parameters('allowedSmbVersion')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.versions\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
          "schema_version": 0,
          "attributes": {
            "description": "Deny AKS cluster creation in Azure Machine Learning and enforce connecting to existing clusters.",
            "display_name": "Deny AKS cluster creation in Azure Machine Learning",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:01.1478271Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Aks",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AKS\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/resourceId\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/resourceId'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances.",
            "display_name": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:00:51.3529413Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Compute-SubnetId",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/subnet.id\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
          "schema_version": 0,
          "attributes": {
            "description": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances.",
            "display_name": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Budget\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:02.2072825Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Compute-VmSize",
            "parameters": "{\"allowedVmSizes\":{\"type\":\"Array\",\"defaultValue\":[\"Standard_D1_v2\",\"Standard_D2_v2\",\"Standard_D3_v2\",\"Standard_D4_v2\",\"Standard_D11_v2\",\"Standard_D12_v2\",\"Standard_D13_v2\",\"Standard_D14_v2\",\"Standard_DS1_v2\",\"Standard_DS2_v2\",\"Standard_DS3_v2\",\"Standard_DS4_v2\",\"Standard_DS5_v2\",\"Standard_DS11_v2\",\"Standard_DS12_v2\",\"Standard_DS13_v2\",\"Standard_DS14_v2\",\"Standard_M8-2ms\",\"Standard_M8-4ms\",\"Standard_M8ms\",\"Standard_M16-4ms\",\"Standard_M16-8ms\",\"Standard_M16ms\",\"Standard_M32-8ms\",\"Standard_M32-16ms\",\"Standard_M32ls\",\"Standard_M32ms\",\"Standard_M32ts\",\"Standard_M64-16ms\",\"Standard_M64-32ms\",\"Standard_M64ls\",\"Standard_M64ms\",\"Standard_M64s\",\"Standard_M128-32ms\",\"Standard_M128-64ms\",\"Standard_M128ms\",\"Standard_M128s\",\"Standard_M64\",\"Standard_M64m\",\"Standard_M128\",\"Standard_M128m\",\"Standard_D1\",\"Standard_D2\",\"Standard_D3\",\"Standard_D4\",\"Standard_D11\",\"Standard_D12\",\"Standard_D13\",\"Standard_D14\",\"Standard_DS15_v2\",\"Standard_NV6\",\"Standard_NV12\",\"Standard_NV24\",\"Standard_F2s_v2\",\"Standard_F4s_v2\",\"Standard_F8s_v2\",\"Standard_F16s_v2\",\"Standard_F32s_v2\",\"Standard_F64s_v2\",\"Standard_F72s_v2\",\"Standard_NC6s_v3\",\"Standard_NC12s_v3\",\"Standard_NC24rs_v3\",\"Standard_NC24s_v3\",\"Standard_NC6\",\"Standard_NC12\",\"Standard_NC24\",\"Standard_NC24r\",\"Standard_ND6s\",\"Standard_ND12s\",\"Standard_ND24rs\",\"Standard_ND24s\",\"Standard_NC6s_v2\",\"Standard_NC12s_v2\",\"Standard_NC24rs_v2\",\"Standard_NC24s_v2\",\"Standard_ND40rs_v2\",\"Standard_NV12s_v3\",\"Standard_NV24s_v3\",\"Standard_NV48s_v3\"],\"metadata\":{\"description\":\"Specifies the allowed VM Sizes for Aml Compute Clusters and Instances\",\"displayName\":\"Allowed VM Sizes for Aml Compute Clusters and Instances\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/vmSize\",\"notIn\":\"[parameters('allowedVmSizes')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
          "schema_version": 0,
          "attributes": {
            "description": "Deny public access of Azure Machine Learning clusters via SSH.",
            "display_name": "Deny public access of Azure Machine Learning clusters via SSH",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:14.3801665Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce scale settings for Azure Machine Learning compute clusters.",
            "display_name": "Enforce scale settings for Azure Machine Learning compute clusters",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Budget\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:41:13.2673967Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-ComputeCluster-Scale",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"maxNodeCount\":{\"type\":\"Integer\",\"defaultValue\":10,\"metadata\":{\"description\":\"Specifies the maximum node count of AML Clusters\",\"displayName\":\"Maximum Node Count\"}},\"maxNodeIdleTimeInSecondsBeforeScaleDown\":{\"type\":\"Integer\",\"defaultValue\":900,\"metadata\":{\"description\":\"Specifies the maximum node idle time in seconds before scaledown\",\"displayName\":\"Maximum Node Idle Time in Seconds Before Scaledown\"}},\"minNodeCount\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"Specifies the minimum node count of AML Clusters\",\"displayName\":\"Minimum Node Count\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.maxNodeCount\",\"greater\":\"[parameters('maxNodeCount')]\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.minNodeCount\",\"greater\":\"[parameters('minNodeCount')]\"},{\"greater\":\"[parameters('maxNodeIdleTimeInSecondsBeforeScaleDown')]\",\"value\":\"[int(last(split(replace(replace(replace(replace(replace(replace(replace(field('Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.nodeIdleTimeBeforeScaleDown'), 'P', '/'), 'Y', '/'), 'M', '/'), 'D', '/'), 'T', '/'), 'H', '/'), 'S', ''), '/')))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces high business impact Azure Machine Learning workspaces.",
            "display_name": "Enforces high business impact Azure Machine Learning Workspaces",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:10.12219Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-HbiWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
          "schema_version": 0,
          "attributes": {
            "description": "Deny public access behind vnet to Azure Machine Learning workspaces.",
            "display_name": "Deny public access behind vnet to Azure Machine Learning workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:56.1736656Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\",\"notEquals\":false}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
          "schema_version": 0,
          "attributes": {
            "description": "Denies public network access for Azure Machine Learning workspaces.",
            "display_name": "[Deprecated] Azure Machine Learning should have disabled public network access",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:16.3605695Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-PublicNetworkAccess",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows management port access from the Internet",
            "display_name": "Management port access from the Internet should be blocked",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:32.7595524Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.1.0\"}",
            "mode": "All",
            "name": "Deny-MgmtPorts-From-Internet",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"ports\":{\"type\":\"Array\",\"defaultValue\":[\"22\",\"3389\"],\"metadata\":{\"description\":\"Ports to be blocked\",\"displayName\":\"Ports\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups/securityRules\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\"in\":\"[parameters('ports')]\"},{\"count\":{\"value\":\"[parameters('ports')]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current())),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current()))), 'false')]\"}},\"greater\":0},{\"count\":{\"name\":\"ports\",\"value\":\"[parameters('ports')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]\"}},\"greater\":0}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notIn\":\"[parameters('ports')]\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*]\",\"where\":{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\"},{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\",\"in\":\"[parameters('ports')]\"},{\"count\":{\"name\":\"ports\",\"value\":\"[parameters('ports')]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports')))), 'false')]\"}},\"greater\":0},{\"count\":{\"name\":\"ports\",\"value\":\"[parameters('ports')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]\"}},\"greater\":0}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\"notIn\":\"[parameters('ports')]\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}},\"greater\":0}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "MySQL database servers enforce SSL connections.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:42.161193Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MySql-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "PostgreSQL database servers enforce SSL connection.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:33.2614229Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "Deny-PostgreSql-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
            "display_name": "Deny the creation of private DNS",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:37.3388638Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Private-DNS-Zones",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/privateDnsZones\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of Maria DB accounts with exposed public endpoints",
            "display_name": "[Deprecated] Public network access should be disabled for MariaDB",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:50:04.6442884Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deny-PublicEndpoint-MariaDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/publicNetworkAccess\",\"notequals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
          "schema_version": 0,
          "attributes": {
            "description": "[Deprecated] This policy denies creation of Public IPs under the assigned scope.",
            "display_name": "[Deprecated] Deny the creation of public IP",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:36.999352Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deny-PublicIP",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows RDP access from Internet. This policy is superceded by new custom ALZ policy 'Deny-MgmtPorts-From-Internet'.",
            "display_name": "[Deprecated] RDP access from the Internet should be blocked",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:49:19.744972Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1-deprecated\"}",
            "mode": "All",
            "name": "Deny-RDP-From-Internet",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups/securityRules\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"3389\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"true\",\"value\":\"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]\"}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"3389\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of only connections via SSL to Azure Cache for Redis. Validate both minimum TLS version and enableNonSslPort is disabled. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Azure Cache for Redis only secure connections should be enabled",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:37.7403929Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Redis-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select minimum TLS version for Azure Cache for Redis.\",\"displayName\":\"Select minumum TLS version for Azure Cache for Redis.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"},{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
            "display_name": "Azure SQL Database should have the minimal TLS version set to the highest version",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:14.6549156Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Sql-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
            "display_name": "SQL Managed Instance should have the minimal TLS version set to the highest version",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:41.6487878Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-SqlMi-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of Storage Accounts with SFTP enabled for Blob Storage.",
            "display_name": "Storage Accounts with SFTP enabled should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:33.8656702Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Storage-SFTP",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/isSftpEnabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Storage Account set to minimum TLS and Secure transfer should be enabled",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:32:59.0380295Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Storage-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-04-01\",\"value\":\"[requestContext().apiVersion]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"}]},{\"equals\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-StorageAccount-CustomDomain",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of Storage Accounts with custom domains assigned as communication cannot be encrypted, and always uses HTTP.",
            "display_name": "Storage Accounts with custom domains assigned should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-StorageAccount-CustomDomain",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:56.0705616Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-StorageAccount-CustomDomain",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/customDomain\"},{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/customDomain.useSubDomainName\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group. NSG help to protect traffic across subnet-level.",
            "display_name": "Subnets should have a Network Security Group",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:34.8955476Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "Deny-Subnet-Without-Nsg",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"GatewaySubnet\",\"AzureFirewallSubnet\",\"AzureFirewallManagementSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Penp",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without Private Endpoint Netwotk Policies enabled. This policy is intended for 'workload' subnets, not 'central infrastructure' (aka, 'hub') subnets.",
            "display_name": "Subnets without Private Endpoint Network Policies enabled should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Penp",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:32:58.945381Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-Subnet-Without-Penp",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"GatewaySubnet\",\"AzureFirewallSubnet\",\"AzureFirewallManagementSubnet\",\"AzureBastionSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].privateEndpointNetworkPolicies\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets/privateEndpointNetworkPolicies\",\"notEquals\":\"Enabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a User Defined Route (UDR).",
            "display_name": "Subnets should have a User Defined Route",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:02.4974778Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "Deny-Subnet-Without-Udr",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"AzureBastionSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].routeTable.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/routeTable.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-UDR-With-Specific-NextHop",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a User Defined Route with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway'.",
            "display_name": "User Defined Routes with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway' should be denied",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-UDR-With-Specific-NextHop",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:10.931559Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-UDR-With-Specific-NextHop",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"excludedDestinations\":{\"type\":\"Array\",\"defaultValue\":[\"Internet\",\"VirtualNetworkGateway\"],\"metadata\":{\"description\":\"Array of route destinations that are to be denied\",\"displayName\":\"Excluded Destinations\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/routeTables\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"where\":{\"field\":\"Microsoft.Network/routeTables/routes[*].nextHopType\",\"in\":\"[parameters('excludedDestinations')]\"}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/routeTables/routes\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/routeTables/routes/nextHopType\",\"in\":\"[parameters('excludedDestinations')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings outside of the same subscriptions under the assigned scope.",
            "display_name": "Deny vNet peering cross subscription.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:43.6794709Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deny-VNET-Peer-Cross-Sub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"notcontains\":\"[subscription().id]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings to non-approved vNets under the assigned scope.",
            "display_name": "Deny vNet peering to non-approved vNets",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:49:30.715891Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-VNET-Peering-To-Non-Approved-VNETs",
            "parameters": "{\"allowedVnets\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}\",\"displayName\":\"Allowed vNets to peer with\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}},{\"not\":{\"exists\":false,\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\"}}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings under the assigned scope.",
            "display_name": "Deny vNet peering ",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:15.8457563Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deny-VNet-Peering",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud Security Contacts",
            "display_name": "Deploy Microsoft Defender for Cloud Security Contacts",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:43.1220378Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-ASC-SecurityContacts",
            "parameters": "{\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Azure Security Center contact details\",\"displayName\":\"Security contacts email address\"}},\"minimalSeverity\":{\"type\":\"string\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":\"High\",\"metadata\":{\"description\":\"Defines the minimal alert severity which will be sent as email notifications\",\"displayName\":\"Minimal severity\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"},\"minimalSeverity\":{\"value\":\"[parameters('minimalSeverity')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailSecurityContact\":{\"metadata\":{\"description\":\"Security contacts email address\"},\"type\":\"string\"},\"minimalSeverity\":{\"metadata\":{\"description\":\"Minimal severity level reported\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-01-01-preview\",\"name\":\"default\",\"properties\":{\"alertNotifications\":{\"minimalSeverity\":\"[parameters('minimalSeverity')]\",\"state\":\"On\"},\"emails\":\"[parameters('emailSecurityContact')]\",\"notificationsByRole\":{\"roles\":[\"Owner\"],\"state\":\"On\"}},\"type\":\"Microsoft.Security/securityContacts\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"contains\":\"[parameters('emailSecurityContact')]\",\"field\":\"Microsoft.Security/securityContacts/email\"},{\"contains\":\"[parameters('minimalSeverity')]\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications.minimalSeverity\"},{\"equals\":\"Microsoft.Security/securityContacts\",\"field\":\"type\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertsToAdmins\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a default budget on all subscriptions under the assigned scope",
            "display_name": "Deploy a default budget on all subscriptions under the assigned scope",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureUSGovernment\"],\"category\":\"Budget\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:18.2578416Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-Budget",
            "parameters": "{\"amount\":{\"type\":\"String\",\"defaultValue\":\"1000\",\"metadata\":{\"description\":\"The total amount of cost or usage to track with the budget\"}},\"budgetName\":{\"type\":\"String\",\"defaultValue\":\"budget-set-by-policy\",\"metadata\":{\"description\":\"The name for the budget to be created\"}},\"contactEmails\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"contactGroups\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.\"}},\"contactRoles\":{\"type\":\"Array\",\"defaultValue\":[\"Owner\",\"Contributor\"],\"metadata\":{\"description\":\"The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\"}},\"firstThreshold\":{\"type\":\"String\",\"defaultValue\":\"90\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"secondThreshold\":{\"type\":\"String\",\"defaultValue\":\"100\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"timeGrain\":{\"type\":\"String\",\"allowedValues\":[\"Monthly\",\"Quarterly\",\"Annually\",\"BillingMonth\",\"BillingQuarter\",\"BillingAnnual\"],\"defaultValue\":\"Monthly\",\"metadata\":{\"description\":\"The time covered by a budget. Tracking of the amount will be reset based on the time grain.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"amount\":{\"value\":\"[parameters('amount')]\"},\"budgetName\":{\"value\":\"[parameters('budgetName')]\"},\"contactEmails\":{\"value\":\"[parameters('contactEmails')]\"},\"contactGroups\":{\"value\":\"[parameters('contactGroups')]\"},\"contactRoles\":{\"value\":\"[parameters('contactRoles')]\"},\"firstThreshold\":{\"value\":\"[parameters('firstThreshold')]\"},\"secondThreshold\":{\"value\":\"[parameters('secondThreshold')]\"},\"timeGrain\":{\"value\":\"[parameters('timeGrain')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"amount\":{\"type\":\"String\"},\"budgetName\":{\"type\":\"String\"},\"contactEmails\":{\"type\":\"Array\"},\"contactGroups\":{\"type\":\"Array\"},\"contactRoles\":{\"type\":\"Array\"},\"firstThreshold\":{\"type\":\"String\"},\"secondThreshold\":{\"type\":\"String\"},\"startDate\":{\"defaultValue\":\"[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]\",\"type\":\"String\"},\"timeGrain\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[parameters('budgetName')]\",\"properties\":{\"amount\":\"[parameters('amount')]\",\"category\":\"Cost\",\"notifications\":{\"NotificationForExceededBudget1\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('firstThreshold')]\"},\"NotificationForExceededBudget2\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('secondThreshold')]\"}},\"timeGrain\":\"[parameters('timeGrain')]\",\"timePeriod\":{\"startDate\":\"[parameters('startDate')]\"}},\"type\":\"Microsoft.Consumption/budgets\"}]}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('amount')]\",\"field\":\"Microsoft.Consumption/budgets/amount\"},{\"equals\":\"[parameters('timeGrain')]\",\"field\":\"Microsoft.Consumption/budgets/timeGrain\"},{\"equals\":\"Cost\",\"field\":\"Microsoft.Consumption/budgets/category\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Consumption/budgets\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys a route table with specific user defined routes when one does not exist. The route table deployed by the policy must be manually associated to subnet(s)",
            "display_name": "Deploy a route table with specific user defined routes",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:50:04.6529797Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Custom-Route-Table",
            "parameters": "{\"disableBgpPropagation\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Disable BGP Propagation\",\"displayName\":\"DisableBgpPropagation\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRoutes\":{\"type\":\"Array\",\"metadata\":{\"description\":\"Routes that must exist in compliant route tables deployed by this policy\",\"displayName\":\"requiredRoutes\"}},\"routeTableName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the route table automatically deployed by this policy\",\"displayName\":\"routeTableName\"}},\"vnetRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Only VNets in this region will be evaluated against this policy\",\"displayName\":\"vnetRegion\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"equals\":\"[parameters('vnetRegion')]\",\"field\":\"location\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"routeTableDepl\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"location\":\"[[parameters('vnetRegion')]\",\"name\":\"[[parameters('routeTableName')]\",\"properties\":{\"copy\":\"[variables('copyLoop')]\",\"disableBgpRoutePropagation\":\"[[parameters('disableBgpPropagation')]\"},\"type\":\"Microsoft.Network/routeTables\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"copyLoop\":[{\"count\":\"[[length(parameters('requiredRoutes'))]\",\"input\":{\"name\":\"[[concat('route-',copyIndex('routes'))]\",\"properties\":{\"addressPrefix\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[0]]\",\"nextHopIpAddress\":\"[[if(equals(toLower(split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]),'virtualappliance'),split(parameters('requiredRoutes')[copyIndex('routes')], ';')[2], null())]\",\"nextHopType\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]]\"}},\"name\":\"routes\"}]}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('routeTableName')]\",\"field\":\"name\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"where\":{\"in\":\"[parameters('requiredRoutes')]\",\"value\":\"[concat(current('Microsoft.Network/routeTables/routes[*].addressPrefix'), ';', current('Microsoft.Network/routeTables/routes[*].nextHopType'), if(equals(toLower(current('Microsoft.Network/routeTables/routes[*].nextHopType')),'virtualappliance'), concat(';', current('Microsoft.Network/routeTables/routes[*].nextHopIpAddress')), ''))]\"}},\"equals\":\"[length(parameters('requiredRoutes'))]\"}]},\"roleDefinitionIds\":[\"/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/routeTables\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys an Azure DDoS Network Protection",
            "display_name": "Deploy an Azure DDoS Network Protection",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:35.118365Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deploy-DDoSProtection",
            "parameters": "{\"ddosName\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet\",\"displayName\":\"ddosName\"}},\"ddosRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet location\",\"displayName\":\"ddosRegion\",\"strongType\":\"location\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"ddosname\":{\"value\":\"[parameters('ddosname')]\"},\"ddosregion\":{\"value\":\"[parameters('ddosRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"ddosRegion\":{\"type\":\"String\"},\"ddosname\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"ddosprotection\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-12-01\",\"location\":\"[parameters('ddosRegion')]\",\"name\":\"[parameters('ddosName')]\",\"properties\":{},\"type\":\"Microsoft.Network/ddosProtectionPlans\"}]}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('ddosName')]\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/ddosProtectionPlans\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Automation to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:49:30.911279Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AA",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Automation/automationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"JobLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobStreams\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DscNodeStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Automation/automationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.",
            "display_name": "Deploy Diagnostic Settings for Container Instances to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:51.6362552Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ACI",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerInstance/containerGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.",
            "display_name": "Deploy Diagnostic Settings for Container Registry to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:04.3432819Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ACR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ContainerRegistryLoginEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ContainerRegistryRepositoryEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerRegistry/registries/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for API Management to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:28.5015887Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-APIMgmt",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logAnalyticsDestinationType\":{\"type\":\"String\",\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'\",\"displayName\":\"Log Analytics destination type\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('logAnalyticsDestinationType')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logAnalyticsDestinationType\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"[parameters('logAnalyticsDestinationType')]\",\"logs\":[{\"category\":\"GatewayLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"WebSocketConnectionLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ApiManagement/service/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any Scaling Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:37.6828831Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AVDScalingPlans",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/scalingplans\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/scalingplans/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:34.9448116Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AnalysisService",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.AnalysisServices/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Service\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.AnalysisServices/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:55.8606307Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ApiForFHIR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HealthcareApis/services/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:05.9900951Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ApplicationGateway",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ApplicationGatewayAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayPerformanceLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/applicationGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Azure Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:43:55.395974Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Bastion",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/bastionHosts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"BastionAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/bastionHosts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:04.3283398Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CDNEndpoints",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cdn/profiles/endpoints\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"CoreAnalytics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:57.0006361Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CognitiveServices",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RequestResponse\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Trace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.CognitiveServices/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:36.531083Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CosmosDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DataPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MongoRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyRUConsumption\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ControlPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CassandraRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"GremlinRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"Requests\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:01.3628266Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DLAnalytics",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:49:36.868232Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DataExplorerCluster",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Kusto/Clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"SucceededIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FailedIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IngestionBatching\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Command\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Query\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableUsageStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Kusto/Clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Data Factory to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:56.6399065Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DataFactory",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataFactory/factories\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TriggerRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessages\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutableStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessageContext\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionComponentPhases\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionDataStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISIntegrationRuntimeLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SandboxPipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SandboxActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataFactory/factories/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Databricks to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:04.2367897Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.3.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Databricks",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"dbfs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clusters\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"accounts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"jobs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"notebook\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ssh\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"workspace\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"secrets\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlPermissions\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"instancePools\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlanalytics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"genie\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"globalInitScripts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"iamRole\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"mlflowExperiment\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"featureStore\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RemoteHistoryService\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"mlflowAcledArtifact\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"databrickssql\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"deltaPipelines\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"modelRegistry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"repos\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"unityCatalog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"gitCredentials\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"webTerminal\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"serverlessRealTimeInference\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clusterLibraries\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"partnerHub\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clamAVScan\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"capsule8Dataplane\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Databricks/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:05.4482901Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridSub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/eventSubscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:38.1838016Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridSystemTopic",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/systemTopics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/systemTopics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:32:58.9657243Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridTopic",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/topics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PublishFailures\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/topics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:57:55.9783479Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ExpressRoute",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/expressRouteCircuits\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PeeringRouteLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Firewall to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:47:15.2206752Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Firewall",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logAnalyticsDestinationType\":{\"type\":\"String\",\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'\",\"displayName\":\"Log Analytics destination type\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/azureFirewalls\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('logAnalyticsDestinationType')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logAnalyticsDestinationType\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"[parameters('logAnalyticsDestinationType')]\",\"logs\":[{\"category\":\"AzureFirewallApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallDnsProxy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWThreatIntel\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWIdpsSignature\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWDnsQuery\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFqdnResolveFailure\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFatFlow\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFlowTrace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/azureFirewalls/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Front Door to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:50:04.8050814Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-FrontDoor",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/frontDoors\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FrontdoorAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FrontdoorWebApplicationFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/frontDoors/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:33:00.4433731Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Function",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FunctionAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for HDInsight to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:38.3574899Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-HDInsight",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HDInsight/clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HDInsight/clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:28.9963063Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LoadBalancer",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/loadBalancers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"LoadBalancerAlertEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"LoadBalancerProbeHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/loadBalancers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Log Analytics workspaces to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:28.1717207Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LogAnalytics",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"microsoft.operationalinsights/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"microsoft.operationalinsights/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:41.154244Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LogicAppsISE",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/integrationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"IntegrationAccountTrackingEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/integrationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for MariaDB to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:38.1651028Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MariaDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMariaDB/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:14.2893449Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MediaService",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Media/mediaServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"KeyDeliveryRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Media/mediaServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:33:00.9241806Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MlWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AmlComputeClusterEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeClusterNodeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeJobEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeCpuGpuUtilization\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlRunStatusChangedEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsActionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ComputeInstanceEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:03.9228507Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MySQL",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMySQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:11.0098563Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-NIC",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkInterfaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkInterfaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:33.4330593Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-NetworkSecurityGroups",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"NetworkSecurityGroupEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkSecurityGroupRuleCounter\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:59.9416084Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-PostgreSQL",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleServers\",\"field\":\"type\"},{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"},\"resourceType\":{\"value\":\"[field('type')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"},\"resourceType\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"condition\":\"[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/flexibleServers')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PostgreSQLLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforPostgreSQL/flexibleServers/providers/diagnosticSettings\"},{\"apiVersion\":\"2021-05-01-preview\",\"condition\":\"[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/servers')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PostgreSQLLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:10.9887095Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-PowerBIEmbedded",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.PowerBIDedicated/capacities\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:13.7357751Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-RedisCache",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cache/redis/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Relay to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:10.2127743Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Relay",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Relay/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"HybridConnectionsEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Relay/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:28.8704863Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SQLElasticPools",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/elasticPools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:33:31.7260024Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SQLMI",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ResourceUsageStats\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DevOpsOperationsAudit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/managedInstances/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SignalR to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:23.8820344Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SignalR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.SignalRService/SignalR\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AllLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.SignalRService/SignalR/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:41.0757202Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-TimeSeriesInsights",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.TimeSeriesInsights/environments\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Ingress\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:05.6947677Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-TrafficManager",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/trafficManagerProfiles\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ProbeHealthStatusEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:32.6578626Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VM",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachines/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:29.0658619Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VMSS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.",
            "display_name": "Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:08.5469633Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VNetGW",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworkGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IKEDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"P2SDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TunnelDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for VWAN S2S VPN Gateway to stream to a Log Analytics workspace when any VWAN S2S VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.",
            "display_name": "Deploy Diagnostic Settings for VWAN S2S VPN Gateway to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:01.9001818Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VWanS2SVPNGW",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/vpnGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IKEDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TunnelDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/vpnGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:16.1484247Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VirtualNetwork",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"VMProtectionAlerts\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworks/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Application group to stream to a Log Analytics workspace when any application group which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Application group to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:37:36.4293531Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDAppGroup",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/applicationGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/applicationGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Host Pools to stream to a Log Analytics workspace when any Host Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Host Pools to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:04:06.4143129Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.3.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDHostPools",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/hostpools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Connection\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"HostRegistration\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AgentHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkData\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SessionHostManagement\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ConnectionGraphicsData\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/hostpools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:01:02.0193357Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Feed\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:31.2403762Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WebServerFarm",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Web/serverfarms\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/serverfarms/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for App Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:33:01.7077333Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.2.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Website",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"notContains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"},\"serverFarmId\":{\"value\":\"[field('Microsoft.Web/sites/serverFarmId')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for diagnostic logs for ', ': ', parameters('resourceName'))]\"}},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"},\"serverFarmId\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":\"[if(startsWith(reference(parameters('serverFarmId'), '2021-03-01', 'Full').sku.tier, 'Premium'), variables('logs').premiumTierLogs, variables('logs').otherTierLogs)]\",\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{\"logs\":{\"otherTierLogs\":[{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceConsoleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceIPSecAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServicePlatformLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"premiumTierLogs\":[{\"category\":\"AppServiceAntivirusScanAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceConsoleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceFileAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceIPSecAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServicePlatformLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}]}}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:33:01.1224967Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-iotHub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Devices/IotHubs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Connections\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceTelemetry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DCommands\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceIdentityOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FileUploadOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Routes\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"D2CTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TwinQueries\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobsOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DirectMethods\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DistributedTracing\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Configurations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceStreams\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Devices/IotHubs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys Azure Firewall Manager policy in subscription where the policy is assigned.",
            "display_name": "Deploy Azure Firewall Manager policy in the subscription",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:56:37.6055616Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deploy-FirewallPolicy",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"fwPolicyRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for Azure Firewall Policy\",\"displayName\":\"fwPolicyRegion\",\"strongType\":\"location\"}},\"fwpolicy\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Object describing Azure Firewall Policy\",\"displayName\":\"fwpolicy\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"fwPolicy\":{\"value\":\"[parameters('fwPolicy')]\"},\"fwPolicyRegion\":{\"value\":\"[parameters('fwPolicyRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"fwPolicy\":{\"type\":\"object\"},\"fwPolicyRegion\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"fwpolicies\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[],\"location\":\"[parameters('fwpolicy').location]\",\"name\":\"[parameters('fwpolicy').firewallPolicyName]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[\"[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]\"],\"name\":\"[parameters('fwpolicy').ruleGroups.name]\",\"properties\":{\"priority\":\"[parameters('fwpolicy').ruleGroups.properties.priority]\",\"rules\":\"[parameters('fwpolicy').ruleGroups.properties.rules]\"},\"type\":\"ruleGroups\"}],\"tags\":{},\"type\":\"Microsoft.Network/firewallPolicies\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/firewallPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Database for MySQL server deploy a specific min TLS version and enforce SSL.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:02:35.4384367Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-MySQL-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for MySQL server\",\"displayName\":\"Effect minimum TLS version Azure Database for MySQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforMySQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforMySQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs",
          "schema_version": 0,
          "attributes": {
            "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to a storageaccountid with a specified retention period.",
            "display_name": "[Deprecated] Deploys NSG flow logs and traffic analytics",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:58:26.9778466Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deploy-Nsg-FlowLogs",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"flowAnalyticsEnabled\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"displayName\":\"Enable Traffic Analytics\"}},\"logAnalytics\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"retention\":{\"type\":\"Integer\",\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"}},\"storageAccountResourceId\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"Storage Account Resource Id\",\"strongType\":\"Microsoft.Storage/storageAccounts\"}},\"trafficAnalyticsInterval\":{\"type\":\"Integer\",\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"flowAnalyticsEnabled\":{\"value\":\"[parameters('flowAnalyticsEnabled')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"networkSecurityGroupName\":{\"value\":\"[field('name')]\"},\"resourceGroupName\":{\"value\":\"[resourceGroup().name]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"storageAccountResourceId\":{\"value\":\"[parameters('storageAccountResourceId')]\"},\"trafficAnalyticsInterval\":{\"value\":\"[parameters('trafficAnalyticsInterval')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"flowAnalyticsEnabled\":{\"type\":\"bool\"},\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"networkSecurityGroupName\":{\"type\":\"String\"},\"resourceGroupName\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"storageAccountResourceId\":{\"type\":\"String\"},\"trafficAnalyticsInterval\":{\"type\":\"int\"}},\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[take(concat('NetworkWatcher_', toLower(parameters('location')),  '/', parameters('networkSecurityGroupName'), '-', parameters('resourceGroupName'), '-flowlog' ), 80)]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":\"[bool(parameters('flowAnalyticsEnabled'))]\",\"trafficAnalyticsInterval\":\"[parameters('trafficAnalyticsInterval')]\",\"workspaceId\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').properties.customerId, json('null')) ]\",\"workspaceRegion\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]\",\"workspaceResourceId\":\"[if(not(empty(parameters('logAnalytics'))), parameters('logAnalytics'), json('null'))]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[parameters('storageAccountResourceId')]\",\"targetResourceId\":\"[resourceId(parameters('resourceGroupName'), 'Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroupName'))]\"},\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"},{\"equals\":\"[parameters('flowAnalyticsEnabled')]\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled\"}]},\"resourceGroupName\":\"NetworkWatcherRG\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
          "schema_version": 0,
          "attributes": {
            "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to Log Analytics with a specfied retention period.",
            "display_name": "[Deprecated] Deploys NSG flow logs and traffic analytics to Log Analytics",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:36:05.0752742Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0-deprecated\"}",
            "mode": "Indexed",
            "name": "Deploy-Nsg-FlowLogs-to-LA",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"interval\":{\"type\":\"Integer\",\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}},\"retention\":{\"type\":\"Integer\",\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"}},\"workspace\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"interval\":{\"value\":\"[parameters('interval')]\"},\"location\":{\"value\":\"[field('location')]\"},\"networkSecurityGroup\":{\"value\":\"[field('id')]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"workspace\":{\"value\":\"[parameters('workspace')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"interval\":{\"type\":\"int\"},\"location\":{\"type\":\"String\"},\"networkSecurityGroup\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"time\":{\"defaultValue\":\"[utcNow()]\",\"type\":\"String\"},\"workspace\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2019-06-01\",\"kind\":\"StorageV2\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('storageAccountName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard_LRS\",\"tier\":\"Standard\"},\"type\":\"Microsoft.Storage/storageAccounts\"}]}},\"resourceGroup\":\"[variables('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\"],\"name\":\"[concat('NetworkWatcherRG', '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('NetworkWatcher_', toLower(parameters('location')))]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-11-01\",\"dependsOn\":[\"[concat('NetworkWatcher_', toLower(parameters('location')))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('securityGroupName'), '-Network-flowlog')]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":true,\"trafficAnalyticsInterval\":\"[parameters('interval')]\",\"workspaceResourceId\":\"[parameters('workspace')]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[concat(subscription().id, '/resourceGroups/', variables('resourceGroupName'), '/providers/Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]\",\"targetResourceId\":\"[parameters('networkSecurityGroup')]\"},\"type\":\"flowLogs\"}],\"type\":\"Microsoft.Network/networkWatchers\"}]}},\"resourceGroup\":\"NetworkWatcherRG\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"resourceGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[4]]\",\"securityGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[8]]\",\"storageAccountName\":\"[concat('es', uniqueString(variables('securityGroupName'), parameters('time')))]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\"resourceGroupName\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12\",\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/networkWatchers/flowlogs\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12",
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab",
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Database for PostgreSQL server deploy a specific min TLS version requirement and enforce SSL ",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:38:09.0498563Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-PostgreSQL-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for PostgreSQL server\",\"displayName\":\"Effect Azure Database for PostgreSQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Database for PostgreSQL server to enforce\",\"displayName\":\"Select version for PostgreSQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notEquals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforPostgreSQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "SQL servers deploys a specific min TLS version requirement.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:53:36.6714872Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-SQL-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
            "display_name": "Deploy SQL database auditing settings",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:09.7727705Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-AuditingSettings",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"auditActionsAndGroups\":[\"BATCH_COMPLETED_GROUP\",\"DATABASE_OBJECT_CHANGE_GROUP\",\"SCHEMA_OBJECT_CHANGE_GROUP\",\"BACKUP_RESTORE_GROUP\",\"APPLICATION_ROLE_CHANGE_PASSWORD_GROUP\",\"DATABASE_PRINCIPAL_CHANGE_GROUP\",\"DATABASE_PRINCIPAL_IMPERSONATION_GROUP\",\"DATABASE_ROLE_MEMBER_CHANGE_GROUP\",\"USER_CHANGE_PASSWORD_GROUP\",\"DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP\",\"DATABASE_OBJECT_PERMISSION_CHANGE_GROUP\",\"DATABASE_PERMISSION_CHANGE_GROUP\",\"SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP\",\"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\",\"FAILED_DATABASE_AUTHENTICATION_GROUP\"],\"isAzureMonitorTargetEnabled\":true,\"state\":\"enabled\"},\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/state\"},{\"equals\":\"true\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled\"}]},\"name\":\"default\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
            "display_name": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:39:10.6189491Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-SecurityAlertPolicies",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"emailAddresses\":{\"type\":\"Array\",\"defaultValue\":[\"admin@contoso.com\",\"admin@fabrikam.com\"]}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"emailAddresses\":{\"value\":\"[parameters('emailAddresses')]\"},\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailAddresses\":{\"type\":\"Array\"},\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-06-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"disabledAlerts\":[\"\"],\"emailAccountAdmins\":true,\"emailAddresses\":\"[parameters('emailAddresses')]\",\"retentionDays\":0,\"state\":\"Enabled\",\"storageAccountAccessKey\":\"\",\"storageEndpoint\":null},\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/servers/databases/securityAlertPolicies/state\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment. Please use this policy instead https://www.azadvertizer.net/azpolicyadvertizer/86a912f6-9a06-4e26-b447-11b16ba8659f.html",
            "display_name": "[Deprecated] Deploy SQL Database Transparent Data Encryption",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:59:29.4642311Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.1-deprecated\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-Tde",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedDatabases\":{\"type\":\"Array\",\"defaultValue\":[\"master\",\"model\",\"tempdb\",\"msdb\",\"resource\"],\"metadata\":{\"description\":\"Array of databases that are excluded from this policy\",\"displayName\":\"Excluded Databases\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedDatabases')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2014-04-01\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]\",\"properties\":{\"status\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/transparentDataEncryption.status\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/Deploy-Sql-vulnerabilityAssessments_20230706.html",
            "display_name": "[Deprecated]: Deploy SQL Database vulnerability Assessments",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:03:05.1977457Z\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"Deploy-Sql-vulnerabilityAssessments_20230706\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1-deprecated\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-vulnerabilityAssessments",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'\",\"displayName\":\"The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\"},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"recurringScans\":{\"emailSubscriptionAdmins\":false,\"emails\":[\"[parameters('vulnerabilityAssessmentsEmail')]\"],\"isEnabled\":true},\"storageAccountAccessKey\":\"[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\"storageContainerPath\":\"[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\"},\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails\"},{\"equals\":true,\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"],\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
              "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy SQL Database Vulnerability Assessments when it does not exist in the deployment, and save results to the storage account specified in the parameters.",
            "display_name": "Deploy SQL Database Vulnerability Assessments",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:35:04.0603815Z\",\"replacesPolicy\":\"Deploy-Sql-vulnerabilityAssessments\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-vulnerabilityAssessments_20230706",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The email address(es) to send alerts.\",\"displayName\":\"The email address(es) to send alerts.\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"type\":\"Array\"},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"recurringScans\":{\"emailSubscriptionAdmins\":false,\"emails\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"isEnabled\":true},\"storageAccountAccessKey\":\"[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\"storageContainerPath\":\"[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\"},\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"count\":{\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*]\",\"where\":{\"notIn\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"value\":\"current(Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*])\"}},\"greater\":0},{\"equals\":true,\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"],\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
              "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL managed instances. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "SQL managed instances deploy a specific min TLS version requirement.",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:41.9130551Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-SqlMi-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-02-02-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/managedInstances\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/managedInstances\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Storage. Enables secure server to client by enforce minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your Azure Storage.",
            "display_name": "Azure Storage deploy a specific min TLS version requirement and enforce SSL/HTTPS ",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:34:31.4293114Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Storage-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure STorage\",\"displayName\":\"Effect Azure Storage\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure STorage to enforce\",\"displayName\":\"Select TLS version for Azure Storage server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\"notEquals\":\"true\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notEquals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('minimumTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimumTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimumTlsVersion\":\"[parameters('minimumTlsVersion')]\",\"supportsHttpsTrafficOnly\":true},\"type\":\"Microsoft.Storage/storageAccounts\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"equals\":\"[parameters('minimumTlsVersion')]\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Storage/storageAccounts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
          "schema_version": 0,
          "attributes": {
            "description": "This policy deploys virtual network and peer to the hub",
            "display_name": "Deploy Virtual Network with peering to the hub",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:15.6634194Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-VNET-HubSpoke",
            "parameters": "{\"dnsServers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Default domain servers for the vNET.\",\"displayName\":\"DNSServers\"}},\"hubResourceId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Resource ID for the HUB vNet\",\"displayName\":\"hubResourceId\"}},\"vNetCidrRange\":{\"type\":\"String\",\"metadata\":{\"description\":\"CIDR Range for the vNet\",\"displayName\":\"vNetCidrRange\"}},\"vNetLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"Location for the vNet\",\"displayName\":\"vNetLocation\"}},\"vNetName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet\",\"displayName\":\"vNetName\"}},\"vNetPeerUseRemoteGateway\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Enable gateway transit for the LZ network\",\"displayName\":\"vNetPeerUseRemoteGateway\"}},\"vNetRgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet RG\",\"displayName\":\"vNetRgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('vNetRgName')]\",\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"dnsServers\":{\"value\":\"[parameters('dnsServers')]\"},\"hubResourceId\":{\"value\":\"[parameters('hubResourceId')]\"},\"vNetCidrRange\":{\"value\":\"[parameters('vNetCidrRange')]\"},\"vNetLocation\":{\"value\":\"[parameters('vNetLocation')]\"},\"vNetName\":{\"value\":\"[parameters('vNetName')]\"},\"vNetPeerUseRemoteGateway\":{\"value\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"vNetRgName\":{\"value\":\"[parameters('vNetRgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"dnsServers\":{\"defaultValue\":[],\"type\":\"Array\"},\"hubResourceId\":{\"type\":\"String\"},\"vNetCidrRange\":{\"type\":\"String\"},\"vNetLocation\":{\"type\":\"String\"},\"vNetName\":{\"type\":\"String\"},\"vNetPeerUseRemoteGateway\":{\"defaultValue\":false,\"type\":\"bool\"},\"vNetRgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetRgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"}],\"variables\":{}}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\"],\"name\":\"[concat('alz-vnet-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetName')]\",\"properties\":{\"addressSpace\":{\"addressPrefixes\":[\"[parameters('vNetCidrRange')]\"]},\"dhcpOptions\":{\"dnsServers\":\"[parameters('dnsServers')]\"}},\"type\":\"Microsoft.Network/virtualNetworks\"},{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat(parameters('vNetName'), '/peerToHub')]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":false,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[parameters('hubResourceId')]\"},\"useRemoteGateways\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat('alz-hub-peering-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"hubName\":{\"value\":\"[split(parameters('hubResourceId'),'/')[8]]\"},\"remoteVirtualNetwork\":{\"value\":\"[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"hubName\":{\"defaultValue\":false,\"type\":\"String\"},\"remoteVirtualNetwork\":{\"defaultValue\":false,\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"name\":\"[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":true,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[[parameters('remoteVirtualNetwork')]\"},\"useRemoteGateways\":false},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"}],\"variables\":{}}},\"resourceGroup\":\"[split(parameters('hubResourceId'),'/')[4]]\",\"subscriptionId\":\"[split(parameters('hubResourceId'),'/')[2]]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('vNetRgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"field\":\"name\",\"like\":\"[parameters('vNetName')]\"},{\"equals\":\"[parameters('vNetLocation')]\",\"field\":\"location\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('vNetName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/virtualNetworks\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys an auto shutdown schedule to a virtual machine",
            "display_name": "Deploy Virtual Machine Auto Shutdown Schedule",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Compute\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:42:14.2183582Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Vm-autoShutdown",
            "parameters": "{\"EnableNotification\":{\"type\":\"string\",\"allowedValues\":[\"Disabled\",\"Enabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"If notifications are enabled for this schedule (i.e. Enabled, Disabled).\",\"displayName\":\"Send Notification before auto-shutdown\"}},\"NotificationEmailRecipient\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Email address to be used for notification\",\"displayName\":\"Email Address\"}},\"NotificationWebhookUrl\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen.\",\"displayName\":\"Webhook URL\"}},\"time\":{\"type\":\"String\",\"defaultValue\":\"0000\",\"metadata\":{\"description\":\"Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM\",\"displayName\":\"Scheduled Shutdown Time\"}},\"timeZoneId\":{\"type\":\"string\",\"defaultValue\":\"UTC\",\"metadata\":{\"description\":\"The time zone ID (e.g. Pacific Standard time).\",\"displayName\":\"Time zone\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"EnableNotification\":{\"value\":\"[parameters('EnableNotification')]\"},\"NotificationEmailRecipient\":{\"value\":\"[parameters('NotificationEmailRecipient')]\"},\"NotificationWebhookUrl\":{\"value\":\"[parameters('NotificationWebhookUrl')]\"},\"location\":{\"value\":\"[field('location')]\"},\"time\":{\"value\":\"[parameters('time')]\"},\"timeZoneId\":{\"value\":\"[parameters('timeZoneId')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"EnableNotification\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"If notifications are enabled for this schedule (i.e. Enabled, Disabled).\"},\"type\":\"string\"},\"NotificationEmailRecipient\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Email address to be used for notification\"},\"type\":\"string\"},\"NotificationWebhookUrl\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen.\"},\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"time\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM\"},\"type\":\"string\"},\"timeZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The time zone ID (e.g. Pacific Standard time).\"},\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-09-15\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('shutdown-computevm-',parameters('vmName'))]\",\"properties\":{\"dailyRecurrence\":{\"time\":\"[parameters('time')]\"},\"notificationSettings\":{\"emailRecipient\":\"[parameters('NotificationEmailRecipient')]\",\"notificationLocale\":\"en\",\"status\":\"[parameters('EnableNotification')]\",\"timeInMinutes\":30,\"webhookUrl\":\"[parameters('NotificationWebhookUrl')]\"},\"status\":\"Enabled\",\"targetResourceId\":\"[resourceId('Microsoft.Compute/virtualMachines', parameters('vmName'))]\",\"taskType\":\"ComputeVmShutdownTask\",\"timeZoneId\":\"[parameters('timeZoneId')]\"},\"type\":\"Microsoft.DevTestLab/schedules\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"ComputeVmShutdownTask\",\"field\":\"Microsoft.DevTestLab/schedules/taskType\"},{\"equals\":\"[concat(resourceGroup().id,'/providers/Microsoft.Compute/virtualMachines/',field('name'))]\",\"field\":\"Microsoft.DevTestLab/schedules/targetResourceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.DevTestLab/schedules\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine",
            "display_name": "Deploy Windows Domain Join Extension with keyvault configuration",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Guest Configuration\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T09:40:43.5048707Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Windows-DomainJoin",
            "parameters": "{\"domainFQDN\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainFQDN\"}},\"domainOUPath\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainOUPath\"}},\"domainPassword\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainPassword\"}},\"domainUsername\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainUsername\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"keyVaultResourceId\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"keyVaultResourceId\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2008-R2-SP1-zhcn\",\"2012-Datacenter\",\"2012-datacenter-gensecond\",\"2012-Datacenter-smalldisk\",\"2012-datacenter-smalldisk-g2\",\"2012-Datacenter-zhcn\",\"2012-datacenter-zhcn-g2\",\"2012-R2-Datacenter\",\"2012-r2-datacenter-gensecond\",\"2012-R2-Datacenter-smalldisk\",\"2012-r2-datacenter-smalldisk-g2\",\"2012-R2-Datacenter-zhcn\",\"2012-r2-datacenter-zhcn-g2\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-datacenter-gs\",\"2016-Datacenter-Server-Core\",\"2016-datacenter-server-core-g2\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-datacenter-server-core-smalldisk-g2\",\"2016-Datacenter-smalldisk\",\"2016-datacenter-smalldisk-g2\",\"2016-Datacenter-with-Containers\",\"2016-datacenter-with-containers-g2\",\"2016-Datacenter-with-RDSH\",\"2016-Datacenter-zhcn\",\"2016-datacenter-zhcn-g2\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-datacenter-core-g2\",\"2019-Datacenter-Core-smalldisk\",\"2019-datacenter-core-smalldisk-g2\",\"2019-Datacenter-Core-with-Containers\",\"2019-datacenter-core-with-containers-g2\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-datacenter-core-with-containers-smalldisk-g2\",\"2019-datacenter-gensecond\",\"2019-datacenter-gs\",\"2019-Datacenter-smalldisk\",\"2019-datacenter-smalldisk-g2\",\"2019-Datacenter-with-Containers\",\"2019-datacenter-with-containers-g2\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-datacenter-with-containers-smalldisk-g2\",\"2019-Datacenter-zhcn\",\"2019-datacenter-zhcn-g2\",\"Datacenter-Core-1803-with-Containers-smalldisk\",\"datacenter-core-1803-with-containers-smalldisk-g2\",\"Datacenter-Core-1809-with-Containers-smalldisk\",\"datacenter-core-1809-with-containers-smalldisk-g2\",\"Datacenter-Core-1903-with-Containers-smalldisk\",\"datacenter-core-1903-with-containers-smalldisk-g2\",\"datacenter-core-1909-with-containers-smalldisk\",\"datacenter-core-1909-with-containers-smalldisk-g1\",\"datacenter-core-1909-with-containers-smalldisk-g2\"]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"domainFQDN\":{\"value\":\"[parameters('domainFQDN')]\"},\"domainOUPath\":{\"value\":\"[parameters('domainOUPath')]\"},\"domainPassword\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainPassword')]\"}},\"domainUsername\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainUsername')]\"}},\"keyVaultResourceId\":{\"value\":\"[parameters('keyVaultResourceId')]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"domainFQDN\":{\"type\":\"String\"},\"domainOUPath\":{\"type\":\"String\"},\"domainPassword\":{\"type\":\"securestring\"},\"domainUsername\":{\"type\":\"String\"},\"keyVaultResourceId\":{\"type\":\"String\"},\"location\":{\"type\":\"String\"},\"vmName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2015-06-15\",\"location\":\"[resourceGroup().location]\",\"name\":\"[concat(variables('vmName'),'/joindomain')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"Password\":\"[parameters('domainPassword')]\"},\"publisher\":\"Microsoft.Compute\",\"settings\":{\"Name\":\"[parameters('domainFQDN')]\",\"OUPath\":\"[parameters('domainOUPath')]\",\"Options\":\"[variables('domainJoinOptions')]\",\"Restart\":\"true\",\"User\":\"[parameters('domainUserName')]\"},\"type\":\"JsonADDomainExtension\",\"typeHandlerVersion\":\"1.3\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"domainJoinOptions\":3,\"vmName\":\"[parameters('vmName')]\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"JsonADDomainExtension\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Compute\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_policy_set_definition",
      "name": "enterprise_scale",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization",
          "schema_version": 0,
          "attributes": {
            "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Azure Policy Initiative as a cost control tool to reveal orphaned resources that are contributing cost.",
            "display_name": "Unused resources driving cost should be avoided",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.512899Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "name": "Audit-UnusedResourcesCostOptimization",
            "parameters": "{\"effectDisks\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy for Microsoft.Compute/disks\",\"displayName\":\"Disks Effect\"}},\"effectPublicIpAddresses\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy for Microsoft.Network/publicIpAddresses\",\"displayName\":\"PublicIpAddresses Effect\"}},\"effectServerFarms\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy for Microsoft.Web/serverfarms\",\"displayName\":\"ServerFarms Effect\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectDisks')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
                "policy_group_names": null,
                "reference_id": "AuditDisksUnusedResourcesCostOptimization"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectPublicIpAddresses')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
                "policy_group_names": null,
                "reference_id": "AuditPublicIpAddressesUnusedResourcesCostOptimization"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectServerFarms')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
                "policy_group_names": null,
                "reference_id": "AuditServerFarmsUnusedResourcesCostOptimization"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"Audit\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
                "policy_group_names": null,
                "reference_id": "AuditAzureHybridBenefitUnusedResourcesCostOptimization"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
            "display_name": "Public network access should be disabled for PaaS services",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:07:42.6028995Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"3.1.0\"}",
            "name": "Deny-PublicPaaSEndpoints",
            "parameters": "{\"ACRPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure Container Registires with exposed public endpoints \",\"displayName\":\"Public network access on Azure Container Registry disabled\"}},\"AFSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure File Sync instances with exposed public endpoints \",\"displayName\":\"Public network access on Azure File Sync disabled\"}},\"AKSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies  the creation of  Azure Kubernetes Service non-private clusters\",\"displayName\":\"Public network access on AKS API should be disabled\"}},\"ApiManPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"This policy denies creation of API Management services with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for API Management services\"}},\"AppConfigPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of App Configuration with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for App Configuration\"}},\"AsPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of App Service apps with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for App Service apps\"}},\"AsePublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of App Service Environment apps with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for App Service Environment apps\"}},\"AutomationPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Automation accounts with exposed public endpoints. Bots should be seet to 'isolated only' mode\",\"displayName\":\"Public network access should be disabled for Automation accounts\"}},\"BatchPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Batch Instances with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Batch Instances\"}},\"BotServicePublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Bot Service with exposed public endpoints. Bots should be seet to 'isolated only' mode\",\"displayName\":\"Public network access should be disabled for Bot Service\"}},\"CosmosPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies that  Cosmos database accounts  are created with out public network access is disabled.\",\"displayName\":\"Public network access should be disabled for CosmosDB\"}},\"FunctionPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Function apps with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Function apps\"}},\"KeyVaultPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access should be disabled for KeyVault\"}},\"MariaDbPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure MariaDB with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure MariaDB\"}},\"MlPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Machine Learning with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Machine Learning\"}},\"MySQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of MySql Flexible Server DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for MySQL Flexible Server\"}},\"PostgreSQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Postgre SQL Flexible DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for PostgreSql Flexible Server\"}},\"RedisCachePublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Cache for Redis with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Cache for Redis\"}},\"SqlServerPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Sql servers with exposed public endpoints\",\"displayName\":\"Public network access on Azure SQL Database should be disabled\"}},\"StoragePublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access onStorage accounts should be disabled\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                "policy_group_names": null,
                "reference_id": "CosmosDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
                "policy_group_names": null,
                "reference_id": "KeyVaultDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                "policy_group_names": null,
                "reference_id": "SqlServerDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StoragePublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
                "policy_group_names": null,
                "reference_id": "StorageDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                "policy_group_names": null,
                "reference_id": "AKSDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                "policy_group_names": null,
                "reference_id": "ACRDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AFSPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                "policy_group_names": null,
                "reference_id": "AFSDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLFlexPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
                "policy_group_names": null,
                "reference_id": "PostgreSQLFlexDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLFlexPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
                "policy_group_names": null,
                "reference_id": "MySQLFlexDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                "policy_group_names": null,
                "reference_id": "BatchDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MariaDbPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
                "policy_group_names": null,
                "reference_id": "MariaDbDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MlPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
                "policy_group_names": null,
                "reference_id": "MlDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisCachePublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
                "policy_group_names": null,
                "reference_id": "RedisCacheDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BotServicePublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e8168db-69e3-4beb-9822-57cb59202a9d",
                "policy_group_names": null,
                "reference_id": "BotServiceDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
                "policy_group_names": null,
                "reference_id": "AutomationDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppConfigPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3d9f5e4c-9947-4579-9539-2a7695fbc187",
                "policy_group_names": null,
                "reference_id": "AppConfigDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/969ac98b-88a8-449f-883c-2e9adb123127",
                "policy_group_names": null,
                "reference_id": "FunctionDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AsePublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
                "policy_group_names": null,
                "reference_id": "AseDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AsPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
                "policy_group_names": null,
                "reference_id": "AsDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ApiManPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
                "policy_group_names": null,
                "reference_id": "ApiManDenyPublicIP"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. See the list of policies of the services that are included ",
            "display_name": "Deploy Diagnostic Settings to Azure Services",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Monitoring\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.7886049Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.2.0\"}",
            "name": "Deploy-Diagnostics-LogAnalytics",
            "parameters": "{\"ACILogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Instances to Log Analytics workspace\"}},\"ACRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Registry to Log Analytics workspace\"}},\"AKSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace\"}},\"APIMgmtLogAnalyticsDestinationType\":{\"type\":\"String\",\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Destination table for the diagnostic setting for API Management to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'\",\"displayName\":\"Destination table for the Diagnostic Setting for API Management to Log Analytics workspace\"}},\"APIMgmtLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for API Management to Log Analytics workspace\"}},\"APIforFHIRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace\"}},\"AVDScalingPlansLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace\"}},\"AnalysisServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace\"}},\"AppServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace\"}},\"AppServiceWebappLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service to Log Analytics workspace\"}},\"ApplicationGatewayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace\"}},\"AutomationLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Automation to Log Analytics workspace\"}},\"BastionLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace\"}},\"BatchLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Batch to Log Analytics workspace\"}},\"CDNEndpointsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace\"}},\"CognitiveServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace\"}},\"CosmosLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace\"}},\"DataExplorerClusterLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace\"}},\"DataFactoryLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Factory to Log Analytics workspace\"}},\"DataLakeAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace\"}},\"DataLakeStoreLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace\"}},\"DatabricksLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Databricks to Log Analytics workspace\"}},\"EventGridSubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace\"}},\"EventGridTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace\"}},\"EventHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace\"}},\"EventSystemTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace\"}},\"ExpressRouteLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace\"}},\"FirewallLogAnalyticsDestinationType\":{\"type\":\"String\",\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Destination table for the diagnostic setting for Firewall to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'\",\"displayName\":\"Destination table for the Diagnostic Setting for Firewall to Log Analytics workspace\"}},\"FirewallLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Firewall to Log Analytics workspace\"}},\"FrontDoorLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Front Door to Log Analytics workspace\"}},\"FunctionAppLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace\"}},\"HDInsightLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for HDInsight to Log Analytics workspace\"}},\"IotHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace\"}},\"KeyVaultLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Key Vault to Log Analytics workspace\"}},\"LoadBalancerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace\"}},\"LogAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Log Analytics to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category Audit enabled\",\"displayName\":\"Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace\"}},\"LogicAppsISELogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace\"}},\"LogicAppsWFLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps Workflows to stream to a Log Analytics workspace when any Logic Apps Workflows which are missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps Workflows to Log Analytics workspace\"}},\"MariaDBLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for MariaDB to Log Analytics workspace\"}},\"MediaServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace\"}},\"MlWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace\"}},\"MySQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace\"}},\"NetworkNICLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace\"}},\"NetworkPublicIPNicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace\"}},\"NetworkSecurityGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace\"}},\"PostgreSQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace\"}},\"PowerBIEmbeddedLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace\"}},\"RedisCacheLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace\"}},\"RelayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Relay to Log Analytics workspace\"}},\"SQLDBsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace\"}},\"SQLElasticPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace\"}},\"SQLMLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace\"}},\"SearchServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Search Services to Log Analytics workspace\"}},\"ServiceBusLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace\"}},\"SignalRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SignalR to Log Analytics workspace\"}},\"StorageAccountsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Storage Accounts to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Storage Accounts to Log Analytics workspace\"}},\"StreamAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\"}},\"TimeSeriesInsightsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace\"}},\"TrafficManagerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace\"}},\"VMSSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace\"}},\"VNetGWLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace\"}},\"VWanS2SVPNGWLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for VWAN S2S VPN gateway to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for VWAN S2S VPN gateway to Log Analytics workspace\"}},\"VirtualMachinesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace\"}},\"VirtualNetworkLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace\"}},\"WVDAppGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Application groups to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Application Groups to Log Analytics workspace\"}},\"WVDHostPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Host pools to stream to a Log Analytics workspace when any host pool which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Host pools to Log Analytics workspace\"}},\"WVDWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
                "policy_group_names": null,
                "reference_id": "StorageAccountDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
                "policy_group_names": null,
                "reference_id": "StorageAccountBlobServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
                "policy_group_names": null,
                "reference_id": "StorageAccountFileServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
                "policy_group_names": null,
                "reference_id": "StorageAccountQueueServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
                "policy_group_names": null,
                "reference_id": "StorageAccountTableServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AVDScalingPlansLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
                "policy_group_names": null,
                "reference_id": "AVDScalingPlansDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDAppGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
                "policy_group_names": null,
                "reference_id": "WVDAppGroupDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
                "policy_group_names": null,
                "reference_id": "WVDWorkspaceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDHostPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
                "policy_group_names": null,
                "reference_id": "WVDHostPoolsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACILogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
                "policy_group_names": null,
                "reference_id": "ACIDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
                "policy_group_names": null,
                "reference_id": "ACRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('AKSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
                "policy_group_names": null,
                "reference_id": "AKSDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AnalysisServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
                "policy_group_names": null,
                "reference_id": "AnalysisServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIforFHIRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
                "policy_group_names": null,
                "reference_id": "APIforFHIRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIMgmtLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('APIMgmtLogAnalyticsDestinationType')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
                "policy_group_names": null,
                "reference_id": "APIMgmtDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ApplicationGatewayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
                "policy_group_names": null,
                "reference_id": "ApplicationGatewayDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
                "policy_group_names": null,
                "reference_id": "AutomationDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BastionLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
                "policy_group_names": null,
                "reference_id": "BastionDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
                "policy_group_names": null,
                "reference_id": "BatchDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CDNEndpointsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
                "policy_group_names": null,
                "reference_id": "CDNEndpointsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
                "policy_group_names": null,
                "reference_id": "CognitiveServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
                "policy_group_names": null,
                "reference_id": "CosmosDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DatabricksLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
                "policy_group_names": null,
                "reference_id": "DatabricksDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataExplorerClusterLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
                "policy_group_names": null,
                "reference_id": "DataExplorerClusterDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataFactoryLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
                "policy_group_names": null,
                "reference_id": "DataFactoryDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeStoreLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
                "policy_group_names": null,
                "reference_id": "DataLakeStoreDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
                "policy_group_names": null,
                "reference_id": "DataLakeAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridSubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
                "policy_group_names": null,
                "reference_id": "EventGridSubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
                "policy_group_names": null,
                "reference_id": "EventGridTopicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
                "policy_group_names": null,
                "reference_id": "EventHubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventSystemTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
                "policy_group_names": null,
                "reference_id": "EventSystemTopicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ExpressRouteLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
                "policy_group_names": null,
                "reference_id": "ExpressRouteDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FirewallLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('FirewallLogAnalyticsDestinationType')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
                "policy_group_names": null,
                "reference_id": "FirewallDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FrontDoorLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
                "policy_group_names": null,
                "reference_id": "FrontDoorDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionAppLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
                "policy_group_names": null,
                "reference_id": "FunctionAppDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('HDInsightLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
                "policy_group_names": null,
                "reference_id": "HDInsightDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('IotHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
                "policy_group_names": null,
                "reference_id": "IotHubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
                "policy_group_names": null,
                "reference_id": "KeyVaultDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LoadBalancerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
                "policy_group_names": null,
                "reference_id": "LoadBalancerDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
                "policy_group_names": null,
                "reference_id": "LogAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsISELogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
                "policy_group_names": null,
                "reference_id": "LogicAppsISEDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsWFLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
                "policy_group_names": null,
                "reference_id": "LogicAppsWFDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MariaDBLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
                "policy_group_names": null,
                "reference_id": "MariaDBDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MediaServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
                "policy_group_names": null,
                "reference_id": "MediaServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MlWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
                "policy_group_names": null,
                "reference_id": "MlWorkspaceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
                "policy_group_names": null,
                "reference_id": "MySQLDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkSecurityGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
                "policy_group_names": null,
                "reference_id": "NetworkSecurityGroupsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkNICLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
                "policy_group_names": null,
                "reference_id": "NetworkNICDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
                "policy_group_names": null,
                "reference_id": "PostgreSQLDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PowerBIEmbeddedLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
                "policy_group_names": null,
                "reference_id": "PowerBIEmbeddedDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkPublicIPNicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"True\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
                "policy_group_names": null,
                "reference_id": "NetworkPublicIPNicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
                "policy_group_names": null,
                "reference_id": "RecoveryVaultDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisCacheLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
                "policy_group_names": null,
                "reference_id": "RedisCacheDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RelayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
                "policy_group_names": null,
                "reference_id": "RelayDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SearchServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
                "policy_group_names": null,
                "reference_id": "SearchServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ServiceBusLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
                "policy_group_names": null,
                "reference_id": "ServiceBusDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SignalRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
                "policy_group_names": null,
                "reference_id": "SignalRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('SQLDBsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
                "policy_group_names": null,
                "reference_id": "SQLDatabaseDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLElasticPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
                "policy_group_names": null,
                "reference_id": "SQLElasticPoolsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLMLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
                "policy_group_names": null,
                "reference_id": "SQLMDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
                "policy_group_names": null,
                "reference_id": "StreamAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('TimeSeriesInsightsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
                "policy_group_names": null,
                "reference_id": "TimeSeriesInsightsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('TrafficManagerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
                "policy_group_names": null,
                "reference_id": "TrafficManagerDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualNetworkLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
                "policy_group_names": null,
                "reference_id": "VirtualNetworkDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualMachinesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
                "policy_group_names": null,
                "reference_id": "VirtualMachinesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VMSSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
                "policy_group_names": null,
                "reference_id": "VMSSDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VNetGWLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
                "policy_group_names": null,
                "reference_id": "VNetGWDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
                "policy_group_names": null,
                "reference_id": "AppServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceWebappLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
                "policy_group_names": null,
                "reference_id": "AppServiceWebappDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VWanS2SVPNGWLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
                "policy_group_names": null,
                "reference_id": "VWanS2SVPNGWDeployDiagnosticLogDeployLogAnalytics"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud configuration",
            "display_name": "Deploy Microsoft Defender for Cloud configuration",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Security Center\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.548049Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"5.0.1\"}",
            "name": "Deploy-MDFC-Config",
            "parameters": "{\"ascExportResourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource Group location for the export to Log Analytics workspace configuration\"}},\"ascExportResourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource Group name for the export to Log Analytics workspace configuration\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Microsoft Defender for Cloud contact details\",\"displayName\":\"Security contacts email address\"}},\"enableAscForApis\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForAppServices\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForArm\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForContainers\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForCosmosDbs\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForCspm\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForDns\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForKeyVault\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForOssDb\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForServers\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForServersVulnerabilityAssessments\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSql\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSqlOnVm\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForStorage\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"minimalSeverity\":{\"type\":\"string\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":\"High\",\"metadata\":{\"description\":\"Defines the minimal alert severity which will be sent as email notifications\",\"displayName\":\"Minimal severity\"}},\"vulnerabilityAssessmentProvider\":{\"type\":\"String\",\"allowedValues\":[\"default\",\"mdeTvm\"],\"defaultValue\":\"default\",\"metadata\":{\"description\":\"Select the vulnerability assessment solution to provision to machines.\",\"displayName\":\"Vulnerability assessment provider type\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForOssDb')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                "policy_group_names": null,
                "reference_id": "defenderForOssDb"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServers')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                "policy_group_names": null,
                "reference_id": "defenderForVM"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServersVulnerabilityAssessments')]\"},\"vaType\":{\"value\":\"[parameters('vulnerabilityAssessmentProvider')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
                "policy_group_names": null,
                "reference_id": "defenderForVMVulnerabilityAssessment"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSqlOnVm')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                "policy_group_names": null,
                "reference_id": "defenderForSqlServerVirtualMachines"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForAppServices')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                "policy_group_names": null,
                "reference_id": "defenderForAppServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForStorage')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
                "policy_group_names": null,
                "reference_id": "defenderForStorageAccounts"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                "policy_group_names": null,
                "reference_id": "defenderforContainers"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"},\"logAnalyticsWorkspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                "policy_group_names": null,
                "reference_id": "defenderforKubernetes"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                "policy_group_names": null,
                "reference_id": "azurePolicyForKubernetes"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForKeyVault')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                "policy_group_names": null,
                "reference_id": "defenderForKeyVaults"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForDns')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
                "policy_group_names": null,
                "reference_id": "defenderForDns"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForArm')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                "policy_group_names": null,
                "reference_id": "defenderForArm"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSql')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                "policy_group_names": null,
                "reference_id": "defenderForSqlPaas"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForCosmosDbs')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                "policy_group_names": null,
                "reference_id": "defenderForCosmosDbs"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForApis')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e54d2be9-5f2e-4d65-98e4-4f0e670b23d6",
                "policy_group_names": null,
                "reference_id": "defenderForApis"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForCspm')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/689f7782-ef2c-4270-a6d0-7664869076bd",
                "policy_group_names": null,
                "reference_id": "defenderForCspm"
              },
              {
                "parameter_values": "{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"},\"minimalSeverity\":{\"value\":\"[parameters('minimalSeverity')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                "policy_group_names": null,
                "reference_id": "securityEmailContact"
              },
              {
                "parameter_values": "{\"resourceGroupLocation\":{\"value\":\"[parameters('ascExportResourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('ascExportResourceGroupName')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                "policy_group_names": null,
                "reference_id": "ascExport"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
            "display_name": "Configure Azure PaaS services to use private DNS zones",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Network\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.7745439Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "name": "Deploy-Private-DNS-Zones",
            "parameters": "{\"azureAcrPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAcrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppServicesPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAsrPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAsrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAutomationDSCHybridPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAutomationDSCHybridPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAutomationWebhookPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAutomationWebhookPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureBatchPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureBatchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveSearchPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveSearchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveServicesPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosCassandraPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosCassandraPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosGremlinPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosGremlinPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosMongoPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosMongoPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosSQLPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosSQLPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCosmosTablePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosTablePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDataFactoryPortalPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDataFactoryPortalPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDataFactoryPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDataFactoryPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDiskAccessPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDiskAccessPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridDomainsPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridDomainsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridTopicsPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridTopicsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventHubNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventHubNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureFilePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureHDInsightPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureHDInsightPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotHubsPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotHubsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureKeyVaultPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureKeyVaultPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMachineLearningWorkspacePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMachineLearningWorkspacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMediaServicesKeyPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesKeyPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMediaServicesLivePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesLivePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMediaServicesStreamPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesStreamPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMigratePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMigratePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId1\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId1\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId2\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId2\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId3\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId3\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId4\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId4\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMonitorPrivateDnsZoneId5\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId5\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureRedisCachePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureRedisCachePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureServiceBusNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureServiceBusNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSignalRPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSignalRPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageBlobPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageBlobPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageBlobSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageBlobSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageDFSPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageDFSPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageDFSSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageDFSSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageFilePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageQueuePrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageQueuePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageQueueSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageQueueSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageStaticWebPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageStaticWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureStorageStaticWebSecPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageStaticWebSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSynapseDevPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseDevPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSynapseSQLODPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseSQLODPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSynapseSQLPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseSQLPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureWebPrivateDnsZoneId\":{\"type\":\"string\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effect1\":{\"type\":\"string\",\"allowedValues\":[\"deployIfNotExists\",\"Disabled\"],\"defaultValue\":\"deployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureFileprivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-File-Sync"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAutomationWebhookPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Webhook\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Automation-Webhook"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAutomationDSCHybridPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"DSCAndHybridWorker\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Automation-DSCHybrid"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosSQLPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"SQL\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-SQL"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosMongoPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"MongoDB\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-MongoDB"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosCassandraPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Cassandra\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-Cassandra"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosGremlinPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Gremlin\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-Gremlin"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosTablePrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Table\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Cosmos-Table"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"listOfGroupIds\":{\"value\":[\"dataFactory\"]},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDataFactoryPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-DataFactory"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"listOfGroupIds\":{\"value\":[\"portal\"]},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDataFactoryPortalPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-DataFactory-Portal"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"cluster\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureHDInsightPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-HDInsight"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMigratePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Migrate"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageBlobPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-Blob"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageBlobSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-Blob-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageQueuePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-Queue"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageQueueSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-Queue-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageFilePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-File"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageStaticWebPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-StaticWeb"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageStaticWebSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-StaticWeb-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageDFSPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-DFS"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageDFSSecPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Storage-DFS-Sec"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseSQLPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"Sql\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Synapse-SQL"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseSQLODPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"SqlOnDemand\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Synapse-SQL-OnDemand"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseDevPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"Dev\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Synapse-Dev"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"keydelivery\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesKeyPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-MediaServices-Key"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"liveevent\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesLivePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-MediaServices-Live"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"streamingendpoint\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesStreamPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-MediaServices-Stream"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId1\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId1')]\"},\"privateDnsZoneId2\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId2')]\"},\"privateDnsZoneId3\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId3')]\"},\"privateDnsZoneId4\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId4')]\"},\"privateDnsZoneId5\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId5')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Monitor"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureWebPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Web"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureBatchPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Batch"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-App"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAsrPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-Site-Recovery"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-IoT"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureKeyVaultPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-KeyVault"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSignalRPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-SignalR"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppServicesPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-AppServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridTopicsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-EventGridTopics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDiskAccessPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-DiskAccess"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveServicesPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-CognitiveServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotHubsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-IoTHubs"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridDomainsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-EventGridDomains"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureRedisCachePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-RedisCache"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAcrPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-ACR"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventHubNamespacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-EventHubNamespace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMachineLearningWorkspacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-MachineLearningWorkspace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureServiceBusNamespacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-ServiceBusNamespace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveSearchPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
                "policy_group_names": null,
                "reference_id": "DINE-Private-DNS-Azure-CognitiveSearch"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment",
            "display_name": "Deploy SQL Database built-in SQL security configuration",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.4497709Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Deploy-Sql-Security",
            "parameters": "{\"SqlDbAuditingSettingsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy auditing settings to SQL Database when it not exist in the deployment\",\"displayName\":\"Deploy SQL database auditing settings\"}},\"SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration\",\"displayName\":\"Deploy SQL Database security Alert Policies configuration with email admin accounts\"}},\"SqlDbTdeDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the Transparent Data Encryption when it is not enabled in the deployment\",\"displayName\":\"Deploy SQL Database Transparent Data Encryption \"}},\"SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters\",\"displayName\":\"Deploy SQL Database vulnerability Assessments\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbTdeDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
                "policy_group_names": null,
                "reference_id": "SqlDbTdeDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                "policy_group_names": null,
                "reference_id": "SqlDbSecurityAlertPoliciesDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                "policy_group_names": null,
                "reference_id": "SqlDbAuditingSettingsDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
                "policy_group_names": null,
                "reference_id": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce Azure Compute Security Benchmark compliance auditing for Windows and Linux virtual machines.",
            "display_name": "Enforce Azure Compute Security Benchmark compliance auditing",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Guest Configuration\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.5090023Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Enforce-ACSB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"includeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"true\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
                "policy_group_names": null,
                "reference_id": "GcIdentity"
              },
              {
                "parameter_values": "{}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
                "policy_group_names": null,
                "reference_id": "GcLinux"
              },
              {
                "parameter_values": "{}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
                "policy_group_names": null,
                "reference_id": "GcWindows"
              },
              {
                "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('includeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
                "policy_group_names": null,
                "reference_id": "WinAcsb"
              },
              {
                "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('includeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
                "policy_group_names": null,
                "reference_id": "LinAcsb"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce policies in the Decommissioned Landing Zone.",
            "display_name": "Enforce policies in the Decommissioned Landing Zone",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Decommissioned\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.4860052Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Enforce-ALZ-Decomm",
            "parameters": "{\"listOfResourceTypesAllowed\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Allowed resource types in the Decommissioned landing zone, default is none.\",\"displayName\":\"Allowed resource types in the Decommissioned landing zone\",\"strongType\":\"resourceTypes\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"listOfResourceTypesAllowed\":{\"value\":\"[parameters('listOfResourceTypesAllowed')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c",
                "policy_group_names": null,
                "reference_id": "DecomDenyResources"
              },
              {
                "parameter_values": "{}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
                "policy_group_names": null,
                "reference_id": "DecomShutdownMachines"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce policies in the Sandbox Landing Zone.",
            "display_name": "Enforce policies in the Sandbox Landing Zone",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Sandbox\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.4953962Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Enforce-ALZ-Sandbox",
            "parameters": "{\"effectDenyVnetPeering\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectNotAllowedResources\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfResourceTypesNotAllowed\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Not allowed resource types in the Sandbox landing zone, default is none.\",\"displayName\":\"Not allowed resource types in the Sandbox landing zone\",\"strongType\":\"resourceTypes\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectNotAllowedResources')]\"},\"listOfResourceTypesNotAllowed\":{\"value\":\"[parameters('listOfResourceTypesNotAllowed')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                "policy_group_names": null,
                "reference_id": "SandboxNotAllowed"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectDenyVnetPeering')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
                "policy_group_names": null,
                "reference_id": "SandboxDenyVnetPeering"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
          "schema_version": 0,
          "attributes": {
            "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit. ",
            "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Encryption\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.5790905Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "name": "Enforce-EncryptTransit",
            "parameters": "{\"AKSIngressHttpsOnlyEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\",\"displayName\":\"AKS Service. Enforce HTTPS ingress in Kubernetes cluster\"}},\"APIAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"AppServiceHttpEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below\"}},\"AppServiceTlsVersionEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService WebApp, APIApp, Function App to enable https only\"}},\"AppServiceminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"App Service. Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"App Service. Select version minimum TLS Web App config\"}},\"FunctionLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Function App. Latest TLS version should be used in your Function App\"}},\"FunctionServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"MySQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server\"}},\"MySQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers\"}},\"MySQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"MySQL database servers. Select version minimum TLS for MySQL server\"}},\"PostgreSQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server\"}},\"PostgreSQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers\"}},\"PostgreSQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"PostgreSQL database servers. Select version minimum TLS for MySQL server\"}},\"RedisMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a Azure Cache for Redis to enforce\",\"displayName\":\"Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis\"}},\"RedisTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis\"}},\"RedisTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.\",\"displayName\":\"Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled\"}},\"SQLManagedInstanceMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure Managed Instanceto to  enforce\",\"displayName\":\"Azure Managed Instance.Select version minimum TLS for Azure Managed Instance\"}},\"SQLManagedInstanceTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLManagedInstanceTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"SQL Managed Instance should have the minimal TLS version of 1.2\"}},\"SQLServerTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLServerTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"Azure SQL Database should have the minimal TLS version of 1.2\"}},\"SQLServerminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure SQL Database to enforce\",\"displayName\":\"Azure SQL Database.Select version minimum TLS for Azure SQL Database\"}},\"StorageDeployHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled\"}},\"StorageHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Secure transfer to storage accounts should be enabled\"}},\"StorageminimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}},\"WebAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"WebAppServiceLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Web App. Latest TLS version should be used in your Web App\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceHttpEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                "policy_group_names": null,
                "reference_id": "AppServiceHttpEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceTlsVersionEffect')]\"},\"minTlsVersion\":{\"value\":\"[parameters('AppServiceminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                "policy_group_names": null,
                "reference_id": "AppServiceminTlsVersion"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                "policy_group_names": null,
                "reference_id": "FunctionLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                "policy_group_names": null,
                "reference_id": "WebAppServiceLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                "policy_group_names": null,
                "reference_id": "APIAppServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                "policy_group_names": null,
                "reference_id": "FunctionServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                "policy_group_names": null,
                "reference_id": "WebAppServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSIngressHttpsOnlyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                "policy_group_names": null,
                "reference_id": "AKSIngressHttpsOnlyEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                "policy_group_names": null,
                "reference_id": "MySQLEnableSSLDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                "policy_group_names": null,
                "reference_id": "MySQLEnableSSLEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                "policy_group_names": null,
                "reference_id": "PostgreSQLEnableSSLDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                "policy_group_names": null,
                "reference_id": "PostgreSQLEnableSSLEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                "policy_group_names": null,
                "reference_id": "RedisTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                "policy_group_names": null,
                "reference_id": "RedisdisableNonSslPort"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                "policy_group_names": null,
                "reference_id": "RedisDenyhttps"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                "policy_group_names": null,
                "reference_id": "SQLManagedInstanceTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                "policy_group_names": null,
                "reference_id": "SQLManagedInstanceTLSEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                "policy_group_names": null,
                "reference_id": "SQLServerTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                "policy_group_names": null,
                "reference_id": "SQLServerTLSEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
                "policy_group_names": null,
                "reference_id": "StorageHttpsEnabledEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageDeployHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                "policy_group_names": null,
                "reference_id": "StorageDeployHttpsEnabledEffect"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
          "schema_version": 0,
          "attributes": {
            "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
            "display_name": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Encryption\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:07:42.8742526Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "name": "Enforce-Encryption-CMK",
            "parameters": "{\"ACRCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK.\",\"displayName\":\"Container registries should be encrypted with a customer-managed key (CMK)\"}},\"AksCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.\",\"displayName\":\"Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys\"}},\"AzureBatchCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK.\",\"displayName\":\"Azure Batch account should use customer-managed keys to encrypt data\"}},\"CognitiveServicesCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)\"}},\"CosmosCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\"}},\"DataBoxCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.\",\"displayName\":\"Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password\"}},\"EncryptedVMDisksEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\"displayName\":\"Disk encryption should be applied on virtual machines\"}},\"HealthcareAPIsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.\",\"displayName\":\"Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest\"}},\"MySQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure MySQL servers bring your own key data protection should be enabled\"}},\"PostgreSQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure PostgreSQL servers bring your own key data protection should be enabled\"}},\"SqlServerTDECMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\"displayName\":\"SQL servers should use customer-managed keys to encrypt data at rest\"}},\"StorageCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.\",\"displayName\":\"Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption\"}},\"StreamAnalyticsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.\",\"displayName\":\"Azure Stream Analytics jobs should use customer-managed keys to encrypt data\"}},\"SynapseWorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.\",\"displayName\":\"Azure Synapse workspaces should use customer-managed keys to encrypt data at rest\"}},\"WorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk.\",\"displayName\":\"Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRCmkEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                "policy_group_names": null,
                "reference_id": "ACRCmkDeny"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AksCmkEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                "policy_group_names": null,
                "reference_id": "AksCmkDeny"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WorkspaceCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                "policy_group_names": null,
                "reference_id": "WorkspaceCMK"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                "policy_group_names": null,
                "reference_id": "CognitiveServicesCMK"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                "policy_group_names": null,
                "reference_id": "CosmosCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataBoxCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                "policy_group_names": null,
                "reference_id": "DataBoxCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                "policy_group_names": null,
                "reference_id": "StreamAnalyticsCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SynapseWorkspaceCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                "policy_group_names": null,
                "reference_id": "SynapseWorkspaceCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                "policy_group_names": null,
                "reference_id": "StorageCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                "policy_group_names": null,
                "reference_id": "MySQLCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                "policy_group_names": null,
                "reference_id": "PostgreSQLCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerTDECMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
                "policy_group_names": null,
                "reference_id": "SqlServerTDECMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('HealthcareAPIsCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                "policy_group_names": null,
                "reference_id": "HealthcareAPIsCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureBatchCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                "policy_group_names": null,
                "reference_id": "AzureBatchCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EncryptedVMDisksEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                "policy_group_names": null,
                "reference_id": "EncryptedVMDisksEffect"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce recommended guardrails for Azure Key Vault.",
            "display_name": "Enforce recommended guardrails for Azure Key Vault",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/contoso",
            "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Key Vault\",\"createdBy\":\"6b591cc2-3cf7-45bd-b2c0-858120650f45\",\"createdOn\":\"2025-04-02T10:06:10.5008672Z\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Enforce-Guardrails-KeyVault",
            "parameters": "{\"effectKvCertLifetime\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectKvFirewallEnabled\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectKvKeysExpire\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectKvKeysLifetime\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectKvPurgeProtection\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectKvSecretsExpire\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectKvSecretsLifetime\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effectKvSoftDelete\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"maximumCertLifePercentageLife\":{\"type\":\"Integer\",\"defaultValue\":80,\"metadata\":{\"description\":\"Enter the percentage of lifetime of the certificate when you want to trigger the policy action. For example, to trigger a policy action at 80% of the certificate's valid life, enter '80'.\",\"displayName\":\"The maximum lifetime percentage\"}},\"minimumCertLifeDaysBeforeExpiry\":{\"type\":\"Integer\",\"defaultValue\":90,\"metadata\":{\"description\":\"Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.\",\"displayName\":\"The minimum days before expiry\"}},\"minimumKeysLifeDaysBeforeExpiry\":{\"type\":\"Integer\",\"defaultValue\":90,\"metadata\":{\"description\":\"Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.\",\"displayName\":\"The minimum days before expiry\"}},\"minimumSecretsLifeDaysBeforeExpiry\":{\"type\":\"Integer\",\"defaultValue\":90,\"metadata\":{\"description\":\"Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.\",\"displayName\":\"The minimum days before expiry\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvSoftDelete')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
                "policy_group_names": null,
                "reference_id": "KvSoftDelete"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvPurgeProtection')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
                "policy_group_names": null,
                "reference_id": "KvPurgeProtection"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvSecretsExpire')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
                "policy_group_names": null,
                "reference_id": "KvSecretsExpire"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvKeysExpire')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
                "policy_group_names": null,
                "reference_id": "KvKeysExpire"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvFirewallEnabled')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                "policy_group_names": null,
                "reference_id": "KvFirewallEnabled"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvCertLifetime')]\"},\"maximumPercentageLife\":{\"value\":\"[parameters('maximumCertLifePercentageLife')]\"},\"minimumDaysBeforeExpiry\":{\"value\":\"[parameters('minimumCertLifeDaysBeforeExpiry')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417",
                "policy_group_names": null,
                "reference_id": "KvCertLifetime"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvKeysLifetime')]\"},\"minimumDaysBeforeExpiration\":{\"value\":\"[parameters('minimumKeysLifeDaysBeforeExpiry')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146",
                "policy_group_names": null,
                "reference_id": "KvKeysLifetime"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvSecretsLifetime')]\"},\"minimumDaysBeforeExpiration\":{\"value\":\"[parameters('minimumSecretsLifeDaysBeforeExpiry')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a",
                "policy_group_names": null,
                "reference_id": "KvSecretsLifetime"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "enterprise_scale",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "policy_assignment",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_role_definition",
      "name": "enterprise_scale",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/237ceaf1-7fcb-5833-a05c-2ff0a4c091f1",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/contoso"
            ],
            "description": "Contributor role granted for application/operations team at resource group level",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/237ceaf1-7fcb-5833-a05c-2ff0a4c091f1|/providers/Microsoft.Management/managementGroups/contoso",
            "name": "[CONTOSO] Application-Owners",
            "permissions": [
              {
                "actions": [
                  "*"
                ],
                "data_actions": null,
                "not_actions": [
                  "Microsoft.Authorization/*/write",
                  "Microsoft.Network/publicIPAddresses/write",
                  "Microsoft.Network/virtualNetworks/write",
                  "Microsoft.KeyVault/locations/deletedVaults/purge/action"
                ],
                "not_data_actions": null
              }
            ],
            "role_definition_id": "237ceaf1-7fcb-5833-a05c-2ff0a4c091f1",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/237ceaf1-7fcb-5833-a05c-2ff0a4c091f1",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/39fd8939-c6df-5c99-ac27-f3580d6a7936",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/contoso"
            ],
            "description": "Platform-wide global connectivity management: virtual networks, UDRs, NSGs, NVAs, VPN, Azure ExpressRoute, and others",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/39fd8939-c6df-5c99-ac27-f3580d6a7936|/providers/Microsoft.Management/managementGroups/contoso",
            "name": "[CONTOSO] Network-Management",
            "permissions": [
              {
                "actions": [
                  "*/read",
                  "Microsoft.Network/*",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Support/*"
                ],
                "data_actions": null,
                "not_actions": [],
                "not_data_actions": null
              }
            ],
            "role_definition_id": "39fd8939-c6df-5c99-ac27-f3580d6a7936",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/39fd8939-c6df-5c99-ac27-f3580d6a7936",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/430bab39-a5a7-5eb3-a985-d06c6f65efb9",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/contoso"
            ],
            "description": "Enterprise-scale custom Role Definition. Grants full access to manage Virtual Network subnets, but no other network resources.",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/430bab39-a5a7-5eb3-a985-d06c6f65efb9|/providers/Microsoft.Management/managementGroups/contoso",
            "name": "[CONTOSO] Network-Subnet-Contributor",
            "permissions": [
              {
                "actions": [
                  "Microsoft.Authorization/*/read",
                  "Microsoft.Insights/alertRules/*",
                  "Microsoft.ResourceHealth/availabilityStatuses/read",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Resources/subscriptions/resourceGroups/read",
                  "Microsoft.Support/*",
                  "Microsoft.Network/*/read",
                  "Microsoft.Network/virtualNetworks/subnets/*"
                ],
                "data_actions": null,
                "not_actions": [],
                "not_data_actions": null
              }
            ],
            "role_definition_id": "430bab39-a5a7-5eb3-a985-d06c6f65efb9",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/430bab39-a5a7-5eb3-a985-d06c6f65efb9",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/66393ec9-b3b3-53a3-8daf-89da6fb78a8a",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/contoso"
            ],
            "description": "Security Administrator role with a horizontal view across the entire Azure estate and the Azure Key Vault purge policy.",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/66393ec9-b3b3-53a3-8daf-89da6fb78a8a|/providers/Microsoft.Management/managementGroups/contoso",
            "name": "[CONTOSO] Security-Operations",
            "permissions": [
              {
                "actions": [
                  "*/read",
                  "*/register/action",
                  "Microsoft.KeyVault/locations/deletedVaults/purge/action",
                  "Microsoft.PolicyInsights/*",
                  "Microsoft.Authorization/policyAssignments/*",
                  "Microsoft.Authorization/policyDefinitions/*",
                  "Microsoft.Authorization/policyExemptions/*",
                  "Microsoft.Authorization/policySetDefinitions/*",
                  "Microsoft.Insights/alertRules/*",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Security/*",
                  "Microsoft.Support/*"
                ],
                "data_actions": null,
                "not_actions": [],
                "not_data_actions": null
              }
            ],
            "role_definition_id": "66393ec9-b3b3-53a3-8daf-89da6fb78a8a",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/66393ec9-b3b3-53a3-8daf-89da6fb78a8a",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/87362ad0-28b9-535b-8a0c-cc793bc4573a",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/contoso"
            ],
            "description": "Delegated role for subscription owner generated from subscription Owner role",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/87362ad0-28b9-535b-8a0c-cc793bc4573a|/providers/Microsoft.Management/managementGroups/contoso",
            "name": "[CONTOSO] Subscription-Owner",
            "permissions": [
              {
                "actions": [
                  "*"
                ],
                "data_actions": null,
                "not_actions": [
                  "Microsoft.Authorization/*/write",
                  "Microsoft.Network/vpnGateways/*",
                  "Microsoft.Network/expressRouteCircuits/*",
                  "Microsoft.Network/routeTables/write",
                  "Microsoft.Network/vpnSites/*"
                ],
                "not_data_actions": null
              }
            ],
            "role_definition_id": "87362ad0-28b9-535b-8a0c-cc793bc4573a",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/87362ad0-28b9-535b-8a0c-cc793bc4573a",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_core",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/45707e25-1603-4748-95b2-acf417b781bc/providers/Microsoft.Resources/deployments/pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v4.2.0_0031_ee13af72",
            "location": "swedencentral",
            "name": "pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v4.2.0_0031_ee13af72",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": null,
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.core.module.enterprise_scale_core.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "random_id",
      "name": "telem",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "b64_std": "7hOvcg==",
            "b64_url": "7hOvcg",
            "byte_length": 4,
            "dec": "3994267506",
            "hex": "ee13af72",
            "id": "7hOvcg",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_management_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:32:57Z",
            "triggers": {
              "azurerm_management_group_level_1": "[\"/providers/Microsoft.Management/managementGroups/contoso\"]",
              "azurerm_management_group_level_2": "[\"/providers/Microsoft.Management/managementGroups/contoso-decommissioned\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones\",\"/providers/Microsoft.Management/managementGroups/contoso-platform\",\"/providers/Microsoft.Management/managementGroups/contoso-sandboxes\"]",
              "azurerm_management_group_level_3": "[\"/providers/Microsoft.Management/managementGroups/contoso-connectivity\",\"/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1\",\"/providers/Microsoft.Management/managementGroups/contoso-identity\",\"/providers/Microsoft.Management/managementGroups/contoso-management\"]",
              "azurerm_management_group_level_4": "[]",
              "azurerm_management_group_level_5": "[]",
              "azurerm_management_group_level_6": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T10:17:11Z",
            "triggers": {
              "azurerm_management_group_policy_assignment_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/contoso-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations\",\"/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations\",\"/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/contoso-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\",\"/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet\",\"/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP\",\"/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL\",\"/providers/Microsoft.Management/managementGroups/contoso-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\",\"/providers/Microsoft.Management/managementGroups/contoso-sandboxes/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T10:06:08Z",
            "triggers": {
              "azurerm_policy_definition_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureAuth\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureKerberos\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbChannel\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbVersions\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-StorageAccount-CustomDomain\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Penp\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-UDR-With-Specific-NextHop\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_set_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T10:09:44Z",
            "triggers": {
              "azurerm_policy_set_definition_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "0s",
            "destroy_duration": "0s",
            "id": "2025-04-02T10:18:46Z",
            "triggers": {
              "azurerm_role_assignment_enterprise_scale": "[]",
              "module_role_assignments_for_policy": "[\"/providers/Microsoft.Management/managementGroups/contoso-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/contoso-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\",\"/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL\",\"/providers/Microsoft.Management/managementGroups/contoso-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\",\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.azurerm_role_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.module.role_assignments_for_policy.azurerm_role_assignment.for_policy",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_role_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "60s",
            "destroy_duration": "0s",
            "id": "2025-04-02T10:05:07Z",
            "triggers": {
              "azurerm_role_definition_enterprise_scale": "[\"/providers/Microsoft.Authorization/roleDefinitions/237ceaf1-7fcb-5833-a05c-2ff0a4c091f1\",\"/providers/Microsoft.Authorization/roleDefinitions/39fd8939-c6df-5c99-ac27-f3580d6a7936\",\"/providers/Microsoft.Authorization/roleDefinitions/430bab39-a5a7-5eb3-a985-d06c6f65efb9\",\"/providers/Microsoft.Authorization/roleDefinitions/66393ec9-b3b3-53a3-8daf-89da6fb78a8a\",\"/providers/Microsoft.Authorization/roleDefinitions/87362ad0-28b9-535b-8a0c-cc793bc4573a\"]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_role_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-connectivity/providers/Microsoft.Authorization/roleAssignments/7b7e2740-fec1-5294-84d3-90b7811b0e86",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-connectivity/providers/Microsoft.Authorization/roleAssignments/7b7e2740-fec1-5294-84d3-90b7811b0e86",
            "name": "7b7e2740-fec1-5294-84d3-90b7811b0e86",
            "principal_id": "a82f4bb9-7dbb-4c54-ac59-0338fcacd47a",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-connectivity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned/providers/Microsoft.Authorization/roleAssignments/510b55e6-1ed7-5566-9716-9549b111f520",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned/providers/Microsoft.Authorization/roleAssignments/510b55e6-1ed7-5566-9716-9549b111f520",
            "name": "510b55e6-1ed7-5566-9716-9549b111f520",
            "principal_id": "f4b48159-7c2b-4427-a11c-7cd91c3c8040",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-decommissioned",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/roleAssignments/633859b9-ab0a-5085-81bf-a1ebdd97444f",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/roleAssignments/633859b9-ab0a-5085-81bf-a1ebdd97444f",
            "name": "633859b9-ab0a-5085-81bf-a1ebdd97444f",
            "principal_id": "e1087f17-09e9-417e-9a86-2d174537d4a0",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-identity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/roleAssignments/a76a15d1-c7e8-5720-945f-e3b77e01ce1e",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-identity/providers/Microsoft.Authorization/roleAssignments/a76a15d1-c7e8-5720-945f-e3b77e01ce1e",
            "name": "a76a15d1-c7e8-5720-945f-e3b77e01ce1e",
            "principal_id": "e1087f17-09e9-417e-9a86-2d174537d4a0",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
            "role_definition_name": "Backup Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-identity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/07843543-e5cc-5d07-87e7-3fdf298903d5",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/07843543-e5cc-5d07-87e7-3fdf298903d5",
            "name": "07843543-e5cc-5d07-87e7-3fdf298903d5",
            "principal_id": "347f7b31-509b-4965-88fd-b79db5d40f95",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064",
            "role_definition_name": "Azure Kubernetes Service Policy Add-on Deployment",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/fcde6ce1-2610-5dcc-87b2-df73f8a9cade",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/fcde6ce1-2610-5dcc-87b2-df73f8a9cade",
            "name": "fcde6ce1-2610-5dcc-87b2-df73f8a9cade",
            "principal_id": "347f7b31-509b-4965-88fd-b79db5d40f95",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
            "role_definition_name": "Azure Kubernetes Service Contributor Role",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/b47a3a67-2db2-573f-bfaa-0644dc4b3b6d",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/b47a3a67-2db2-573f-bfaa-0644dc4b3b6d",
            "name": "b47a3a67-2db2-573f-bfaa-0644dc4b3b6d",
            "principal_id": "f8b53075-5263-4dfa-bc4f-9a959899169d",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
            "role_definition_name": "SQL Security Manager",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/ecc94796-912f-5716-8650-3b1283501533",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/ecc94796-912f-5716-8650-3b1283501533",
            "name": "ecc94796-912f-5716-8650-3b1283501533",
            "principal_id": "f8b53075-5263-4dfa-bc4f-9a959899169d",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/3db7e0ed-b2a9-5e7f-9837-f52b5d5d2baa",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/3db7e0ed-b2a9-5e7f-9837-f52b5d5d2baa",
            "name": "3db7e0ed-b2a9-5e7f-9837-f52b5d5d2baa",
            "principal_id": "cac9cae7-198a-4797-b43a-342dfebd1cd4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
            "role_definition_name": "SQL Security Manager",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/d5a47544-cc26-5636-baa2-5f6cf2d67455",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/d5a47544-cc26-5636-baa2-5f6cf2d67455",
            "name": "d5a47544-cc26-5636-baa2-5f6cf2d67455",
            "principal_id": "4710a309-61ef-4259-955b-62563ae71936",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
            "role_definition_name": "Backup Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/df038114-10fe-5ab0-b0e8-3c066ebeed2e",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/df038114-10fe-5ab0-b0e8-3c066ebeed2e",
            "name": "df038114-10fe-5ab0-b0e8-3c066ebeed2e",
            "principal_id": "4710a309-61ef-4259-955b-62563ae71936",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/7a3df80d-1c88-54ac-83d6-c91b68ae5bb9",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/7a3df80d-1c88-54ac-83d6-c91b68ae5bb9",
            "name": "7a3df80d-1c88-54ac-83d6-c91b68ae5bb9",
            "principal_id": "456d81df-13a0-4df3-ad38-c61eb1197675",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/3cab3854-f68f-5754-8660-5767206df7ba",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones/providers/Microsoft.Authorization/roleAssignments/3cab3854-f68f-5754-8660-5767206df7ba",
            "name": "3cab3854-f68f-5754-8660-5767206df7ba",
            "principal_id": "8bfa8434-756c-4bf8-ad43-a2aa1370edf6",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
            "role_definition_name": "Owner",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso-management/providers/Microsoft.Authorization/roleAssignments/5758d7c6-ed75-5357-927a-f61844fd0317",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso-management/providers/Microsoft.Authorization/roleAssignments/5758d7c6-ed75-5357-927a-f61844fd0317",
            "name": "5758d7c6-ed75-5357-927a-f61844fd0317",
            "principal_id": "e73dd992-a23d-404f-b527-e587c41440d3",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso-management",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/5c64145d-7ca8-554d-932f-5b8468fe6cbb",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/5c64145d-7ca8-554d-932f-5b8468fe6cbb",
            "name": "5c64145d-7ca8-554d-932f-5b8468fe6cbb",
            "principal_id": "cc300bdc-75e5-4116-8fad-c59484184f2e",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
            "role_definition_name": "Monitoring Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/77903bab-8a1b-5b02-84a5-8f9bee2bede1",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/77903bab-8a1b-5b02-84a5-8f9bee2bede1",
            "name": "77903bab-8a1b-5b02-84a5-8f9bee2bede1",
            "principal_id": "cc300bdc-75e5-4116-8fad-c59484184f2e",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/df4216c5-08a0-5f1e-b36e-4a8e01a2099a",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/df4216c5-08a0-5f1e-b36e-4a8e01a2099a",
            "name": "df4216c5-08a0-5f1e-b36e-4a8e01a2099a",
            "principal_id": "22d760f8-5be8-4668-a708-d2939dc94de9",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/446f82bb-b68c-5a16-8794-ebb8b9635203",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/446f82bb-b68c-5a16-8794-ebb8b9635203",
            "name": "446f82bb-b68c-5a16-8794-ebb8b9635203",
            "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/58076f49-7616-595b-9673-120acdcfcf83",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/58076f49-7616-595b-9673-120acdcfcf83",
            "name": "58076f49-7616-595b-9673-120acdcfcf83",
            "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/8bb6f106-b146-4ee6-a3f9-b9c5a96e0ae5",
            "role_definition_name": "Defender Kubernetes Agent Operator",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/59ac11f6-bf14-5470-be3d-4c7ef6c1dee9",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/59ac11f6-bf14-5470-be3d-4c7ef6c1dee9",
            "name": "59ac11f6-bf14-5470-be3d-4c7ef6c1dee9",
            "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e93ba01-8f92-4c7a-b12a-801e3df23824",
            "role_definition_name": "Kubernetes Agent Operator",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/8d2ba452-dc37-5fc2-9f2d-c470c410d5e2",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/8d2ba452-dc37-5fc2-9f2d-c470c410d5e2",
            "name": "8d2ba452-dc37-5fc2-9f2d-c470c410d5e2",
            "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064",
            "role_definition_name": "Azure Kubernetes Service Policy Add-on Deployment",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/bfce6a9a-1cb6-57ec-b40c-e0e88107f9e6",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/bfce6a9a-1cb6-57ec-b40c-e0e88107f9e6",
            "name": "bfce6a9a-1cb6-57ec-b40c-e0e88107f9e6",
            "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd",
            "role_definition_name": "Security Admin",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/db7b0a2b-b06c-5156-9958-d2a62d688391",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/db7b0a2b-b06c-5156-9958-d2a62d688391",
            "name": "db7b0a2b-b06c-5156-9958-d2a62d688391",
            "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
            "role_definition_name": "Azure Kubernetes Service Contributor Role",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/f8a6d4dc-42b8-5a23-a439-77c213828e85",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/f8a6d4dc-42b8-5a23-a439-77c213828e85",
            "name": "f8a6d4dc-42b8-5a23-a439-77c213828e85",
            "principal_id": "dfb3d263-3160-4a35-a832-bdb8e0c057c4",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
            "role_definition_name": "Owner",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/582e3bc4-bbcf-57b3-8239-0771c70c8f7f",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/582e3bc4-bbcf-57b3-8239-0771c70c8f7f",
            "name": "582e3bc4-bbcf-57b3-8239-0771c70c8f7f",
            "principal_id": "213e5028-7301-4f98-a7ea-54785d06dd1b",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/b62bdd60-f52a-5fca-a2c0-d5f728acee6a",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/b62bdd60-f52a-5fca-a2c0-d5f728acee6a",
            "name": "b62bdd60-f52a-5fca-a2c0-d5f728acee6a",
            "principal_id": "d4396eca-421a-429f-a4f6-22be505bbdde",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
            "role_definition_name": "SQL Security Manager",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/21c94cf9-b616-55ba-b8b8-20f0d0b0409b",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/21c94cf9-b616-55ba-b8b8-20f0d0b0409b",
            "name": "21c94cf9-b616-55ba-b8b8-20f0d0b0409b",
            "principal_id": "3635ec49-f780-4fda-92a2-7572102801df",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/e8360b41-6f62-5b79-8d86-65c6b6c14df0",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/e8360b41-6f62-5b79-8d86-65c6b6c14df0",
            "name": "e8360b41-6f62-5b79-8d86-65c6b6c14df0",
            "principal_id": "3635ec49-f780-4fda-92a2-7572102801df",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
            "role_definition_name": "Monitoring Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/c7928dbb-6396-5487-813f-509d5b0528b5",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/c7928dbb-6396-5487-813f-509d5b0528b5",
            "name": "c7928dbb-6396-5487-813f-509d5b0528b5",
            "principal_id": "522e0a32-b1bd-4fae-8ed9-6a665d752f43",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/84f08498-c411-58d5-938f-b1febccf978e",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/84f08498-c411-58d5-938f-b1febccf978e",
            "name": "84f08498-c411-58d5-938f-b1febccf978e",
            "principal_id": "daa3f748-5ace-4b85-8f28-a54702916460",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/f66defbc-8319-591c-b770-46cab915df79",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/f66defbc-8319-591c-b770-46cab915df79",
            "name": "f66defbc-8319-591c-b770-46cab915df79",
            "principal_id": "daa3f748-5ace-4b85-8f28-a54702916460",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.core.module.enterprise_scale_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "module.core.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/09355117-0b12-5231-9c45-db6fa31b8c27",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/roleAssignments/09355117-0b12-5231-9c45-db6fa31b8c27",
            "name": "09355117-0b12-5231-9c45-db6fa31b8c27",
            "principal_id": "fd8872b7-4136-4473-a3dc-c74fb766e723",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/contoso",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.core.data.azurerm_client_config.core",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_1",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_2",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_3",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_4",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_5",
            "module.core.module.enterprise_scale_core.azurerm_management_group.level_6",
            "module.core.module.enterprise_scale_core.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_policy_set_definition.enterprise_scale",
            "module.core.module.enterprise_scale_core.azurerm_role_assignment.policy_assignment",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_definition.external_lookup",
            "module.core.module.enterprise_scale_core.data.azurerm_policy_set_definition.external_lookup",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_management_group",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_assignment",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_definition",
            "module.core.module.enterprise_scale_core.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.management",
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NmI1OTFjYzItM2NmNy00NWJkLWIyYzAtODU4MTIwNjUwZjQ1O3N1YnNjcmlwdGlvbklkPTQ1NzA3ZTI1LTE2MDMtNDc0OC05NWIyLWFjZjQxN2I3ODFiYzt0ZW5hbnRJZD0zNTA0Y2YyOS1jZDU2LTRlZGMtYTQ4Mi0xNGRmYTEyMDNhMjk=",
            "object_id": "6b591cc2-3cf7-45bd-b2c0-858120650f45",
            "subscription_id": "45707e25-1603-4748-95b2-acf417b781bc",
            "tenant_id": "3504cf29-cd56-4edc-a482-14dfa1203a29",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "external_lookup",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "data",
      "type": "azurerm_policy_set_definition",
      "name": "external_lookup",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_automation_account",
      "name": "management",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/es-mgmt/providers/Microsoft.Automation/automationAccounts/es-automation",
          "schema_version": 0,
          "attributes": {
            "dsc_primary_access_key": "63gyfzIoi92PBZuNcuFZFB1lhcQowoZBXymEKN693fRWivTJSsVayEOyB/114nRGWmqSf7cW1qhZ7pArkpixRw==",
            "dsc_secondary_access_key": "LYHI3A7yJNkzxYoEdcZibTe94Q0J6XIecl4LJ9290TwcqEjNpEdbePBqKRT/V6IR/ejvRoFJtJjKMgKb50eF2A==",
            "dsc_server_endpoint": "https://373f5487-6868-47c2-b3bd-2bb62459f4d7.agentsvc.sec.azure-automation.net/accounts/373f5487-6868-47c2-b3bd-2bb62459f4d7",
            "encryption": [],
            "hybrid_service_url": "https://373f5487-6868-47c2-b3bd-2bb62459f4d7.jrds.sec.azure-automation.net/automationAccounts/373f5487-6868-47c2-b3bd-2bb62459f4d7",
            "id": "/subscriptions/45707e25-1603-4748-95b2-acf417b781bc/resourceGroups/es-mgmt/providers/Microsoft.Automation/automationAccounts/es-automation",
            "identity": [],
            "local_authentication_enabled": true,
            "location": "swedencentral",
            "name": "es-automation",
            "private_endpoint_connection": [],
            "public_network_access_enabled": true,
            "resource_group_name": "es-mgmt",
            "sku_name": "Basic",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management.module.enterprise_scale_management.azurerm_resource_group.management"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_dns_zone",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_express_route_gateway",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_firewall",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_firewall",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_firewall_policy",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_firewall_policy",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_log_analytics_workspace",
      "name": "management",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/es-mgmt/providers/Microsoft.OperationalInsights/workspaces/es-la",
          "schema_version": 3,
          "attributes": {
            "allow_resource_only_permissions": true,
            "cmk_for_query_forced": false,
            "daily_quota_gb": -1,
            "data_collection_rule_id": "",
            "id": "/subscriptions/45707e25-1603-4748-95b2-acf417b781bc/resourceGroups/es-mgmt/providers/Microsoft.OperationalInsights/workspaces/es-la",
            "identity": [],
            "immediate_data_purge_on_30_days_enabled": false,
            "internet_ingestion_enabled": true,
            "internet_query_enabled": true,
            "local_authentication_disabled": false,
            "location": "swedencentral",
            "name": "es-la",
            "primary_shared_key": "VYiLd0FcW2n+UUwZE/vLeaHiZHQHjY2VjhIx7juxyvxPu3wNd2pn7+3edqoPg9b5mdKNfiURKLLqM4ewFHOmWA==",
            "reservation_capacity_in_gb_per_day": null,
            "resource_group_name": "es-mgmt",
            "retention_in_days": 30,
            "secondary_shared_key": "668XerKbS1P/v8hVYl8WXnE2O7LV0lP2C8z010To+d3U335LXr7XmP86Pq2Ohlz84K/pFxGOCkSIJoi51FO++g==",
            "sku": "PerGB2018",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null,
            "workspace_id": "037b72f6-b935-4c67-abfa-b584de49e337"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIzIn0=",
          "dependencies": [
            "module.management.module.enterprise_scale_management.azurerm_resource_group.management"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_1",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_2",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_3",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_4",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_5",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_6",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "enterprise_scale",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_management_group_subscription_association",
      "name": "enterprise_scale",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_network_ddos_protection_plan",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "enterprise_scale",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_policy_set_definition",
      "name": "enterprise_scale",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_private_dns_zone",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_private_dns_zone_virtual_network_link",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_public_ip",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "management",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/es-mgmt",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/45707e25-1603-4748-95b2-acf417b781bc/resourceGroups/es-mgmt",
            "location": "swedencentral",
            "managed_by": "",
            "name": "es-mgmt",
            "tags": {
              "deployedBy": "terraform/azure/caf-enterprise-scale"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "enterprise_scale",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "policy_assignment",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_role_definition",
      "name": "enterprise_scale",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_core",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/45707e25-1603-4748-95b2-acf417b781bc/providers/Microsoft.Resources/deployments/pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v4.2.0_0000_bf0f91a2",
            "location": "swedencentral",
            "name": "pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v4.2.0_0000_bf0f91a2",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": null,
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management.module.enterprise_scale_management.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_management",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/45707e25-1603-4748-95b2-acf417b781bc/providers/Microsoft.Resources/deployments/pid-6fffb9f9-2691-412a-837e-3f72dcfe70cb_v4.2.0_0003_bf0f91a2",
            "location": "swedencentral",
            "name": "pid-6fffb9f9-2691-412a-837e-3f72dcfe70cb_v4.2.0_0003_bf0f91a2",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": null,
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management.module.enterprise_scale_management.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_virtual_hub",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_virtual_hub_connection",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_virtual_network",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_virtual_network_gateway",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_virtual_network_peering",
      "name": "connectivity",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_virtual_wan",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "azurerm_vpn_gateway",
      "name": "virtual_wan",
      "provider": "module.management.provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "random_id",
      "name": "telem",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "b64_std": "vw+Rog==",
            "b64_url": "vw-Rog",
            "byte_length": 4,
            "dec": "3205468578",
            "hex": "bf0f91a2",
            "id": "vw-Rog",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_management_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:23:18Z",
            "triggers": {
              "azurerm_management_group_level_1": "[]",
              "azurerm_management_group_level_2": "[]",
              "azurerm_management_group_level_3": "[]",
              "azurerm_management_group_level_4": "[]",
              "azurerm_management_group_level_5": "[]",
              "azurerm_management_group_level_6": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.management.data.azurerm_client_config.current",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_1",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_2",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_3",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_4",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_5",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_6"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:32:08Z",
            "triggers": {
              "azurerm_management_group_policy_assignment_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.management.data.azurerm_client_config.current",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_1",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_2",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_3",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_4",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_5",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_6",
            "module.management.module.enterprise_scale_management.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.management.module.enterprise_scale_management.azurerm_policy_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.azurerm_policy_set_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.data.azurerm_policy_definition.external_lookup",
            "module.management.module.enterprise_scale_management.data.azurerm_policy_set_definition.external_lookup",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_management_group",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_policy_definition",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:27:36Z",
            "triggers": {
              "azurerm_policy_definition_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.management.data.azurerm_client_config.current",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_1",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_2",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_3",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_4",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_5",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_6",
            "module.management.module.enterprise_scale_management.azurerm_policy_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_set_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:31:37Z",
            "triggers": {
              "azurerm_policy_set_definition_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.management.data.azurerm_client_config.current",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_1",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_2",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_3",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_4",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_5",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_6",
            "module.management.module.enterprise_scale_management.azurerm_policy_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.azurerm_policy_set_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_management_group",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "0s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:32:08Z",
            "triggers": {
              "azurerm_role_assignment_enterprise_scale": "[]",
              "module_role_assignments_for_policy": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.management.data.azurerm_client_config.current",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_1",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_2",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_3",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_4",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_5",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_6",
            "module.management.module.enterprise_scale_management.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.management.module.enterprise_scale_management.azurerm_policy_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.azurerm_policy_set_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.azurerm_role_assignment.enterprise_scale",
            "module.management.module.enterprise_scale_management.azurerm_role_assignment.policy_assignment",
            "module.management.module.enterprise_scale_management.azurerm_role_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.data.azurerm_policy_definition.external_lookup",
            "module.management.module.enterprise_scale_management.data.azurerm_policy_set_definition.external_lookup",
            "module.management.module.enterprise_scale_management.module.role_assignments_for_policy.azurerm_role_assignment.for_policy",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_management_group",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_policy_assignment",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_policy_definition",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_policy_set_definition",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_role_definition"
          ]
        }
      ]
    },
    {
      "module": "module.management.module.enterprise_scale_management",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "60s",
            "destroy_duration": "0s",
            "id": "2025-04-02T09:28:05Z",
            "triggers": {
              "azurerm_role_definition_enterprise_scale": "[]"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.management.data.azurerm_client_config.current",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_1",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_2",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_3",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_4",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_5",
            "module.management.module.enterprise_scale_management.azurerm_management_group.level_6",
            "module.management.module.enterprise_scale_management.azurerm_role_definition.enterprise_scale",
            "module.management.module.enterprise_scale_management.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    }
  ],
  "check_results": [
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.create_duration_delay",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.create_duration_delay",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.custom_landing_zones",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.custom_landing_zones",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_enforcement_placeholder",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_enforcement_placeholder",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.root_name",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.root_name",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.subscription_id_identity",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.subscription_id_identity",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.custom_landing_zones",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.custom_landing_zones",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.resource_prefix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.resource_prefix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.resource_suffix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.resource_suffix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.subscription_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.subscription_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.subscription_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.subscription_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.management_group_archetypes.var.root_id",
      "status": "pass",
      "objects": null
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.root_parent_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.root_parent_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.destroy_duration_delay",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.destroy_duration_delay",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes.var.scope_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-identity\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-connectivity\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-management\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-sandboxes\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-decommissioned\"].var.scope_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-platform\"].var.scope_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.custom_settings_by_resource_type",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.custom_settings_by_resource_type",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.management_group_archetypes.var.scope_id",
      "status": "pass",
      "objects": null
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_default",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_default",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.custom_settings_by_resource_type",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.custom_settings_by_resource_type",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.resource_prefix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.resource_prefix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.subscription_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.subscription_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.resource_prefix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.resource_prefix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.resource_suffix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.resource_suffix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_default",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_default",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_not_enforced_replacement",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_not_enforced_replacement",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.subscription_id_connectivity",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.subscription_id_connectivity",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.destroy_duration_delay",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.destroy_duration_delay",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.identity_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.identity_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.subscription_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.subscription_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.create_duration_delay",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.create_duration_delay",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_default",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_default",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.root_parent_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.root_parent_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.subscription_id_management",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.subscription_id_management",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.custom_settings_by_resource_type",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.custom_settings_by_resource_type",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.resource_prefix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.management_resources.var.resource_prefix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.subscription_id_connectivity",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.subscription_id_connectivity",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_enforced_replacement",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_enforced_replacement",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_enforced_replacement",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_enforced_replacement",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.subscription_id_management",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.subscription_id_management",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.resource_prefix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.resource_prefix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_enforcement_placeholder",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.policy_non_compliance_message_enforcement_placeholder",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-identity\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-landing-zones\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-sandboxes\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-management\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-connectivity\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-decommissioned\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-corp-ai-1\"].var.root_id",
          "status": "pass"
        },
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_group_archetypes[\"/providers/Microsoft.Management/managementGroups/contoso-platform\"].var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.destroy_duration_delay",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.destroy_duration_delay",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.resource_suffix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.resource_suffix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.resource_suffix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.connectivity_resources.var.resource_suffix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.subscription_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.subscription_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.create_duration_delay",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.create_duration_delay",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_not_enforced_replacement",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.policy_non_compliance_message_not_enforced_replacement",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.resource_suffix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.resource_suffix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.subscription_id_identity",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.subscription_id_identity",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.custom_settings_by_resource_type",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.custom_settings_by_resource_type",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.management_group_archetypes.var.scope_id",
      "status": "pass",
      "objects": null
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_not_enforced_replacement",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_not_enforced_replacement",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.subscription_id_management",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.subscription_id_management",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.resource_suffix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.module.management_resources.var.resource_suffix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.identity_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.identity_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.subscription_id_connectivity",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.subscription_id_connectivity",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.management_group_archetypes.var.root_id",
      "status": "pass",
      "objects": null
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.resource_prefix",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.resource_prefix",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.root_parent_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.root_parent_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.root_name",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.root_name",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_enforced_replacement",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_enforced_replacement",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.identity_resources.var.root_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.identity_resources.var.root_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_enforcement_placeholder",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.policy_non_compliance_message_enforcement_placeholder",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.custom_settings_by_resource_type",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.connectivity_resources.var.custom_settings_by_resource_type",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.subscription_id",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.module.connectivity_resources.var.subscription_id",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.custom_settings_by_resource_type",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.module.management_resources.var.custom_settings_by_resource_type",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.core.module.enterprise_scale_core.var.root_name",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.core.module.enterprise_scale_core.var.root_name",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.connectivity.module.enterprise_scale.var.custom_landing_zones",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.connectivity.module.enterprise_scale.var.custom_landing_zones",
          "status": "pass"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.management.module.enterprise_scale_management.var.subscription_id_identity",
      "status": "pass",
      "objects": [
        {
          "object_addr": "module.management.module.enterprise_scale_management.var.subscription_id_identity",
          "status": "pass"
        }
      ]
    }
  ]
}
